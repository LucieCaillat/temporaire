<!DOCTYPE html>
<html class="loaded" lang="fr"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript" async="" src="s6j4_fichiers/insight.js"></script><script type="text/javascript" src="s6j4_fichiers/NRJS-71f55aa980e498e276b"></script><script src="s6j4_fichiers/nr-1212.js"></script><script type="text/javascript" async="" src="s6j4_fichiers/gtm_002.js"></script><script type="text/javascript" src="s6j4_fichiers/commons.js" async="" status="loaded"></script><script type="text/javascript" src="s6j4_fichiers/google-tag-manager.js" async="" status="loaded"></script><script src="s6j4_fichiers/conversations-embed.js" type="text/javascript" id="hubspot-messages-loader" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s6j4_fichiers/9310539.js" type="text/javascript" id="hs-analytics"></script><script src="s6j4_fichiers/9310539_002.js" type="text/javascript" id="cookieBanner-9310539" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s6j4_fichiers/fb.js" type="text/javascript" id="hs-ads-pixel-9310539" data-ads-portal-id="9310539" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s6j4_fichiers/collectedforms.js" type="text/javascript" id="CollectedForms-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s6j4_fichiers/leadflows.js" type="text/javascript" id="LeadFlows-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script type="text/javascript" async="" src="s6j4_fichiers/analytics.js"></script><script type="text/javascript" async="" src="s6j4_fichiers/mixpanel-2-latest.js"></script><script type="text/javascript" async="" src="s6j4_fichiers/conversion_async.js"></script><script type="text/javascript" async="" src="s6j4_fichiers/analytics_002.js"></script><script async="" crossorigin="anonymous" src="s6j4_fichiers/fs.js"></script><script src="s6j4_fichiers/773401719499556.js" async=""></script><script async="" src="s6j4_fichiers/fbevents.js"></script><script async="" src="s6j4_fichiers/gtm.js"></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"NRJS-71f55aa980e498e276b","applicationID":"576835834","transactionName":"dgpYEBRYDg9XQh8AA0YNVAsHRQZMVlFJF01GDVkT","queueTime":0,"applicationTime":219,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-71f55aa980e498e276b",applicationID:"576835834"};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var i=e[n]={exports:{}};t[n][0].call(i.exports,function(e){var i=t[n][1][e];return r(i||e)},i,i.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,n){function r(){}function i(t,e,n,r){return function(){return s.recordSupportability("API/"+e+"/called"),o(t+e,[u.now()].concat(c(arguments)),n?null:this,r),n?void 0:this}}var o=t("handle"),a=t(10),c=t(11),f=t("ee").get("tracer"),u=t("loader"),s=t(4),d=NREUM;"undefined"==typeof window.newrelic&&(newrelic=d);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",v=l+"ixn-";a(p,function(t,e){d[e]=i(l,e,!0,"api")}),d.addPageAction=i(l,"addPageAction",!0),d.setCurrentRouteName=i(l,"routeName",!0),e.exports=newrelic,d.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(t,e){var n={},r=this,i="function"==typeof e;return o(v+"tracer",[u.now(),t,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return e.apply(this,arguments)}catch(t){throw f.emit("fn-err",[arguments,this,t],n),t}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){m[e]=i(v,e)}),newrelic.noticeError=function(t,e){"string"==typeof t&&(t=new Error(t)),s.recordSupportability("API/noticeError/called"),o("err",[t,u.now(),!1,e])}},{}],2:[function(t,e,n){function r(t){if(NREUM.init){for(var e=NREUM.init,n=t.split("."),r=0;r<n.length-1;r++)if(e=e[n[r]],"object"!=typeof e)return;return e=e[n[n.length-1]]}}e.exports={getConfiguration:r}},{}],3:[function(t,e,n){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}catch(o){}e.exports=function(t){return r?{passive:!0,capture:!!t}:!!t}},{}],4:[function(t,e,n){function r(t,e){var n=[a,t,{name:t},e];return o("storeMetric",n,null,"api"),n}function i(t,e){var n=[c,t,{name:t},e];return o("storeEventMetrics",n,null,"api"),n}var o=t("handle"),a="sm",c="cm";e.exports={constants:{SUPPORTABILITY_METRIC:a,CUSTOM_METRIC:c},recordSupportability:r,recordCustom:i}},{}],5:[function(t,e,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=t(12);e.exports=r,e.exports.offset=a,e.exports.getLastTimestamp=i},{}],6:[function(t,e,n){function r(t){return!(!t||!t.protocol||"file:"===t.protocol)}e.exports=r},{}],7:[function(t,e,n){function r(t,e){var n=t.getEntries();n.forEach(function(t){"first-paint"===t.name?p("timing",["fp",Math.floor(t.startTime)]):"first-contentful-paint"===t.name&&p("timing",["fcp",Math.floor(t.startTime)])})}function i(t,e){var n=t.getEntries();if(n.length>0){var r=n[n.length-1];if(f&&f<r.startTime)return;p("lcp",[r])}}function o(t){t.getEntries().forEach(function(t){t.hadRecentInput||p("cls",[t])})}function a(t){if(t instanceof g&&!y){var e=Math.round(t.timeStamp),n={type:t.type};e<=l.now()?n.fid=l.now()-e:e>l.offset&&e<=Date.now()?(e-=l.offset,n.fid=l.now()-e):e=l.now(),y=!0,p("timing",["fi",e,n])}}function c(t){"hidden"===t&&(f=l.now(),p("pageHide",[f]))}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d,p=t("handle"),l=t("loader"),v=t(9),m=t(3),g=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){u=new PerformanceObserver(r);try{u.observe({entryTypes:["paint"]})}catch(h){}s=new PerformanceObserver(i);try{s.observe({entryTypes:["largest-contentful-paint"]})}catch(h){}d=new PerformanceObserver(o);try{d.observe({type:"layout-shift",buffered:!0})}catch(h){}}if("addEventListener"in document){var y=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(t){document.addEventListener(t,a,m(!1))})}v(c)}},{}],8:[function(t,e,n){function r(t,e){if(!i)return!1;if(t!==i)return!1;if(!e)return!0;if(!o)return!1;for(var n=o.split("."),r=e.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}e.exports={agent:i,version:o,match:r}},{}],9:[function(t,e,n){function r(t){function e(){t(c&&document[c]?document[c]:document[o]?"hidden":"visible")}"addEventListener"in document&&a&&document.addEventListener(a,e,i(!1))}var i=t(3);e.exports=r;var o,a,c;"undefined"!=typeof document.hidden?(o="hidden",a="visibilitychange",c="visibilityState"):"undefined"!=typeof document.msHidden?(o="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(o="webkitHidden",a="webkitvisibilitychange",c="webkitVisibilityState")},{}],10:[function(t,e,n){function r(t,e){var n=[],r="",o=0;for(r in t)i.call(t,r)&&(n[o]=e(r,t[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],11:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(i<0?0:i);++r<i;)o[r]=t[e+r];return o}e.exports=r},{}],12:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(t,e,n){function r(){}function i(t){function e(t){return t&&t instanceof r?t:t?u(t,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){t&&a&&t(n,r,i);for(var c=e(i),f=m(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[w[n]];return p&&p.push([b,n,r,c]),c}}function o(t,e){y[t]=m(t).concat(e)}function v(t,e){var n=y[t];if(n)for(var r=0;r<n.length;r++)n[r]===e&&n.splice(r,1)}function m(t){return y[t]||[]}function g(t){return p[t]=p[t]||i(n)}function h(t,e){l.aborted||s(t,function(t,n){e=e||"feature",w[n]=e,e in d||(d[e]=[])})}var y={},w={},b={on:o,addEventListener:o,removeEventListener:v,emit:n,get:g,listeners:m,context:e,buffer:h,abort:c,aborted:!1};return b}function o(t){return u(t,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=t("gos"),s=t(10),d={},p={},l=e.exports=i();e.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(t,e,n){function r(t,e,n){if(i.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return t[e]=r,r}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){i.buffer([t],r),i.emit(t,e,n)}var i=t("ee").get("handle");e.exports=r,r.ee=i},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,o,function(){return i++})}var i=1,o="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!T++){var t=P.info=NREUM.info,e=g.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(O,function(e,n){t[e]||(t[e]=n)});var n=a();c("mark",["onload",n+P.offset],null,"api"),c("timing",["load",n]);var r=g.createElement("script");0===t.agent.indexOf("http://")||0===t.agent.indexOf("https://")?r.src=t.agent:r.src=v+"://"+t.agent,e.parentNode.insertBefore(r,e)}}function i(){"complete"===g.readyState&&o()}function o(){c("mark",["domContent",a()+P.offset],null,"api")}var a=t(5),c=t("handle"),f=t(10),u=t("ee"),s=t(8),d=t(6),p=t(2),l=t(3),v=p.getConfiguration("ssl")===!1?"http":"https",m=window,g=m.document,h="addEventListener",y="attachEvent",w=m.XMLHttpRequest,b=w&&w.prototype,E=!d(m.location);NREUM.o={ST:setTimeout,SI:m.setImmediate,CT:clearTimeout,XHR:w,REQ:m.Request,EV:m.Event,PR:m.Promise,MO:m.MutationObserver};var x=""+location,O={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1212.min.js"},M=w&&b&&b[h]&&!/CriOS/.test(navigator.userAgent),P=e.exports={offset:a.getLastTimestamp(),now:a,origin:x,features:{},xhrWrappable:M,userAgent:s,disabled:E};if(!E){t(1),t(7),g[h]?(g[h]("DOMContentLoaded",o,l(!1)),m[h]("load",r,l(!1))):(g[y]("onreadystatechange",i),m[y]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var T=0}},{}],"wrap-function":[function(t,e,n){function r(t,e){function n(e,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],t)}c(n+"start",[o,a,f],s,u);try{return p=e.apply(a,o)}catch(v){throw c(n+"err",[o,a,v],s,u),v}finally{c(n+"end",[o,a,p],s,u)}}return a(e)?e:(n||(n=""),nrWrapper[p]=e,o(e,nrWrapper,t),nrWrapper)}function r(t,e,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<e.length;u++)f=e[u],c=t[f],a(c)||(t[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!v||e){var c=v;v=!0;try{t.emit(n,r,o,e,a)}catch(f){i([f,n,r,o],t)}v=c}}return t||(t=s),n.inPlace=r,n.flag=p,n}function i(t,e){e||(e=s);try{e.emit("internal-error",t)}catch(n){}}function o(t,e,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(t);return r.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(o){i([o],n)}for(var a in t)l.call(t,a)&&(e[a]=t[a]);return e}function a(t){return!(t&&t instanceof Function&&t.apply&&!t[p])}function c(t,e){var n=e(t);return n[p]=t,o(t,n,s),n}function f(t,e,n){var r=t[e];t[e]=c(r,n)}function u(){for(var t=arguments.length,e=new Array(t),n=0;n<t;++n)e[n]=arguments[n];return e}var s=t("ee"),d=t(11),p="nr@original",l=Object.prototype.hasOwnProperty,v=!1;e.exports=r,e.exports.wrapFunction=c,e.exports.wrapInPlace=f,e.exports.argsToArray=u},{}]},{},["loader"]);</script>
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="FlBrH0ACAhoymJhYxgbongk7xO0+hM6s+1HcRT7ycxxlwEU77+JVK/rJ7okGF1ECrWU32xAlK+vi9ptxd6TXgA==">
    <title>Le tableau de bord | The Hacking Project</title>
<meta name="description" content="Nous cassons les codes de l'√©ducation, vous apprenez d'o√π vous voulez, en communaut√©.">
<meta name="robots" content="noindex, nofollow">
<meta property="og:title" content="Le tableau de bord">
<meta property="og:site_name" content="The Hacking Project">
<meta name="url" content="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/4">
<meta name="image" content="https://www.thehackingproject.org/packs/images/logo/20210910-THP-Logo_color_transparent-31229dd881904e010092de63be97cdfa.png">


    <link rel="apple-touch-icon" sizes="180x180" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-c01aaccf467f7cc3d79bbce743d60779f5b833fdc4500cebd07a5e11a07a5c31.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-precomposed-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.thehackingproject.org/assets/favicon/favicon-32x32-804b12d1c41c60fe721477b7c3b0a32811dc610580dd40ac92f1cc04cbd05ca4.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.thehackingproject.org/assets/favicon/favicon-16x16-d96ba65e5785d32474df9ebc6fbfd5442c751d527b10981a474bc3b7a4079d01.png">
<link rel="manifest" href="https://www.thehackingproject.org/assets/favicon/manifest-cf975201fd8ac78a1f1a203357573d50031f1cc33436d099743df6428b8a38a2.json">
<link rel="mask-icon" href="https://www.thehackingproject.org/assets/favicon/safari-pinned-tab-8af1cfcf7525ccdccb490f9f5adad396653a4969b419e0a9a9d3a1088140a912.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://www.thehackingproject.org/assets/favicon/favicon-cbf10361dc90b277565960736d4897fddef5468bff6299811ea9498459d56d21.ico">
<meta name="msapplication-config" content="/assets/favicon/browserconfig-dab38db6040ef54ac56e91fdd77e3d7b06746a634e87b68c99b59b216cb8611a.xml">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" media="screen" href="s6j4_fichiers/vendor-dab9e12f0ba58215899de05f149caa5f.css">
    <link rel="stylesheet" media="screen" href="s6j4_fichiers/dashboard-4ab6ba9737cbfc4c38b17a9a4de7833a.css">
    <link rel="stylesheet" media="screen" href="s6j4_fichiers/dashboard-ea5a94b9045ccb8d8ce8974b71b640603915dc183d5907c643.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="s6j4_fichiers/js.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-105991867-1');
  </script>
<!-- End Google Analytics -->

<!-- Google Tag Manager -->
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-P8XRQ3M");
</script>
<!-- End Google Tag Manager -->

<!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
         fbq('init', '773401719499556');
        fbq('track', 'PageView');
    </script>
    <noscript>
     <img height="1" width="1"
    src="https://www.facebook.com/tr?id=773401719499556&ev=PageView
    &noscript=1"/>
    </noscript>
<!-- End Facebook Pixel Code -->

<script>
window['_fs_debug'] = false;
window['_fs_host'] = 'fullstory.com';
window['_fs_script'] = 'edge.fullstory.com/s/fs.js';
window['_fs_org'] = '14AEET';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
    g=m[e]=function(a,b,s){g.q?g.q.push([a,b,s]):g._api(a,b,s);};g.q=[];
    o=n.createElement(t);o.async=1;o.crossOrigin='anonymous';o.src='https://'+_fs_script;
    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
    g.identify=function(i,v,s){g(l,{uid:i},s);if(v)g(l,v,s)};g.setUserVars=function(v,s){g(l,v,s)};g.event=function(i,v,s){g('event',{n:i,p:v},s)};
    g.anonymize=function(){g.identify(!!0)};
    g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
    g.log = function(a,b){g("log",[a,b])};
    g.consent=function(a){g("consent",!arguments.length||a)};
    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
    g.clearUserCookie=function(){};
    g.setVars=function(n, p){g('setVars',[n,p]);};
    g._w={};y='XMLHttpRequest';g._w[y]=m[y];y='fetch';g._w[y]=m[y];
    if(m[y])m[y]=function(){return g._w[y].apply(this,arguments)};
    g._v="1.3.0";
})(window,document,window['_fs_namespace'],'script','user');
</script>
<!-- Start of HubSpot Embed Code -->
<script async="" defer="defer" id="hs-script-loader" src="s6j4_fichiers/9310539_003.js" type="text/javascript"></script>
<!-- End of HubSpot Embed Code -->


    <script src="s6j4_fichiers/thp-3cc5aa6fdf57842a7b6c714621cc7f2d3d31b51cb700b1de4e795d773.js"></script>
    <script src="s6j4_fichiers/manifest-1613feea780cfc5342f4.js"></script>
    <script src="s6j4_fichiers/vendor-ff3cb5540e737de52c97.js"></script>
    <script src="s6j4_fichiers/dashboard-25875e14460b4458b1bccffaa93d4a8cbee9691b06d54976fde.js"></script>

    <link href="s6j4_fichiers/css.css" rel="stylesheet">
  <script src="s6j4_fichiers/a"></script></head>

  <body class="vertical-layout 2-columns fixed-navbar menu-hide vertical-overlay-menu" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns" data-thp-controller="days" data-thp-action="show" data-thp-layout="dashboard"><style type="text/css">html.hs-messages-widget-open.hs-messages-mobile,html.hs-messages-widget-open.hs-messages-mobile body{overflow:hidden!important;position:relative!important}html.hs-messages-widget-open.hs-messages-mobile body{height:100%!important;margin:0!important}#hubspot-messages-iframe-container{display:initial!important;z-index:2147483647;position:fixed!important;bottom:0!important}#hubspot-messages-iframe-container.widget-align-left{left:0!important}#hubspot-messages-iframe-container.widget-align-right{right:0!important}#hubspot-messages-iframe-container.internal{z-index:1016}#hubspot-messages-iframe-container.internal iframe{min-width:108px}#hubspot-messages-iframe-container .shadow-container{display:initial!important;z-index:-1;position:absolute;width:0;height:0;bottom:0;content:""}#hubspot-messages-iframe-container .shadow-container.internal{display:none!important}#hubspot-messages-iframe-container .shadow-container.active{width:400px;height:400px}#hubspot-messages-iframe-container iframe{display:initial!important;width:100%!important;height:100%!important;border:none!important;position:absolute!important;bottom:0!important;right:0!important;background:transparent!important}</style>
    <!-- Google Tag Manager (noscript) -->
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-P8XRQ3M' style='display:none;visibility:hidden' width='0'></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->



    <nav class="header-navbar navbar-expand-md navbar navbar-with-menu navbar-without-dd-arrow fixed-top navbar-semi-light" style="padding:0;">
<div class="navbar-wrapper">
<div class="navbar-container content">
<div class="collapse navbar-collapse show" id="navbar-mobile">
<ul class="nav navbar-nav mr-auto float-left">
<li class="nav-item mobile-menu d-md-none mr-auto">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu font-large-1"></i>
</a>
</li>
<li class="nav-item d-none d-md-block">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu"></i>
</a>
</li>
</ul>
<ul class="nav navbar-nav float-right">
<li class="dropdown dropdown-user nav-item">
<a class="dropdown-toggle nav-link dropdown-user-link" data-toggle="dropdown" href="#">
<span class="avatar avatar-online">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s6j4_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
</a>
<div class="dropdown-menu dropdown-menu-right">
<div class="arrow_box_right">
<a class="dropdown-toggle nav-link dropdown-user-link" href="https://www.thehackingproject.org/fr/dashboard/profile/user"><span class="avatar avatar-online pt-0">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s6j4_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
<span class="user-name text-bold-700 ml-1 text-dark">
Lucie
</span>
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit"><i class="ft-edit"></i>√âditer profil
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit?edit=danger"><i class="ft-alert-triangle"></i>Zone √† risques
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" rel="nofollow" data-method="delete" href="https://www.thehackingproject.org/users/sign_out?locale=fr"><i class="ft-power"></i>
D√©connexion
</a></div>
</div>
</li>
</ul>
</div>
</div>
</div>
</nav>

      <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true">
<div class="navbar-header">
<ul class="nav navbar-nav flex-row">
<li class="nav-item mr-auto">
<a class="navbar-brand" href="https://www.thehackingproject.org/?locale=fr"><h3 class="brand-text">The Hacking Project</h3>
</a></li>
<li class="nav-item d-md-none">
<a class="nav-link close-navbar">
<i class="ft-x"></i>
</a>
</li>
</ul>
</div>
<div class="main-menu-content">
<ul class="navigation navigation-main" data-menu="menu-navigation" id="main-menu-navigation">
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard"><i class="ft-calendar"></i>
<span class="menu-title" data-i18n="">
Aujourd'hui
</span>
</a></li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard"><i class="ft-monitor"></i>
<span class="menu-title" data-i18n="">
Mon dashboard
</span>
</a></li>
<li class="nav-item has-sub">
<a href="#"><i class="fas fa-user-graduate"></i>
<span class="menu-title" data-i18n="">
Mon inscription
</span>
</a><ul class="menu-content">
<li>
<a href="https://www.thehackingproject.org/parcours?locale=fr">Choisir un parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/new">Nouveau parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/7209/edit">Changer parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/modalites">Modalit√©s</a>
</li>
</ul>
</li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/certifications"><i class="fa ft-download"></i>
<span class="menu-title" data-i18n="">
Documents
</span>
</a></li>
<br>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/help"><i class="fa ft-help-circle"></i>
<span class="menu-title" data-i18n="">
Aide
</span>
</a></li>
</ul>
</div>
</div>



    <div class="app-content content">
      <div class="content-wrapper">
        <div class="content-wrapper-before"></div>
        <div class="content-header row"></div>
        <div class="container">
<div class="row">
<div class="col-12">
<ol class="breadcrumb">
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard">Dashboard</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1">Fullstack web</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3">Rails interm√©diaire</a>
</li>
<li class="breadcrumb-item active">
Pimp du Gossip Project
</li>
</ol>
</div>
</div>
<!-- / PARTIAL FOR FREE MOUSSES -->
<!-- / PARTIAL FOR NEXT -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-body">
<div class="row">
<div class="col-12 col-xl-12 text-center mb-3">
<h2 class="mb-2">
Rails interm√©diaire
</h2>
<h3>
<i class="ft-check-square success" data-placement="top" data-toggle="tooltip" title="" data-original-title="Projet bien re√ßu !"></i>
Pimp du Gossip Project
</h3>
<h4>
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

</h4>
<h5>

</h5>
</div>
<div class="col-12 col-xl-12 timeline-left" id="activity">
<div class="timeline pt-2">
<ul class="list-unstyled base-timeline activity-timeline">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/1"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/1">Lundi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

D√©couverte de Rails
</div>
</div>
<small class="text-muted">
Maintenant que tu es un champion du backend, nous allons nous attaquer au frontend, et au web.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/2"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/2">Mardi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journ√©e l√†"></i>

Utiliser les routes et les formulaires
</div>
</div>
<small class="text-muted">
Aujourd'hui tu vas te montrer le monde merveilleux des routes et comment les formulaires les utilisent
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/3"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/3">Mercredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">

CRUD
</div>
</div>
<small class="text-muted">
Create, Read, Update, Destroy.
</small>
</li>
<li>
<div class="timeline-icon bg-primary">
<i class="ft-map-pin font-medium-1"></i>
</div>
<div class="act-time">
Jeudi
</div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

Pimp du Gossip Project
</div>
</div>
<small class="text-muted">

</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/5"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/3/days/5">Vendredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journ√©e l√†"></i>

Mettre en ligne ton site üöÄ et l'am√©liorer avec login &amp; Cookies üç™
</div>
</div>
<small class="text-muted">
Tu vas faire une app qui sera accessible uniquement aux utilisateurs qui
 sont login. Mais avant, on va apprendre √† la mettre en ligne sur Heroku
 !
</small>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Les fameuses corrections qui n'arrivent que les jours concern√©s -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #5E66E5">
<h1>
Ressource : 
Utilisateurs avec mots de passe
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/lessons/241/lesson_submissions/new"><i class="ft-edit" data-original-title="Proposer une am√©lioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>Dans cette ressource, nous allons voir comment g√©rer les mots de 
passe des utilisateurs de ton app Rails. Mais en guise de pr√©ambule, on 
va te faire un topo de culture g√© en t'expliquant comment les 
applications web stockent, en g√©n√©ral, les mots de passe.</p>


<h2>2. Historique</h2>
<p>Tu trouveras ci-dessous quelques √©l√©ments d'historique sur la science des mots de passe et de leur cryptage.</p>

<h2>3. La ressource</h2>
<h3>3.1. Gestion de mots de passe dans une base de donn√©es</h3>
<p>Les mots de passe sont une donn√©e ultra sensible qu'il faut bien 
prot√©ger au sein des bases de donn√©es. Les stocker en clair (non 
crypt√©s) dans une table, c'est pas loin d'√™tre la pire id√©e du 
monde&nbsp;: si jamais tu te fais hacker et que ta base de donn√©es est 
r√©v√©l√©e √† la Terre enti√®re, et bien tout le monde peut voir tous les 
mots de passe et se connecter en lieu et place de tes utilisateurs. Et 
comme un bon 80&nbsp;% des gens utilisent le m√™me mot de passe pour tous
 les sites web, n'importe qui pourra acc√©der √† tous leurs comptes. √áa 
peut l√©g√®rement nuire √† l'image de ton entreprise. <br>
Morale de l'histoire&nbsp;: on ne stocke <b>jamais</b> de mots de passe en clair dans une base de donn√©es.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">ü§ì QUESTION R√âCURRENTE</h4>
      <p class="card-text"><b>Jamy, les hacks de bases de donn√©es, √ßa arrive souvent&nbsp;?</b><br>
        Oui, m√™me aux meilleurs. L'un des plus connus est celui de <a href="https://en.wikipedia.org/wiki/2012_LinkedIn_hack?oldformat=true" target="_blank">LinkedIn</a> en 2012, o√π tous leurs mots de passe ont √©t√© √©gar√©s dans la nature. Oups.</p>
        <p>Il existe m√™me un site nomm√© <a href="https://haveibeenpwned.com/" target="_blank">have i been pwned?</a>
 qui te dit si ton adresse e-mail appara√Æt dans une des bases de donn√©es
 hack√©es et publi√©es sur les nombreux forums de hackers. Si l'un des 
sites hack√© a, un jour, stock√© ton mot de passe en clair (les chances 
sont faibles), tu es dans le üí© et t'as int√©r√™t √† vite le modifier‚Ä¶.</p>
    </div>
  </div>
</div>

<p>Alors, comment font les sites pour stocker ton mot de passe et te 
permettre de l'utiliser mais sans le conna√Ætre eux-m√™mes&nbsp;? 
G√©n√©ralement, ils utilisent ce que l'on appelle une fonction de hashage 
cryptographique. Derri√®re ce nom styl√© (√† noter et √† ressortir au 
prochain ap√©ro avec tes potes) se cache un programme informatique 
simple&nbsp;: il va transformer n'importe quel string en une suite de 
caract√®res du genre <code>900150983cd24fb0d6963f7d28e17f72</code>. On appelle cette suite un "hash" (attention, √ßa a le m√™me nom mais c'est tr√®s diff√©rent des hash comme <code>params</code> qu'on manipule en Ruby depuis le d√©but) et il a deux particularit√©s importantes :</p>

<ul>
  <li>Un string ne donnera qu'un seul hash (toujours le m√™me). Un hash 
identifie un seul et unique string (c‚Äôest-√†-dire que si 2 strings ont le
 m√™me hash, c'est qu'ils sont strictement √©gaux).</li>
  <li>Deux strings assez similaires, vont donner deux hash radicalement diff√©rents en sortie. Exemple&nbsp;:
  <ul>
    <li><code>salut</code> va donner <code>3ed7dceaf266cafef032b9d5db224717</code> üëã</li>
    <li><code>salud</code> va donner <code>6776b3dd95bba354801deda2cb769122</code> üçª</li>
  </ul></li>
  <li>Il est tr√®s ais√© de passer du <code>string</code> au <code>hash</code> mais, th√©oriquement, il est impossible (dans un temps raisonnable - moins de quelques dizaines d'ann√©es quoi) de passer du <code>hash</code> au <code>string</code>.</li>
</ul>

<p>Ces particularit√©s permettent de stocker en base les hash, car m√™me 
s'ils sont compromis, il sera impossible pour les hackeurs de d√©crypter 
les mots de passe qui se cachent derri√®re. Ainsi, tu es moins flipp√© de 
te faire hacker ta BDD&nbsp;: les mots de passe sont prot√©g√©s. 
Ouf&nbsp;!</p>

<p>D'accord mais concr√®tement, comment √ßa fonctionne dans une application&nbsp;? Nous allons stocker dans la table <code>users</code> un string nomm√© <code>password_digest</code>. √Ä l'inscription, l'utilisateur va saisir son mot de passe et on va le r√©cup√©rer via <code>params</code>. Ensuite on va le convertir en hash, et le stocker dans la colonne <code>password_digest</code> (le mot de passe normal est parti aux oubliettes du params). <br>
Finalement, quand il tentera de se connecter, l'utilisateur va envoyer un <code>params</code>
 contenant un e-mail et un mot de passe en clair. On va √† nouveau 
convertir le mot de passe en hash et le comparer avec celui en base. Si 
les deux hash sont identiques, c'est que l'utilisateur t'a donn√© le bon 
mot de passe&nbsp;: <a href="https://www.youtube.com/watch?v=jj7BRKHml8g" target="_blank">ACCESS GRANTED</a></p>

<div class="card box-shadow-0 border-success">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üìö INSTANT CULTURE G√â</h4>
      <p class="card-text">Tu l'as donc compris&nbsp;: un site web digne
 de ce nom ne doit jamais enregistrer ton mot de passe en clair. Il ne 
fait que le stocker temporairement dans <code>params</code>, ce dernier √©tant vid√© de son contenu √† chaque changement de page. <br>
      Si jamais, dans ta vie d'utilisateur, tu retrouves ton mot de 
passe en clair d'une mani√®re ou une autre (en URL, un e-mail qui te 
renvoie ton mot de passe), c'est que tu as affaire √† un beau service <a href="https://www.youtube.com/watch?v=aeePeVUW6-k" target="_blank">cod√© avec le cul</a> et pas s√©curis√©. Fuis ces gens&nbsp;! üèÉ</p>
    </div>
  </div>
</div>


<h3>3.2. Gestion de mots de passe en Rails</h3>
<p>Il est possible de g√©rer les hash assez facilement dans Rails&nbsp;: la gem <a href="https://github.com/codahale/bcrypt-ruby" target="_blank">bcrypt</a> s'occupe de tout convertir pour toi. Pour ceci tu vas devoir faire quelques manipulations.</p>
<p>On te propose de faire quelques tests tout en suivant le cours&nbsp;: cr√©√© une app Rails <code>test_bcrypt</code>.</p>

<h4>3.2.1. Installer la gem</h4>
<p>Ajoute bcrypt √† ton Gemfile, puis <code>bundle install</code></p>
<p><b>Astuce </b>: bcrypt est d√©j√† dans le Gemfile, il faut juste 
d√©-commenter la ligne. G√©n√©ralement, c'est bon signe quand tu n'as que 
√ßa √† faire&nbsp;: c'est que la gem est bien consid√©r√©e comme faisant 
partie int√©grante des fonctionnalit√©s courantes d'une app Rails.</p>


<h4>3.2.2. Une migration pour ajouter la colonne du mot de passe</h4>
<p>Il te faut disposer d'un model <code>User</code> avec une table <code>users</code> contenant une colonne <code>password_digest</code>
 (c'est le hash du password - le mot de passe crypt√© - et c'est un 
string). Pour que l'exemple soit r√©aliste, on va aussi ajouter une 
colonne <code>email</code> (string). Mets cela en place avec la commande de terminal <code>$ rails g model User email:string password_digest:string</code>. Puis passe la migration pour cr√©er la table (pense √† cr√©er ta BDD si t'es en PostGre üôÑ).</p>

<p>A noter que si la table et le model existaient d√©j√†, tu n'aurais eu qu'√† faire une migration pour ajouter la colonne <code>password_digest</code> :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> change
  add_column <span class="token symbol">:users</span><span class="token punctuation">,</span> <span class="token symbol">:password_digest</span><span class="token punctuation">,</span> <span class="token symbol">:string</span>
<span class="token keyword">end</span></code></pre>

<h4>3.2.3. Mentionner la gestion des mots de passe dans le model</h4>
<p>Dans ton model <code>User</code>, tu vas indiquer que bcrypt est en charge de g√©rer et hasher les mots de passe. Pour cela, rajoute la ligne&nbsp;: </p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token const">User</span> &lt; <span class="token const">ApplicationRecord</span>
  has_secure_password
<span class="token keyword">end</span></code></pre>

<p>√Ä pr√©sent, bcrypt est fonctionnel et te met √† disposition les fonctionnalit√©s suivantes :</p>
<ul>
  <li>Si tu fais <code>my_user = User.create(password: "foobar")</code>, un user va √™tre cr√©√© et bcrypt transformera "foobar" en hash s√©curis√© qui sera stock√© dans <code>password_digest</code>.</li>
  <li>Si tu as un objet de typer <code>User</code>, tu peux demander √† bcrypt de v√©rifier si un string correspond √† son mot de passe. Pour cela, si l'objet porte le nom <code>my_user</code>, tapes : <code>my_user.authenticate("test de mot de passe")</code>. <br>
  =&gt; Si ce mot de passe ne correspond pas √† celui entr√© par l'utilisateur, bcrypt te retourne <code>false</code> <br>
  =&gt; S‚Äôil correspond, bcrypt te retourne tout simplement l'objet <code>my_user</code>.</li>
  <li>Enfin, tu peux faire comme pr√®s de 100&nbsp;% des sites sur Terre 
et demander, √† l'inscription, un password et sa confirmation. Dans ce 
cas-l√†, tu peux faire <code>User.create(password: "motdepasse", password_confirmation: "laconfirmation")</code> et bcrypt n'enregistrera un utilisateur en base QUE si password et password_confirmation sont identiques. Sinon Rollback.</li>
</ul>

<p> √âvidemment, tu peux aussi rajouter une contrainte sur le mot de 
passe, par exemple refuser qu'il soit vide ou trop court. Pour rappel, 
c'est simple √† impl√©menter avec la ligne suivante dans le model <code>User</code>&nbsp;: <code>validates :password, presence: true, length: { minimum: 6 }</code>.</p>

<h4>3.2.4. Tests en console</h4>
<p>Ton model est pr√™t, et tu n'auras plus qu'√† brancher les bonnes m√©thodes de controller. Testons ceci en console :</p>

<pre class=" language-ruby"><code class=" language-ruby">&gt;&gt; u <span class="token operator">=</span> <span class="token const">User</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>email<span class="token punctuation">:</span> <span class="token string">"email@example.com"</span><span class="token punctuation">,</span> password<span class="token punctuation">:</span> <span class="token string">"foobar"</span><span class="token punctuation">)</span>
<span class="token operator">=</span>&gt; <span class="token comment">#&lt;User id: 1, email: "email@example.com", password_digest: "$2a$10$T2/g3aj1LS6KUBZts69Yaeeq62oijKnL0VXtsL0Jd5S...",  created_at: "2019-02-05 14:31:30", updated_at: "2019-02-05 14:31:30"&gt;
</span>
&gt;&gt; my_user <span class="token operator">=</span> <span class="token const">User</span><span class="token punctuation">.</span>find_by<span class="token punctuation">(</span>email<span class="token punctuation">:</span> <span class="token string">"email@example.com"</span><span class="token punctuation">)</span>
&gt;&gt; my_user<span class="token punctuation">.</span>password
<span class="token operator">=</span>&gt; <span class="token keyword">nil</span>

&gt;&gt; my_user<span class="token punctuation">.</span>password_digest
<span class="token operator">=</span>&gt; <span class="token string">"$2a$10$2a$10$T2/g3aj1LS6KUBZts69Yaeeq62oijKnL0VXtsL0Jd5S"</span>

&gt;&gt; my_user<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span><span class="token string">"not_the_right_password"</span><span class="token punctuation">)</span>
<span class="token keyword">false</span>
&gt;&gt; my_user<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span><span class="token string">"foobaz"</span><span class="token punctuation">)</span>
<span class="token keyword">false</span>

&gt;&gt; my_user<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span><span class="token string">"foobar"</span><span class="token punctuation">)</span>
<span class="token operator">=</span>&gt; <span class="token comment">#&lt;User id: 1, email: "email@example.com", created_at: "2016-05-23 20:36:46", updated_at: "2016-05-23 20:36:46",  password_digest: "$2a$10$xxucoRlMp06RLJSfWpZ8hO8Dt9AZXlGRi3usP3njQg3..."&gt;</span></code></pre>

<h4>3.2.5. Quels impacts sur une app Rails&nbsp;?</h4>
<p>Ces points seront mis en pratique plus tard, mais on t'en parle d√®s √† pr√©sent.</p>
<h5>a) Pour cr√©er un utilisateur</h5>
<p>Par rapport √† ce qu'on a vu jusque-l√†, la m√©thode <code>#create</code> du controller <code>users</code> ne change quasiment pas. Simplement, il faut r√©cup√©rer le mot de passe depuis le formulaire d'inscription (via <code>params</code>) et faire un simple <code>User.new(email: "xxx", password: "yyy")</code>. La gem bcrypt s'occupe de tout c√¥t√© model pour encrypter le password&nbsp;: Fat model, skinny controller&nbsp;!</p>

<h5>b) Pour qu'un utilisateur se connecte</h5>
<p>Il faut mettre en place un formulaire de connexion (e-mail + mot de passe), en r√©cup√©rer les infos (via <code>params</code>) et utiliser dans le controller les m√©thodes <code>.find_by(email: xx)</code> (pour identifier l'utilisateur d'apr√®s son e-mail) et <code>.authenticate(xxxx)</code> (pour v√©rifier si le mot de passe correspond). Reporte-toi √† l'exemple de la console ci-dessus si n√©cessaire.</p>
<p>Si on trouve bien un utilisateur √† cet e-mail et que le mot de passe 
correspond, on peut le laisser se connecter en ouvrant une session avec <code>session[:user_id] = my_user.id</code>. Reporte-toi √† la ressource sur les sessions pour en savoir plus.</p>


<h2>4. Points importants √† retenir</h2>
<p>Il ne faut <b>jamais</b> stocker un mot de passe en clair, mais dans un hash s√©curis√©.</p>
<p>Sur Rails, la gem bcrypt s'occupe de produire le hash. Tu n'as qu'√† l'installer puis faire les √©tapes suivantes :</p>

<ul>
  <li>Faire une migration pour ajouter √† <code>users</code> une colonne <code>password_digest</code> qui est un string</li>
  <li>Ajouter la ligne <code>has_secure_password</code> dans le model des utilisateurs</li>
  <li>√âventuellement faire une validation pour le <code>password</code> avec presence true et minimum de caract√®re fix√© √† 6 (ce que proposent tous les sites s√©rieux)</li>
</ul>

<p>C'est tout üòé. A partir de l√†, bcrypt s'occupe de crypter les mots de passe dans <code>password_digest</code>.</p>
<p>Tu peux alors jouer avec des <code>my_user = User.create(password: "foobar")</code>, des <code>my_user.authenticate("test de mot de passe")</code> ou encore des <code>User.create(password: "motdepasse", password_confirmation: "laconfirmation")</code>.</p>

<h2>5. Pour aller plus loin</h2>

<p>Pour compl√©ter notre explication sur les mots de passe, je te propose deux vid√©os de <a href="https://www.youtube.com/channel/UC9-y-6csu5WGm29I7JiwpnA" target="_blank">ComputerPhile</a> sur les gestions de mots de passe&nbsp;:

</p><ul>
  <li><a href="https://www.youtube.com/watch?v=8ZtInClXe1Q" target="_blank">Comment stocker ses mots de passe</a></li>
  <li><a href="https://www.youtube.com/watch?v=7U-RbOKanYs" target="_blank">Comment hacker des mots de passe</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #5E66E5">
<h1>
Ressource : 
Cr√©er des sessions et ses propres helpers
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/lessons/242/lesson_submissions/new"><i class="ft-edit" data-original-title="Proposer une am√©lioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>Dans cette ressource, tu vas voir comment g√©rer un utilisateur 
connect√© sur ton site web. Chacune des actions qu'il entreprendra seront
 alors consid√©r√©es comme provenant de lui&nbsp;: il pourra √©crire des 
potins dont il sera directement l'auteur, modifier son profil, etc. Oh 
yeah&nbsp;!</p>

<p>L'√©l√©ment central qui va permettre de g√©rer cela, ce sont les 
sessions. Nous te montrerons comment mettre en place tes propres helpers
 afin d'appeler facilement des m√©thodes que tu souhaites utiliser sur 
presque toutes les views. Finalement, nous te pr√©senterons le <code>before_action</code> qui permet d'effectuer, au sein des controllers, des t√¢ches avant m√™me que la m√©thode appel√©e ne soit ex√©cut√©e.</p>

<h2>2. Historique et contexte</h2>
<p>Ce cours va t'apprendre √† impl√©menter toi-m√™me une session 
"utilisateur connect√©" sur Rails afin de stocker des informations 
jusqu'√† d√©connexion de l'utilisateur. Dans quelques jours, on te 
pr√©sentera, une gem (Devise) qui automatisera la mise en place des 
sessions utilisateurs. Mais il est toujours int√©ressant, pour les 
concepts importants comme celui-ci, de l'avoir impl√©ment√© au moins une 
fois soi-m√™me avant d'apprendre la m√©thode raccourcie / automatis√©e.</p>

<h2>3. La ressource</h2>

<h3>3.1. Les sessions</h3>
<h4>3.1.1. Introduction aux sessions</h4>
<p>Quand tu vas sur Facebook, que tu te connectes, et que tu navigues 
sur le site, ce dernier se souvient que tu es connect√© bien que tu 
passes de page en page. Cette magie noire est plut√¥t simple √† mettre en 
place&nbsp;: Facebook stocke sur ton navigateur une petite information 
qui indiquera, √† chaque chargement de page, que tu es l'utilisateur 
num√©ro XXXX. Cette information est souvent stock√©e sous la forme de 
cookies&nbsp;: entre aujourd'hui et demain, nous allons t'apprendre √† 
coder toi-m√™me un syst√®me de cookies. La premi√®re √©tape est de 
comprendre les sessions.</p>

<p>En Rails, <code>session</code> est un hash qui est stock√© dans un 
coin du navigateur web et qui va suivre le visiteur tout au long de sa 
navigation. Il est grosso modo cr√©√© quand ce dernier arrive sur ton 
site, et est d√©truit quand il ferme son navigateur. √Ä l'inverse de <code>params</code>, qui se vide de son contenu √† chaque changement de page, le hash <code>session</code> conserve les informations jusqu'√† fermeture du navigateur. <br>
En tant qu'application, tu peux √©crire et lire √† volont√© sur <code>session</code>. Si par exemple tu fais <code>session[:salut] = "Message sympa"</code> dans la m√©thode d'un controller, tu pourras retrouver cette info dans un autre controller (par exemple avec <code>puts session[:salut]</code>). Mais l'usage le plus courant de <code>session</code> est de stocker l'<code>id</code>
 de l'utilisateur actuellement connect√©. Ainsi, √† chaque nouvelle page 
charg√©e, on pourra retrouver quel utilisateur est en train de la 
visualiser. Tu feras √ßa dans tes controllers avec les lignes suivantes :</p>

<pre class=" language-ruby"><code class=" language-ruby">id <span class="token operator">=</span> session<span class="token punctuation">[</span><span class="token symbol">:user_id</span><span class="token punctuation">]</span>
<span class="token inst-var">@user</span> <span class="token operator">=</span> <span class="token const">User</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment">#et hop, cette variable @user est l'instance User contenant toutes les infos de l'utilisateur connect√©</span></code></pre>

<p>Pour g√©rer les connexions √† ton app Rails, on va g√©rer des "sessions" via un <code>sessions_controller</code> qui contiendra les m√©thodes avec <code>#new</code>, <code>#create</code>, et <code>#destroy</code>. </p>
<ul>
  <li>La cr√©ation d'une session se fera au travers de la page de login o√π l'on demande mot de passe et email. </li>
  <li>Puis la m√©thode <code>#create</code> va s'occuper d'essayer 
d'authentifier l'utilisateur avec le couple email-mot de passe. Si ce 
dernier est bien authentifi√©, nous stockerons l'info avec <code>session[:user_id] = user.id</code>. S'il n'est pas bien authentifi√©, on fera un render de la page de login avec les messages d'erreur.</li>
  <li>Une fois l'utilisateur connect√©, ce sera tr√®s simple de retrouver notre utilisateur gr√¢ce √† <code>User.find(session[:user_id])</code> </li>
</ul>


<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Tu peux t'amuser √† voir tes sessions et 
cookies dans Inspecteur d'√©l√©ments -&gt; Application -&gt; Storage -&gt;
 Cookies -&gt; Localhost:3000. Si tu supprimes le hash <code>session</code>, c'est comme si tu fermais ton navigateur&nbsp;!</p>
      <p>De plus, √©tant donn√© que les cookies temporaires de <code>session</code> sont automatiquement chiffr√©s, faire <code>User.find(session[:user_id])</code> pour r√©cup√©rer un utilisateur est s√©curis√©. Ce n'est pas possible pour un hacker d'utiliser les informations de <code>session</code>
 pour usurper ton identit√©. Par contre, les cookies permanents sont 
moins s√©curis√©s&nbsp;: ils sont vuln√©rables √† une attaque au 
d√©tournement de session, et nous verrons demain comment √™tre prudent en 
les utilisant.</p>
    </div>
  </div>
</div>

<h4>3.1.2. sessions_controller</h4>
<p>Ici, une session n'est pas un objet en soi. Il n'existe pas de model <code>Session</code>
 ni d'enregistrement dans la base de donn√©e. En fait, on consid√®re 
qu'une session est cr√©√©e √† l'instant o√π un utilisateur se connecte √† son
 compte sur ton site web&nbsp;: on a alors une information dans le hash <code>session[:user_id]</code>. Si personne n'est connect√©, il n'y a pas de session et <code>session[:user_id] = nil</code>.</p>

<p>Une session utilisateur pouvant √™tre cr√©√©e ou supprim√©e, il semble 
logique d'en confier la gestion √† un controller √† part enti√®re. Il 
s'agira de <code>sessions_controller</code> et il disposera de trois m√©thodes :</p>

<ul>
  <li><code>#new</code> qui correspond √† la page de login</li>
  <li><code>#create</code> qui effectuera l'authentification (traitement
 des informations saisies dans la page login et sauvegarde de l'info de 
l'utilisateur connect√© dans <code>session</code>)</li>
  <li><code>#destroy</code> qui correspond au logout</li>
</ul>

<p>Les routes seront celles habituelles, gr√¢ce √† un <code>resources :sessions, only: [:new, :create, :destroy]</code>.</p>

<h5>a) new et create</h5>
<p>La view new va juste demander l‚Äôe-mail et le mot de passe √† 
l'utilisateur via un formulaire, ce dernier pointant vers la m√©thode 
create. </p>
<p>La m√©thode <code>create</code> ressemblera √† ceci :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> create
  <span class="token comment"># cherche s'il existe un utilisateur en base avec l‚Äôe-mail
</span>  user <span class="token operator">=</span> <span class="token const">User</span><span class="token punctuation">.</span>find_by<span class="token punctuation">(</span>email<span class="token punctuation">:</span> email_dans_ton_params<span class="token punctuation">)</span>

  <span class="token comment"># on v√©rifie si l'utilisateur existe bien ET si on arrive √† l'authentifier (m√©thode bcrypt) avec le mot de passe 
</span>  <span class="token keyword">if</span> user &amp;&amp; user<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span>password_dans_ton_params<span class="token punctuation">)</span>
    session<span class="token punctuation">[</span><span class="token symbol">:user_id</span><span class="token punctuation">]</span> <span class="token operator">=</span> user<span class="token punctuation">.</span>id
    <span class="token comment"># redirige o√π tu veux, avec un flash ou pas
</span>
  <span class="token keyword">else</span>
    flash<span class="token punctuation">.</span>now<span class="token punctuation">[</span><span class="token symbol">:danger</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Invalid email/password combination'</span>
    render <span class="token string">'new'</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>

<h5>b) utiliser ensuite l'info de <code>session</code></h5>
<p>Gr√¢ce au <code>create</code> de <code>sessions_controller</code>, on a pu stocker l'<code>id</code> de l'utilisateur actuellement connect√©. <br>
Maintenant, √† partir de cet <code>id</code>, tu peux remonter √† l'utilisateur pour avoir ses infos. Par exemple tu peux faire une view <code>/profile</code> qui aura comme code :</p>
<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Bienvenue &lt;%= User.find_by(id: session[:user_id]).first_name %&gt; !<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span></code></pre>

<p>Ou alors cr√©er un potin et le lier imm√©diatement √† l'utilisateur 
connect√© (qui est forc√©ment l'auteur), en mettant dans la m√©thode <code>create</code> de <code>gossips_controller</code> :</p>
<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> create
  <span class="token inst-var">@gossip</span> <span class="token operator">=</span> <span class="token const">Gossip</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>gossip_params<span class="token punctuation">)</span>
  <span class="token inst-var">@gossip</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token const">User</span><span class="token punctuation">.</span>find_by<span class="token punctuation">(</span>id<span class="token punctuation">:</span> session<span class="token punctuation">[</span><span class="token symbol">:user_id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token inst-var">@gossip</span><span class="token punctuation">.</span>save
    flash<span class="token punctuation">[</span><span class="token symbol">:success</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Potin bien cr√©√© !"</span>
    redirect_to root_path
  <span class="token keyword">else</span>
    render <span class="token punctuation">:</span><span class="token keyword">new</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre><br>

<p>Cette fa√ßon de faire est tout √† fait fonctionnelle, mais tu remarques d√©j√† qu'on √©crit plusieurs fois <code>User.find_by(id: session[:user_id])</code>. Et c'est pas tr√®s DRY de se r√©p√©ter en Rails ! <br>
Nous verrons plus loin comment remplacer ce code par un simple appel √† une m√©thode <code>current_user</code> qui fera la m√™me chose.</p>

<h5>c) destroy</h5>
<p>Destroy permet de d√©connecter l'utilisateur. Cliquer sur le bouton "Se d√©connecter" revient √† supprimer le contenu de <code>session[:user_id]</code>. <br>
Le lien de ton bouton "Se d√©connecter" devrait ressembler √† ceci :</p>

<pre class=" language-html"><code class=" language-html">&lt;%= link_to "Se d√©connecter", session_path(session.id), method: :delete %&gt;</code></pre>

<p>Ce qui a pour effet d'appeler la m√©thode <code>#destroy</code> de ton sessions_controller. Cette m√©thode devrait ressembler √† ceci :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> destroy
  session<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token symbol">:user_id</span><span class="token punctuation">)</span>
<span class="token keyword">end</span></code></pre>


<h3>3.2. Les helpers</h3>
<h4>3.2.1. Introduction</h4>
<p>Nous allons apprendre √† changer un <code>User.find_by(id: session[:user_id])</code> en un plus simple <code>current_user</code> avec deux raisons en t√™te :</p>

<ol>
  <li>En Rails, c'est <b>le mal</b> de faire un appel au model (= une requ√™te SQL) dans une vue. C'est le r√¥le du controller&nbsp;! Le moindre <code>find</code> dans la view et c'est <code>-30</code> points en test technique.</li>
  <li>En Rails on aime le code bien DRY et bien lisible. <code>current_user</code> c'est tr√®s lisible et plus court que l'autre p√¢t√©.</li>
</ol>

<p>Pour refactorer (= condenser) de cette fa√ßon notre code, nous allons 
passer par un helper. Les helpers se rangent dans le dossier <code>app/helpers/</code>&nbsp;:
 ils ont pour mission de cr√©er des m√©thodes pour remplacer les bouts de 
code qu'on utilise fr√©quemment. Tout ce que tu as √† faire, c'est de 
mettre dans ton controller&nbsp;: </p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token const">TonController</span> &lt; <span class="token const">ApplicationController</span>
  include <span class="token const">TonHelper</span>
<span class="token keyword">end</span></code></pre>

<p><code>TonHelper</code> correspond au fichier <code>app/helpers/ton_helper.rb</code> qui devrait ressembler √† ceci :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">module</span> <span class="token const">TonHelper</span>
  <span class="token keyword">def</span> some_method
    <span class="token comment"># une m√©thode et son code
</span>  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>

<h4>3.2.2. SessionsHelper</h4>
<p>Nous allons donc cr√©er un helper pour les sessions des utilisateurs. 
Toutefois, il faut savoir qu'on va y faire appel dans quasiment TOUS les
 controllers et se taper un <code>include SessionsHelper</code> dans chacun d'eux, √ßa va vite √™tre fastidieux. La solution, c'est de rajouter la ligne dans <code>app/controllers/application_controller.rb</code> qui est, en quelque sorte, le parent de tous les controllers. <br>
Si tu es perspicace, tu auras not√© que chaque controller commence par la ligne <code>class TonController &lt; ApplicationController</code>&nbsp;: en fait ils h√©ritent tous de <code>ApplicationController</code>&nbsp;!
 Au final, c'est un peu le controller ultime&nbsp;: tout ce qui est 
√©crit dedans, tu peux consid√©rer qu'il est √©crit dans chaque controller.</p>
<p>Donc une fois la ligne rajout√©e, il faut cr√©er un fichier <code>app/helpers/sessions_helper.rb</code> et y mettre les lignes suivantes :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">module</span> <span class="token const">SessionsHelper</span>
   <span class="token keyword">def</span> current_user
    <span class="token const">User</span><span class="token punctuation">.</span>find_by<span class="token punctuation">(</span>id<span class="token punctuation">:</span> session<span class="token punctuation">[</span><span class="token symbol">:user_id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>

   <span class="token keyword">def</span> log_in<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
    session<span class="token punctuation">[</span><span class="token symbol">:user_id</span><span class="token punctuation">]</span> <span class="token operator">=</span> user<span class="token punctuation">.</span>id
  <span class="token keyword">end</span>

<span class="token keyword">end</span></code></pre>

<p>Et voil√†&nbsp;! Maintenant tu peux appeler <code>current_user</code> dans n'importe quel controller ou view, et cette m√©thode te retournera l'instance de <code>User</code> contenant les infos de ton utilisateur connect√©.</p>

<p> Tu noteras m√™me qu'on s'est amus√©s √† faire une m√©thode <code>login(user)</code>,
 qui nous servira √† connecter facilement l'utilisateur. √áa permet de 
l'appeler √† la page login mais aussi juste apr√®s la cr√©ation d'un nouvel
 utilisateur (par exemple).</p>


<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">‚ö†Ô∏è ALERTE ERREUR COMMUNE</h4>
      <p>Dans ta view, tu pourrais √™tre tent√© d'√©crire direct des <code>current_user.email</code>.
 Mais il faut g√©rer les 2 cas&nbsp;: 1) un utilisateur est connect√© et 
2) personne n'est connect√©. L√†, si personne n'est connect√©, tu auras un 
joli <code>undefined method `email' for nil:NilClass</code>. <br>
      Pour √©viter √ßa, pr√©voit de rajouter un <code>if current_user</code>, ou m√™me coder une m√©thode <code>logged_in?</code> dans le helper. Cette m√©thode te retournerait <code>true</code> si <code>session[:user_id]</code> est non-nil et <code>false</code> dans le cas contraire.</p>
    </div>
  </div>
</div>



<h3>3.3. Utiliser <code>before_action</code></h3>
<p>Prenons l'exemple d'une page qui ne peut √™tre accessible QUE par un utilisateur connect√© (par exemple une page en <code>/dashboard</code>).
 Comment mettre en place un filtre pour rejeter les personnes non 
connect√©es&nbsp;? √áa c'est une mission pour le controller&nbsp;! Eh bien
 c'est exactement le taf du controller&nbsp;! Ce dernier va v√©rifier si 
l'utilisateur est login, et puis il va le rediriger vers la page de 
login s'il n'est pas connect√©. </p> 
<p>On pourrait imaginer de faire quelque chose comme √ßa dans la m√©thode qui pointe vers <code>/dashboard</code> :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> index
<span class="token keyword">unless</span> current_user
  flash<span class="token punctuation">[</span><span class="token symbol">:danger</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Please log in."</span>
  redirect_to new_session_path
<span class="token keyword">else</span>
  <span class="token comment"># on code quelque chose qui permet d'afficher le dashboard de l'utilisateur
</span><span class="token keyword">end</span></code></pre>

<p>Sauf qu'on peut faire √ßa beaucoup plus proprement. La bonne fa√ßon de le pr√©senter, c'est de faire √ßa dans une m√©thode priv√©e <code>authenticate_user</code>, et de l'appeler EN AMONT de la m√©thode du controller, gr√¢ce √† un callback <code>before_action</code>. Voici le r√©sultat :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token const">TonController</span> &lt; <span class="token const">ApplicationController</span>
  before_action <span class="token symbol">:authenticate_user</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">]</span>

  <span class="token keyword">def</span> index
    <span class="token comment"># on code quelque chose qui permet d'afficher le dashboard de l'utilisateur
</span>  <span class="token keyword">end</span>

  private

  <span class="token keyword">def</span> authenticate_user
    <span class="token keyword">unless</span> current_user
      flash<span class="token punctuation">[</span><span class="token symbol">:danger</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Please log in."</span>
      redirect_to new_session_path
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

<span class="token keyword">end</span></code></pre>

<p>Gr√¢ce √† ce magnifique callback, √† chaque fois que la m√©thode index de ton controller est appel√©e, la m√©thode <code>authenticate_user</code>
 va √™tre ex√©cut√©e en amont. Elle filtrera les utilisateurs non connect√©s
 pour les rediriger vers la page login&nbsp;: en quelques lignes tu 
viens de s√©curiser ton application&nbsp;!</p>

<h2>4. Points importants √† retenir</h2>
<p>Tu peux stocker des informations au sein du hash <code>session</code>. Son contenu est conserv√© jusqu'√† fermeture du navigateur.</p>
<p>Pour g√©rer la connexion / d√©connexion des utilisateurs √† leur compte, il faut cr√©er un controller <code>sessions_controller</code> contenant les m√©thodes <code>#new</code>, <code>#create</code> et <code>#destroy</code>.</p>
<p>Ces m√©thodes vont permettre de stocker l'<code>id</code> de l'utilisateur connect√© dans <code>session[:user_id]</code></p>
<p>Les helpers se rangent dans le dossier <code>app/helpers/</code>&nbsp;:
 ils ont pour mission de cr√©er des m√©thodes pour remplacer les bouts de 
code qu'on utilise fr√©quemment. Par exemple, le fait de r√©cup√©rer 
l'identit√© de l'utilisateur connect√© avec <code>current_user</code>.</p>
<p>Les helpers utilis√©s dans de nombreux controllers peuvent √™tre rajout√©s √† <code>ApplicationController</code> via un <code>include TonHelper</code>. </p>
<p>Le callback <code>before_action :authenticate_user, only: [:index]</code> permet d'ex√©cuter la m√©thode <code>authenticate_user</code> AVANT une m√©thode du controller (ici la m√©thode <code>index</code>). </p>

<h2>5. Pour aller plus loin</h2>
<p>Nous verrons demain comment faire les cookies permanents.</p>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #FF4081">
<h1>
Projets : 
Gossip Project : Facebook style
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/projects/90/project_submissions/new"><i class="ft-edit" data-original-title="Proposer une am√©lioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>√áa y est ! Tu commences √† ma√Ætriser les fondamentaux de Rails, les 
termes de MVC, routes, params et bases de donn√©es te sont familiers et 
tu commences √† √™tre fier des quelques applications que tu as cod√© cette 
semaine.</p>

<p>Aujourd'hui, nous allons un peu plus loin avec notre application 
Gossip Project, en rajoutant des features un peu plus styl√©es que tu 
pourras peut-√™tre r√©utiliser pour l'architecture de ton projet final.</p>
<p>Pour commencer, tu peux reprendre ton app d'hier car la base de donn√©es reste globalement la m√™me.</p>

<p>Ce projet sera peu guid√©, je vais juste te donner une liste de 
fonctionnalit√©s que ton app devra avoir et tu vas les impl√©menter. 
Celles-ci reprendrons essentiellement ce que tu as vu cette semaine et 
la semaine derni√®re.</p>

<p>Voici ce que tu vas devoir impl√©menter dans l'application :</p>

<ul>
	<li>Nous allons commencer par un CRUD succinct des utilisateurs : cr√©ation</li>
	<li>Nous allons mettre en place un syst√®me de login / logout avec une page de connexion</li>
	<li>Nous allons faire en sorte que les potins cr√©√©s soient associ√©s √† l'utilisateur en cours, idem pour les commentaires</li>
	<li>Nous allons rendre impossible la cr√©ation de potin si l'utilisateur n'est pas connect√©. Idem pour <code>show</code> du potin</li>
	<li>√âdition et destruction des potins</li>
	<li>Puis nous allons mettre en place le syst√®me de likes</li>
</ul>


<h2>2. Le projet</h2>

<h3>2.1. Cr√©ation d'utilisateurs</h3>
<p>Fais donc une cr√©ation d'utilisateur, avec la notion de mot de passe.
 Bien entendu, le mot de passe ne sera pas stock√© en clair dans ta base 
de donn√©es.</p>

<p>Le lien pour s'inscrire devra √™tre sur la navbar. Et une fois 
l'utilisateur inscrit l'utilisateur sera redirig√© vers la page 
d'accueil.</p>

<h3>2.2. Login / logout</h3>
<h4>2.2.1. Login</h4>
<p>Nous allons mettre un √©cran de connexion √† l'application qui 
demandera email et mot de passe. Cet √©cran va cr√©er une session si tu 
arrives √† authentifier l'utilisateur avec l'email ou le mot de passe, 
puis le rediriger vers la page d'accueil s'il arrive √† se connecter. 
Cela sera reli√© au <code>sessions_controller</code> (m√©thodes <code>#new</code> et <code>#create</code>)</p>

<p>Aussi, √† la cr√©ation de l'utilisateur, il faut login l'utilisateur.</p>

<h4>2.2.2. Logout</h4>
<p>Maintenant il faut faire <code>sessions#destroy</code>. Code la m√©thode.</p>


<h4>2.2.3. Login / Signup</h4>
<p>Dans la majorit√© des sites (le notre inclus), tu pourras retrouver en
 haut √† droite un bouton qui change en fonction de l'√©tat de 
l'utilisateur

</p><ul>
	<li>Si l'utilisateur n'est pas connect√©, il y aura un  <a href="https://getbootstrap.com/docs/4.0/components/dropdowns/" target="_blank">dropdown</a> "S'inscrire / Se connecter", avec un bouton pour lien (<code>users#new</code>) et un lien pour se connecter (<code>sessions#new</code>)</li>
	<li>Si l'utilisateur est connect√©, il y aura un bouton pour se d√©connecter (<code>sessions#destroy</code>)</li>
</ul>

<p>Ta mission est mettre en place ceci.</p>

<h3>2.3. Cr√©ation des potins</h3>
<p>Quand tu cr√©√©s un potin, ce dernier est associ√© √† un utilisateur de 
ta base. Arrange-toi pour faire en sorte que le potin cr√©√© soit associ√© √†
 l'utilisateur connect√©. Fais de m√™me avec les commentaires.</p>

<h3>2.4. Impossible de comm√©rer sans inscription</h3>
<p>Si actuellement tu cr√©es un potin alors que le visiteur n'est pas 
connect√©, cela va te renvoyer un bug. C'est pas incroyable. Il faut donc
 faire en sorte que les m√©thodes <code>#new</code> et <code>#create</code>
 v√©rifient que l'utilisateur est bien connect√© avant de se lancer. Si ce
 dernier n'est pas connect√©, l'application devra le renvoyer vers 
l'√©cran de login. Fais la m√™me pour l'affichage du potin, et la cr√©ation
 de commentaires.</p>



<p>indice : <code>before_action</code></p>



<h3>2.5. √âdition et destruction des potins</h3>
<p>Pour le moment, tout le monde peut √©diter un potin. Arrange-toi pour 
que le bouton pour pouvoir √©diter le potin n'apparaisse QUE si 
l'utilisateur connect√© est le cr√©ateur du potin. De plus, les m√©thodes <code>gossips#edit</code>, <code>gossips#update</code> et <code>gossips#destroy</code>
 doivent v√©rifier que le current_user soit bien le cr√©ateur du potin : 
impossible de faire ces actions (afficher le formulaire d'√©dition du 
potin, pouvoir √©diter le potin, pouvoir d√©truire le potin) si ce n'est 
pas le cr√©ateur qui le fait !</p>


<h3>2.6. Like that</h3>
<p>Nous allons mettre en place un syst√®me de likes, yahou ! Il faut que 
l'on soit capable de liker un potin sur la page d'index des potins, sur 
la page des villes (qui affiche les potins pour une ville donn√©e), ainsi
 que sur la page d'affichage d'un potin.</p>

<p>Le like sera attribu√© √† l'utilisateur en cours (comme Facebook) donc 
il est impossible de liker si le visiteur n'est pas connect√©. Enfin, sur
 les pages mentionn√©es plus haut, ins√®re aussi un petit espace qui dit 
le nombre de likes d'un potin.</p>

<p>Pour finir : il est possible de d√©liker un potin.</p>


<h2>3.Rendu attendu</h2>
<p>Un gossip project qui d√©chire !</p>

<p>‚ö† il est <b>interdit</b> d'utiliser une gem d'authentification comme Devise ou Clearance. Seule bcrypt est autoris√©e.</p>
</div>
</div>
</div>
</div>
</div>
</div>

</div>

      </div>
    </div>
<script type="text/javascript" id="hs-script-loader" src="s6j4_fichiers/9310539_003.js"></script><script type="text/javascript" id="">(function(e,c){if(!c.__SV){var l,h;window.mixpanel=c;c._i=[];c.init=function(q,r,f){function t(d,a){var g=a.split(".");2==g.length&&(d=d[g[0]],a=g[1]);d[a]=function(){d.push([a].concat(Array.prototype.slice.call(arguments,0)))}}var b=c;"undefined"!==typeof f?b=c[f]=[]:f="mixpanel";b.people=b.people||[];b.toString=function(d){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);d||(a+=" (stub)");return a};b.people.toString=function(){return b.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<l.length;h++)t(b,l[h]);var n="set set_once union unset remove delete".split(" ");b.get_group=function(){function d(p){a[p]=function(){call2_args=arguments;call2=[p].concat(Array.prototype.slice.call(call2_args,0));b.push([g,call2])}}for(var a={},g=["get_group"].concat(Array.prototype.slice.call(arguments,0)),m=0;m<n.length;m++)d(n[m]);return a};c._i.push([q,r,f])};c.__SV=1.2;var k=e.createElement("script");k.type="text/javascript";k.async=!0;k.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=e.getElementsByTagName("script")[0];e.parentNode.insertBefore(k,e)}})(document,window.mixpanel||[]);mixpanel.init("ab79c62023f2a925bfe5f7922c70de67");mixpanel.track("Sign up");</script>
<script type="text/javascript" id="">!function(){var a=window.analytics=window.analytics||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0;a.methods="trackSubmit trackClick trackLink trackForm pageview identify reset group track ready alias debug page once off on addSourceMiddleware addIntegrationMiddleware setAnonymousId addDestinationMiddleware".split(" ");a.factory=function(b){return function(){var c=Array.prototype.slice.call(arguments);c.unshift(b);
a.push(c);return a}};for(var e=0;e<a.methods.length;e++){var f=a.methods[e];a[f]=a.factory(f)}a.load=function(b,c){var d=document.createElement("script");d.type="text/javascript";d.async=!0;d.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(d,b);a._loadOptions=c};a._writeKey="HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j";a.SNIPPET_VERSION="4.13.2";a.load("HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j");a.page()}}();</script>


    <div class="thp-flashes"></div>



    <script src="s6j4_fichiers/dashboard-6681459c92372465340c.js"></script>
    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  


<iframe style="display: none; visibility: hidden;" owner="archetype" title="archetype"></iframe></body></html>