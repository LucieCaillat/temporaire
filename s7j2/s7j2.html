<!DOCTYPE html>
<html class="loaded" lang="fr"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript" async="" src="s7j2_fichiers/insight.js"></script><script type="text/javascript" src="s7j2_fichiers/NRJS-71f55aa980e498e276b"></script><script src="s7j2_fichiers/nr-1212.js"></script><script type="text/javascript" async="" src="s7j2_fichiers/gtm_002.js"></script><script type="text/javascript" src="s7j2_fichiers/commons.js" async="" status="loaded"></script><script type="text/javascript" src="s7j2_fichiers/google-tag-manager.js" async="" status="loaded"></script><script src="s7j2_fichiers/conversations-embed.js" type="text/javascript" id="hubspot-messages-loader" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s7j2_fichiers/9310539_002.js" type="text/javascript" id="hs-analytics"></script><script src="s7j2_fichiers/9310539_003.js" type="text/javascript" id="cookieBanner-9310539" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s7j2_fichiers/fb.js" type="text/javascript" id="hs-ads-pixel-9310539" data-ads-portal-id="9310539" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s7j2_fichiers/collectedforms.js" type="text/javascript" id="CollectedForms-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s7j2_fichiers/leadflows.js" type="text/javascript" id="LeadFlows-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script type="text/javascript" async="" src="s7j2_fichiers/analytics.js"></script><script type="text/javascript" async="" src="s7j2_fichiers/mixpanel-2-latest.js"></script><script type="text/javascript" async="" src="s7j2_fichiers/conversion_async.js"></script><script type="text/javascript" async="" src="s7j2_fichiers/analytics_002.js"></script><script async="" crossorigin="anonymous" src="s7j2_fichiers/fs.js"></script><script src="s7j2_fichiers/773401719499556.js" async=""></script><script async="" src="s7j2_fichiers/fbevents.js"></script><script async="" src="s7j2_fichiers/gtm.js"></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"NRJS-71f55aa980e498e276b","applicationID":"576835834","transactionName":"dgpYEBRYDg9XQh8AA0YNVAsHRQZMVlFJF01GDVkT","queueTime":4,"applicationTime":172,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-71f55aa980e498e276b",applicationID:"576835834"};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var i=e[n]={exports:{}};t[n][0].call(i.exports,function(e){var i=t[n][1][e];return r(i||e)},i,i.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,n){function r(){}function i(t,e,n,r){return function(){return s.recordSupportability("API/"+e+"/called"),o(t+e,[u.now()].concat(c(arguments)),n?null:this,r),n?void 0:this}}var o=t("handle"),a=t(10),c=t(11),f=t("ee").get("tracer"),u=t("loader"),s=t(4),d=NREUM;"undefined"==typeof window.newrelic&&(newrelic=d);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",v=l+"ixn-";a(p,function(t,e){d[e]=i(l,e,!0,"api")}),d.addPageAction=i(l,"addPageAction",!0),d.setCurrentRouteName=i(l,"routeName",!0),e.exports=newrelic,d.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(t,e){var n={},r=this,i="function"==typeof e;return o(v+"tracer",[u.now(),t,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return e.apply(this,arguments)}catch(t){throw f.emit("fn-err",[arguments,this,t],n),t}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){m[e]=i(v,e)}),newrelic.noticeError=function(t,e){"string"==typeof t&&(t=new Error(t)),s.recordSupportability("API/noticeError/called"),o("err",[t,u.now(),!1,e])}},{}],2:[function(t,e,n){function r(t){if(NREUM.init){for(var e=NREUM.init,n=t.split("."),r=0;r<n.length-1;r++)if(e=e[n[r]],"object"!=typeof e)return;return e=e[n[n.length-1]]}}e.exports={getConfiguration:r}},{}],3:[function(t,e,n){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}catch(o){}e.exports=function(t){return r?{passive:!0,capture:!!t}:!!t}},{}],4:[function(t,e,n){function r(t,e){var n=[a,t,{name:t},e];return o("storeMetric",n,null,"api"),n}function i(t,e){var n=[c,t,{name:t},e];return o("storeEventMetrics",n,null,"api"),n}var o=t("handle"),a="sm",c="cm";e.exports={constants:{SUPPORTABILITY_METRIC:a,CUSTOM_METRIC:c},recordSupportability:r,recordCustom:i}},{}],5:[function(t,e,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=t(12);e.exports=r,e.exports.offset=a,e.exports.getLastTimestamp=i},{}],6:[function(t,e,n){function r(t){return!(!t||!t.protocol||"file:"===t.protocol)}e.exports=r},{}],7:[function(t,e,n){function r(t,e){var n=t.getEntries();n.forEach(function(t){"first-paint"===t.name?p("timing",["fp",Math.floor(t.startTime)]):"first-contentful-paint"===t.name&&p("timing",["fcp",Math.floor(t.startTime)])})}function i(t,e){var n=t.getEntries();if(n.length>0){var r=n[n.length-1];if(f&&f<r.startTime)return;p("lcp",[r])}}function o(t){t.getEntries().forEach(function(t){t.hadRecentInput||p("cls",[t])})}function a(t){if(t instanceof g&&!y){var e=Math.round(t.timeStamp),n={type:t.type};e<=l.now()?n.fid=l.now()-e:e>l.offset&&e<=Date.now()?(e-=l.offset,n.fid=l.now()-e):e=l.now(),y=!0,p("timing",["fi",e,n])}}function c(t){"hidden"===t&&(f=l.now(),p("pageHide",[f]))}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d,p=t("handle"),l=t("loader"),v=t(9),m=t(3),g=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){u=new PerformanceObserver(r);try{u.observe({entryTypes:["paint"]})}catch(h){}s=new PerformanceObserver(i);try{s.observe({entryTypes:["largest-contentful-paint"]})}catch(h){}d=new PerformanceObserver(o);try{d.observe({type:"layout-shift",buffered:!0})}catch(h){}}if("addEventListener"in document){var y=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(t){document.addEventListener(t,a,m(!1))})}v(c)}},{}],8:[function(t,e,n){function r(t,e){if(!i)return!1;if(t!==i)return!1;if(!e)return!0;if(!o)return!1;for(var n=o.split("."),r=e.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}e.exports={agent:i,version:o,match:r}},{}],9:[function(t,e,n){function r(t){function e(){t(c&&document[c]?document[c]:document[o]?"hidden":"visible")}"addEventListener"in document&&a&&document.addEventListener(a,e,i(!1))}var i=t(3);e.exports=r;var o,a,c;"undefined"!=typeof document.hidden?(o="hidden",a="visibilitychange",c="visibilityState"):"undefined"!=typeof document.msHidden?(o="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(o="webkitHidden",a="webkitvisibilitychange",c="webkitVisibilityState")},{}],10:[function(t,e,n){function r(t,e){var n=[],r="",o=0;for(r in t)i.call(t,r)&&(n[o]=e(r,t[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],11:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(i<0?0:i);++r<i;)o[r]=t[e+r];return o}e.exports=r},{}],12:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(t,e,n){function r(){}function i(t){function e(t){return t&&t instanceof r?t:t?u(t,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){t&&a&&t(n,r,i);for(var c=e(i),f=m(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[w[n]];return p&&p.push([b,n,r,c]),c}}function o(t,e){y[t]=m(t).concat(e)}function v(t,e){var n=y[t];if(n)for(var r=0;r<n.length;r++)n[r]===e&&n.splice(r,1)}function m(t){return y[t]||[]}function g(t){return p[t]=p[t]||i(n)}function h(t,e){l.aborted||s(t,function(t,n){e=e||"feature",w[n]=e,e in d||(d[e]=[])})}var y={},w={},b={on:o,addEventListener:o,removeEventListener:v,emit:n,get:g,listeners:m,context:e,buffer:h,abort:c,aborted:!1};return b}function o(t){return u(t,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=t("gos"),s=t(10),d={},p={},l=e.exports=i();e.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(t,e,n){function r(t,e,n){if(i.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return t[e]=r,r}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){i.buffer([t],r),i.emit(t,e,n)}var i=t("ee").get("handle");e.exports=r,r.ee=i},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,o,function(){return i++})}var i=1,o="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!T++){var t=P.info=NREUM.info,e=g.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(O,function(e,n){t[e]||(t[e]=n)});var n=a();c("mark",["onload",n+P.offset],null,"api"),c("timing",["load",n]);var r=g.createElement("script");0===t.agent.indexOf("http://")||0===t.agent.indexOf("https://")?r.src=t.agent:r.src=v+"://"+t.agent,e.parentNode.insertBefore(r,e)}}function i(){"complete"===g.readyState&&o()}function o(){c("mark",["domContent",a()+P.offset],null,"api")}var a=t(5),c=t("handle"),f=t(10),u=t("ee"),s=t(8),d=t(6),p=t(2),l=t(3),v=p.getConfiguration("ssl")===!1?"http":"https",m=window,g=m.document,h="addEventListener",y="attachEvent",w=m.XMLHttpRequest,b=w&&w.prototype,E=!d(m.location);NREUM.o={ST:setTimeout,SI:m.setImmediate,CT:clearTimeout,XHR:w,REQ:m.Request,EV:m.Event,PR:m.Promise,MO:m.MutationObserver};var x=""+location,O={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1212.min.js"},M=w&&b&&b[h]&&!/CriOS/.test(navigator.userAgent),P=e.exports={offset:a.getLastTimestamp(),now:a,origin:x,features:{},xhrWrappable:M,userAgent:s,disabled:E};if(!E){t(1),t(7),g[h]?(g[h]("DOMContentLoaded",o,l(!1)),m[h]("load",r,l(!1))):(g[y]("onreadystatechange",i),m[y]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var T=0}},{}],"wrap-function":[function(t,e,n){function r(t,e){function n(e,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],t)}c(n+"start",[o,a,f],s,u);try{return p=e.apply(a,o)}catch(v){throw c(n+"err",[o,a,v],s,u),v}finally{c(n+"end",[o,a,p],s,u)}}return a(e)?e:(n||(n=""),nrWrapper[p]=e,o(e,nrWrapper,t),nrWrapper)}function r(t,e,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<e.length;u++)f=e[u],c=t[f],a(c)||(t[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!v||e){var c=v;v=!0;try{t.emit(n,r,o,e,a)}catch(f){i([f,n,r,o],t)}v=c}}return t||(t=s),n.inPlace=r,n.flag=p,n}function i(t,e){e||(e=s);try{e.emit("internal-error",t)}catch(n){}}function o(t,e,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(t);return r.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(o){i([o],n)}for(var a in t)l.call(t,a)&&(e[a]=t[a]);return e}function a(t){return!(t&&t instanceof Function&&t.apply&&!t[p])}function c(t,e){var n=e(t);return n[p]=t,o(t,n,s),n}function f(t,e,n){var r=t[e];t[e]=c(r,n)}function u(){for(var t=arguments.length,e=new Array(t),n=0;n<t;++n)e[n]=arguments[n];return e}var s=t("ee"),d=t(11),p="nr@original",l=Object.prototype.hasOwnProperty,v=!1;e.exports=r,e.exports.wrapFunction=c,e.exports.wrapInPlace=f,e.exports.argsToArray=u},{}]},{},["loader"]);</script>
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="WYNjozv1Kw8KcMY0QDJo/UbHvnXQ3BkRqfD2+Gr0q5gqE02HlBV8PsIhsOWAI9Fh4plNQ/59/FawV7HMI6IPBA==">
    <title>Le tableau de bord | The Hacking Project</title>
<meta name="description" content="Nous cassons les codes de l'éducation, vous apprenez d'où vous voulez, en communauté.">
<meta name="robots" content="noindex, nofollow">
<meta property="og:title" content="Le tableau de bord">
<meta property="og:site_name" content="The Hacking Project">
<meta name="url" content="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/2">
<meta name="image" content="https://www.thehackingproject.org/packs/images/logo/20210910-THP-Logo_color_transparent-31229dd881904e010092de63be97cdfa.png">


    <link rel="apple-touch-icon" sizes="180x180" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-c01aaccf467f7cc3d79bbce743d60779f5b833fdc4500cebd07a5e11a07a5c31.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-precomposed-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.thehackingproject.org/assets/favicon/favicon-32x32-804b12d1c41c60fe721477b7c3b0a32811dc610580dd40ac92f1cc04cbd05ca4.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.thehackingproject.org/assets/favicon/favicon-16x16-d96ba65e5785d32474df9ebc6fbfd5442c751d527b10981a474bc3b7a4079d01.png">
<link rel="manifest" href="https://www.thehackingproject.org/assets/favicon/manifest-cf975201fd8ac78a1f1a203357573d50031f1cc33436d099743df6428b8a38a2.json">
<link rel="mask-icon" href="https://www.thehackingproject.org/assets/favicon/safari-pinned-tab-8af1cfcf7525ccdccb490f9f5adad396653a4969b419e0a9a9d3a1088140a912.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://www.thehackingproject.org/assets/favicon/favicon-cbf10361dc90b277565960736d4897fddef5468bff6299811ea9498459d56d21.ico">
<meta name="msapplication-config" content="/assets/favicon/browserconfig-dab38db6040ef54ac56e91fdd77e3d7b06746a634e87b68c99b59b216cb8611a.xml">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" media="screen" href="s7j2_fichiers/vendor-dab9e12f0ba58215899de05f149caa5f.css">
    <link rel="stylesheet" media="screen" href="s7j2_fichiers/dashboard-4ab6ba9737cbfc4c38b17a9a4de7833a.css">
    <link rel="stylesheet" media="screen" href="s7j2_fichiers/dashboard-ea5a94b9045ccb8d8ce8974b71b640603915dc183d5907c643.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="s7j2_fichiers/js.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-105991867-1');
  </script>
<!-- End Google Analytics -->

<!-- Google Tag Manager -->
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-P8XRQ3M");
</script>
<!-- End Google Tag Manager -->

<!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
         fbq('init', '773401719499556');
        fbq('track', 'PageView');
    </script>
    <noscript>
     <img height="1" width="1"
    src="https://www.facebook.com/tr?id=773401719499556&ev=PageView
    &noscript=1"/>
    </noscript>
<!-- End Facebook Pixel Code -->

<script>
window['_fs_debug'] = false;
window['_fs_host'] = 'fullstory.com';
window['_fs_script'] = 'edge.fullstory.com/s/fs.js';
window['_fs_org'] = '14AEET';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
    g=m[e]=function(a,b,s){g.q?g.q.push([a,b,s]):g._api(a,b,s);};g.q=[];
    o=n.createElement(t);o.async=1;o.crossOrigin='anonymous';o.src='https://'+_fs_script;
    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
    g.identify=function(i,v,s){g(l,{uid:i},s);if(v)g(l,v,s)};g.setUserVars=function(v,s){g(l,v,s)};g.event=function(i,v,s){g('event',{n:i,p:v},s)};
    g.anonymize=function(){g.identify(!!0)};
    g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
    g.log = function(a,b){g("log",[a,b])};
    g.consent=function(a){g("consent",!arguments.length||a)};
    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
    g.clearUserCookie=function(){};
    g.setVars=function(n, p){g('setVars',[n,p]);};
    g._w={};y='XMLHttpRequest';g._w[y]=m[y];y='fetch';g._w[y]=m[y];
    if(m[y])m[y]=function(){return g._w[y].apply(this,arguments)};
    g._v="1.3.0";
})(window,document,window['_fs_namespace'],'script','user');
</script>
<!-- Start of HubSpot Embed Code -->
<script async="" defer="defer" id="hs-script-loader" src="s7j2_fichiers/9310539.js" type="text/javascript"></script>
<!-- End of HubSpot Embed Code -->


    <script src="s7j2_fichiers/thp-3cc5aa6fdf57842a7b6c714621cc7f2d3d31b51cb700b1de4e795d773.js"></script>
    <script src="s7j2_fichiers/manifest-1613feea780cfc5342f4.js"></script>
    <script src="s7j2_fichiers/vendor-ff3cb5540e737de52c97.js"></script>
    <script src="s7j2_fichiers/dashboard-25875e14460b4458b1bccffaa93d4a8cbee9691b06d54976fde.js"></script>

    <link href="s7j2_fichiers/css.css" rel="stylesheet">
  <script src="s7j2_fichiers/a"></script></head>

  <body class="vertical-layout 2-columns fixed-navbar menu-hide vertical-overlay-menu" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns" data-thp-controller="days" data-thp-action="show" data-thp-layout="dashboard"><style type="text/css">html.hs-messages-widget-open.hs-messages-mobile,html.hs-messages-widget-open.hs-messages-mobile body{overflow:hidden!important;position:relative!important}html.hs-messages-widget-open.hs-messages-mobile body{height:100%!important;margin:0!important}#hubspot-messages-iframe-container{display:initial!important;z-index:2147483647;position:fixed!important;bottom:0!important}#hubspot-messages-iframe-container.widget-align-left{left:0!important}#hubspot-messages-iframe-container.widget-align-right{right:0!important}#hubspot-messages-iframe-container.internal{z-index:1016}#hubspot-messages-iframe-container.internal iframe{min-width:108px}#hubspot-messages-iframe-container .shadow-container{display:initial!important;z-index:-1;position:absolute;width:0;height:0;bottom:0;content:""}#hubspot-messages-iframe-container .shadow-container.internal{display:none!important}#hubspot-messages-iframe-container .shadow-container.active{width:400px;height:400px}#hubspot-messages-iframe-container iframe{display:initial!important;width:100%!important;height:100%!important;border:none!important;position:absolute!important;bottom:0!important;right:0!important;background:transparent!important}</style>
    <!-- Google Tag Manager (noscript) -->
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-P8XRQ3M' style='display:none;visibility:hidden' width='0'></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->



    <nav class="header-navbar navbar-expand-md navbar navbar-with-menu navbar-without-dd-arrow fixed-top navbar-semi-light" style="padding:0;">
<div class="navbar-wrapper">
<div class="navbar-container content">
<div class="collapse navbar-collapse show" id="navbar-mobile">
<ul class="nav navbar-nav mr-auto float-left">
<li class="nav-item mobile-menu d-md-none mr-auto">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu font-large-1"></i>
</a>
</li>
<li class="nav-item d-none d-md-block">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu"></i>
</a>
</li>
</ul>
<ul class="nav navbar-nav float-right">
<li class="dropdown dropdown-user nav-item">
<a class="dropdown-toggle nav-link dropdown-user-link" data-toggle="dropdown" href="#">
<span class="avatar avatar-online">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s7j2_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
</a>
<div class="dropdown-menu dropdown-menu-right">
<div class="arrow_box_right">
<a class="dropdown-toggle nav-link dropdown-user-link" href="https://www.thehackingproject.org/fr/dashboard/profile/user"><span class="avatar avatar-online pt-0">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s7j2_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
<span class="user-name text-bold-700 ml-1 text-dark">
Lucie
</span>
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit"><i class="ft-edit"></i>Éditer profil
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit?edit=danger"><i class="ft-alert-triangle"></i>Zone à risques
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" rel="nofollow" data-method="delete" href="https://www.thehackingproject.org/users/sign_out?locale=fr"><i class="ft-power"></i>
Déconnexion
</a></div>
</div>
</li>
</ul>
</div>
</div>
</div>
</nav>

      <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true">
<div class="navbar-header">
<ul class="nav navbar-nav flex-row">
<li class="nav-item mr-auto">
<a class="navbar-brand" href="https://www.thehackingproject.org/?locale=fr"><h3 class="brand-text">The Hacking Project</h3>
</a></li>
<li class="nav-item d-md-none">
<a class="nav-link close-navbar">
<i class="ft-x"></i>
</a>
</li>
</ul>
</div>
<div class="main-menu-content">
<ul class="navigation navigation-main" data-menu="menu-navigation" id="main-menu-navigation">
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard"><i class="ft-calendar"></i>
<span class="menu-title" data-i18n="">
Aujourd'hui
</span>
</a></li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard"><i class="ft-monitor"></i>
<span class="menu-title" data-i18n="">
Mon dashboard
</span>
</a></li>
<li class="nav-item has-sub">
<a href="#"><i class="fas fa-user-graduate"></i>
<span class="menu-title" data-i18n="">
Mon inscription
</span>
</a><ul class="menu-content">
<li>
<a href="https://www.thehackingproject.org/parcours?locale=fr">Choisir un parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/new">Nouveau parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/7209/edit">Changer parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/modalites">Modalités</a>
</li>
</ul>
</li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/certifications"><i class="fa ft-download"></i>
<span class="menu-title" data-i18n="">
Documents
</span>
</a></li>
<br>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/help"><i class="fa ft-help-circle"></i>
<span class="menu-title" data-i18n="">
Aide
</span>
</a></li>
</ul>
</div>
</div>



    <div class="app-content content">
      <div class="content-wrapper">
        <div class="content-wrapper-before"></div>
        <div class="content-header row"></div>
        <div class="container">
<div class="row">
<div class="col-12">
<ol class="breadcrumb">
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard">Dashboard</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1">Fullstack web</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4">Rails avancé</a>
</li>
<li class="breadcrumb-item active">
Devise
</li>
</ol>
</div>
</div>
<!-- / PARTIAL FOR FREE MOUSSES -->
<!-- / PARTIAL FOR NEXT -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-body">
<div class="row">
<div class="col-12 col-xl-12 text-center mb-3">
<h2 class="mb-2">
Rails avancé
</h2>
<h3>
<i class="ft-alert-triangle danger" data-placement="top" data-toggle="tooltip" title="" data-original-title="Attention : nous n'avons pas encore reçu ton projet aujourd'hui. N'oublie pas de le soumettre en bas."></i>
Devise
</h3>
<h4>
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet à rendre ce jour-là"></i>

</h4>
<h5>
Découverte de Devise: Gérer des utilisateurs très facilement
</h5>
</div>
<div class="col-12 col-xl-12 timeline-left" id="activity">
<div class="timeline pt-2">
<ul class="list-unstyled base-timeline activity-timeline">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/1"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/1">Lundi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">

Mailer et événements
</div>
</div>
<small class="text-muted">
Nous allons te montrer comment te servir du mailer de Rails, qui permet 
d'envoyer des emails. On te donnera les bonnes astuces pour que ton 
mailer fonctionne en production.
</small>
</li>
<li>
<div class="timeline-icon bg-primary">
<i class="ft-map-pin font-medium-1"></i>
</div>
<div class="act-time">
Mardi
</div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet à rendre ce jour-là"></i>

Devise
</div>
</div>
<small class="text-muted">
Découverte de Devise: Gérer des utilisateurs très facilement
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/3"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/3">Mercredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journée là"></i>

Services et API 
</div>
</div>
<small class="text-muted">
Ce jour là va se couper en deux parties : - tu vas commencer par 
découvrir comment insérer de manière propre tes programmes de Plain Old 
Ruby Object (PORO) qui n'ont rien à voir avec Rails : les services - 
ensuite tu vas jouer avec des APIs pour insérer des fonctionnalités très
 pratique comme le paiement ou la localisation.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/4"><div class="timeline-icon bg-dark">
<i class="ft-calendar font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/4">Jeudi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">

Asset Pipeline &amp; Active Storage
</div>
</div>
<small class="text-muted">
Tu vas voir deux éléments importants qui vont bien ensemble : nous te 
montrerons l'Asset Pipeline qui te donnera la possibilité d'afficher des
 images et de jouer avec le CSS et JavaScript de manière avancée. 
Ensuite, grâce à Active Storage, tu vas savoir comment gérer l'upload de
 fichiers (notamment d'images) dans Rails.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/5"><div class="timeline-icon bg-dark">
<i class="ft-calendar font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/4/days/5">Vendredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">

Interface administrateur
</div>
</div>
<small class="text-muted">
Tu vas voir comment faire une belle interface administrateur pour gérer tes utilisateurs 😈
</small>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Les fameuses corrections qui n'arrivent que les jours concernés -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #5E66E5">
<h1>
Ressource : 
Devise
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/lessons/61/lesson_submissions/new"><i class="ft-edit" data-original-title="Proposer une amélioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>La semaine dernière tu as vu comment faire des logins à la main. 
C'est plutôt long et fastidieux. Et encore, nous n'avons pas implémenté 
d'e-mail de confirmation de compte ou de système de récupération de mot 
de passe (qui nécessitent d'utiliser des tokens et des hash).</p>
<p> Aujourd'hui, tu vas voir une gem qui te fait tout ce travail et qui va vite te devenir indispensable sur Rails : la gem <a href="https://github.com/plataformatec/devise" target="_blank">Devise</a>.</p>

<p>Devise permet de créer un système d'authentification complet en générant pour toi :</p>

<ul>
  <li>L'inscription, avec mot de passe et e-mail sécurisé ;</li>
  <li>La notion de login, logout, session, current user ;</li>
  <li>La récupération de mot de passe par e-mail ;</li>
  <li>La confirmation de compte par e-mail ;</li>
  <li>Le comptage de login ;</li>
  <li>Le logout après un certain temps d'inactivité ;</li>
  <li>Le blocage de compte après un certain nombre de tentatives de login ratées.</li>
</ul>

<p>Bref, une gem très puissante qui t'aidera à bien gérer tes futures 
applications. Dans cette ressource, nous allons t'aider à la dompter.</p>

<h2>2. Historique et contexte</h2>
<p>Devise a été créée <a href="http://blog.plataformatec.com.br/2009/10/devise-flexible-authentication-solution-for-rails/" target="_blank">fin 2009</a>
 par plataformatec, un cabinet de conseil spécialisé en Rails. C'est 
devenu un standard en Rails et on te conseille de toujours l'appliquer à
 tes futures applications : ça doit être quasiment la première 
fonctionnalité que tu implémentes !</p>

<h2>3. La ressource</h2>

<h3>3.1. Les fonctionnalités de Devise</h3>
<p>Chaque fonctionnalité de Devise est inclus dans un module qu'on peut activer ou non :</p>

<ul>
  <li><b>Database Authenticatable</b> : possibilité de stocker les mots 
de passe dans leur version hashée pour valider l'authenticité d'un 
utilisateur pendant sa connexion (la base quoi) ;</li>
  <li><b>Registerable</b> : possibilité de créer un compte via un formulaire. Aussi, possibilité d'éditer et de supprimer son compte ;</li>
  <li><b>Recoverable</b> : possibilité de réinitialiser le mot de passe et d'envoyer des instructions par e-mail ;</li>
  <li><b>Rememberable</b> : possibilité d'utiliser le fameux cookie <a href="https://www.youtube.com/watch?v=fKKNPLowteY" target="_blank">remember me</a> (la session reste ouverte) ;</li>
  <li><b>Validatable</b> : possibilité de donner des validations pour les e-mails et mots de passe (taille, regex, etc) ;</li>
  <li><b>Omniauthable</b> : possibilité de gestion de OmniAuth (un service pour se connecter via son compte Google, Facebook ou autre) ;</li>
  <li><b>Confirmable</b> : possibilité de forcer la confirmation par e-mail du compte ;</li>
  <li><b>Trackable</b> : possibilité de tracker le nombre de login, leurs timestamps, et les adresses IP ;</li>
  <li><b>Timeoutable</b> : possibilité d'expirer des sessions après un certain temps d'inactivité ;</li>
  <li><b>Lockable</b> : possibilité de verrouiller un compte après trop de tentatives échouées de connexions ;</li>
</ul>

<p>Nous allons voir dans cette ressource les plus importantes : Database
 Authenticatable, Registerable, Recoverable, Rememberable, Validatable.</p>

<h3>3.2. Présentation de Devise</h3>
<p>Nous allons faire un petit pas à pas pour que tu puisses voir les 
éléments importants de Devise. Prêt ? En avant : commence par créer une 
app bidon rails. Ensuite, fais chaque opération en même temps que je la 
décris.</p>

<h4>3.2.1. Installation</h4>
<p>Pour installer Devise, il faut d'abord commencer par mettre la gem dans le Gemfile, puis faire bundle install.</p>

<p>Ensuite, installe Devise avec la commande suivante :</p>

<pre class=" language-ruby"><code class=" language-ruby">$ rails generate devise<span class="token symbol">:install</span></code></pre>

<p>Ce qui a pour effet de créer deux fichiers :</p>

<ul>
  <li><code>config/initializers/devise.rb</code> : le fichier de 
configuration de Devise. On s'en servira par exemple pour paramétrer le 
service que l'on va utiliser pour les envois d'e-mails ;</li>
  <li><code>config/locales/devise.en.yml</code> : un fichier contenant les messages d'erreur de Devise. Tu pourras utiliser <a href="https://github.com/plataformatec/devise/wiki/I18n#french-devisefryml" target="_blank">ses version françaises</a> quand tu seras plus à l'aise avec la gem.</li>
</ul>

<p>Après avoir créé les fichiers, le terminal va t'afficher un message 
avec 4 actions indispensables à mener. La plus importante est la 
première : il faut que tu paramètres bien Action Mailer afin que Devise 
puisse passer par lui pour envoyer des emails (notamment pour 
réinitialiser un mot de passe). Hier nous avons vu comment faire les 
branchements ActionMailer en local et sur Heroku : assure-toi toujours 
qu'il y a au moins l'information suivante dans le fichier <code>config/environments/development.rb</code> :</p>

<pre class=" language-ruby"><code class=" language-ruby">config<span class="token punctuation">.</span>action_mailer<span class="token punctuation">.</span>default_url_options <span class="token operator">=</span> <span class="token punctuation">{</span> host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> port<span class="token punctuation">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span></code></pre>

<p>Grâce à ça, quand tu cliqueras sur "réinitialiser mon mot de passe" 
pour la tester, l'application ne plantera pas. Maintenant tout est réglé
 pour utiliser Devise. Super !</p>

<h4>3.2.2. Génération du model</h4>

<p>Devise utilise comme Rails un générateur qui va nous mâcher le 
travail. Pour dire à Devise quel model va être géré par elle (avec la 
notion de session, login, etc), il faut faire <code>rails g devise NomDuModel</code>.</p>
<p> La majorité du temps cela concerne les utilisateurs, mais parfois 
cela peut concerner les admins (par exemple un blog accessible à tout 
visiteur). Ainsi, pour une app normale dans laquelle nous voulons avoir 
Devise branchée sur les utilisateurs, tu dois faire :</p>

<pre class=" language-shell"><code class=" language-shell">$ rails g devise User</code></pre>

<p>Cela va créer et modifier quelques fichiers, mais trois nous 
intéressent beaucoup : un fichier de migration, un fichier de model, et 
une modification des routes.</p>

<h5>a) Le fichier de migration</h5>
<p>Voici le fichier de migration que Devise va te générer :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token comment"># frozen_string_literal: true
</span>
<span class="token keyword">class</span> <span class="token const">DeviseCreateUsers</span> &lt; <span class="token const">ActiveRecord</span><span class="token punctuation">:</span><span class="token symbol">:Migration</span><span class="token punctuation">[</span><span class="token number">5.2</span><span class="token punctuation">]</span>
  <span class="token keyword">def</span> change
    create_table <span class="token symbol">:users</span> <span class="token keyword">do</span> <span class="token operator">|</span>t<span class="token operator">|</span>
      <span class="token comment">## Database authenticatable
</span>      t<span class="token punctuation">.</span>string <span class="token symbol">:email</span><span class="token punctuation">,</span>              null<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span> default<span class="token punctuation">:</span> <span class="token string">""</span>
      t<span class="token punctuation">.</span>string <span class="token symbol">:encrypted_password</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span> default<span class="token punctuation">:</span> <span class="token string">""</span>

      <span class="token comment">## Recoverable
</span>      t<span class="token punctuation">.</span>string   <span class="token symbol">:reset_password_token</span>
      t<span class="token punctuation">.</span>datetime <span class="token symbol">:reset_password_sent_at</span>

      <span class="token comment">## Rememberable
</span>      t<span class="token punctuation">.</span>datetime <span class="token symbol">:remember_created_at</span>

      <span class="token comment">## Trackable
</span>      <span class="token comment"># t.integer  :sign_in_count, default: 0, null: false
</span>      <span class="token comment"># t.datetime :current_sign_in_at
</span>      <span class="token comment"># t.datetime :last_sign_in_at
</span>      <span class="token comment"># t.inet     :current_sign_in_ip
</span>      <span class="token comment"># t.inet     :last_sign_in_ip
</span>
      <span class="token comment">## Confirmable
</span>      <span class="token comment"># t.string   :confirmation_token
</span>      <span class="token comment"># t.datetime :confirmed_at
</span>      <span class="token comment"># t.datetime :confirmation_sent_at
</span>      <span class="token comment"># t.string   :unconfirmed_email # Only if using reconfirmable
</span>
      <span class="token comment">## Lockable
</span>      <span class="token comment"># t.integer  :failed_attempts, default: 0, null: false # Only if lock strategy is :failed_attempts
</span>      <span class="token comment"># t.string   :unlock_token # Only if unlock strategy is :email or :both
</span>      <span class="token comment"># t.datetime :locked_at
</span>

      t<span class="token punctuation">.</span>timestamps null<span class="token punctuation">:</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span>

    add_index <span class="token symbol">:users</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">,</span>                unique<span class="token punctuation">:</span> <span class="token keyword">true</span>
    add_index <span class="token symbol">:users</span><span class="token punctuation">,</span> <span class="token symbol">:reset_password_token</span><span class="token punctuation">,</span> unique<span class="token punctuation">:</span> <span class="token keyword">true</span>
    <span class="token comment"># add_index :users, :confirmation_token,   unique: true
</span>    <span class="token comment"># add_index :users, :unlock_token,         unique: true
</span>  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>

<p>C'est une migration pour créer une table <code>users</code>, puis lui
 ajouter les attributs qui serviront à Devise de paramètres. De base, 
Devise ne gère que les attributs sous les sections <code>Database Authenticatable</code>, <code>Registerable</code>, <code>Recoverable</code>, <code>Rememberable</code>, et <code>Validatable</code>.</p>
<p>Les autres attributs peuvent être activés en dé-commentant les lignes
 qui t'intéressent. Comme nous ne nous intéressons qu'aux 5 modules déjà
 activés, inutile de modifier la migration actuelle.</p>


<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">🤓 QUESTION RÉCURRENTE</h4>
      <p><b>Mais dis-donc Jamy, comment on fait si l'on a déjà créé le model <code>User</code> ?</b><br>
        Devise est plutôt intelligente, puisque elle va changer ta migration de <code>create_table</code> à <code>change_table</code>. Il y aura deux détails à gérer :</p>
        <ul>
          <li>Indispensable : Si jamais tu as déjà dans ta table users 
une colonne que Devise utilise (email, encrypted_password, etc), la 
migration plantera puisque Devise les ajoute aussi (impossible de créer 2
 fois un attribut ayant le même nom). Il te faudra enlever ces lignes de
 la migration de Devise.</li>

          <li>Optionnel : La migration générée est séparée en 2 parties: <code>self.up</code> qui liste les changements qui vont avoir lieu sur la table <code>users</code> si la migration est passée et <code>self.down</code> qui liste les changements si on rollback la migration. Tu peux voir un exemple <a href="https://edgeguides.rubyonrails.org/active_record_migrations.html#using-the-up-down-methods" target="_blank">dans la documentation</a>. Il faudra (idéalement - sinon tout rollback sera inefficace) penser à compléter à la main la partie <code>self.down</code> pour lister ce qui doit être enlevé avec des : <code>remove_column</code> ou des <code>remove_index</code>.</li>
        </ul>
    </div>
  </div>
</div>


<h5>b) Le fichier de model</h5>
<p>Voici le fichier de model généré par Devise:</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token const">User</span> &lt; <span class="token const">ApplicationRecord</span>
  <span class="token comment"># Include default devise modules. Others available are:
</span>  <span class="token comment"># :confirmable, :lockable, :timeoutable, :trackable and :omniauthable
</span>  devise <span class="token symbol">:database_authenticatable</span><span class="token punctuation">,</span> <span class="token symbol">:registerable</span><span class="token punctuation">,</span>
         <span class="token symbol">:recoverable</span><span class="token punctuation">,</span> <span class="token symbol">:rememberable</span><span class="token punctuation">,</span> <span class="token symbol">:validatable</span>
<span class="token keyword">end</span></code></pre>

<p>Ces quelques lignes vont juste dire à ton model, "hey, c'est possible de faire, sur tout objet de type <code>User</code>,
 des actions de type database_authenticatable, registerable, 
recoverable, rememberable, et validatable". Tu peux rajouter des actions
 en déplaçant dans la liste <code>devise</code> certaines options présentes en commentaire.</p>


<h5>c) Le fichier des routes</h5>
<p>Normalement le fichier des routes devraient t'afficher <code>devise_for :users</code>. Voyons l'impact de cette ligne avec un petit <code>$ rails routes</code> dans ton terminal :</p>

<pre class=" language-shell"><code class=" language-shell">                   Prefix Verb   URI Pattern                                                                              Controller#Action
         new_user_session GET    /users/sign_in(.:format)                                                                 devise/sessions#new
             user_session POST   /users/sign_in(.:format)                                                                 devise/sessions#create
     destroy_user_session DELETE /users/sign_out(.:format)                                                                devise/sessions#destroy
        new_user_password GET    /users/password/new(.:format)                                                            devise/passwords#new
       edit_user_password GET    /users/password/edit(.:format)                                                           devise/passwords#edit
            user_password PATCH  /users/password(.:format)                                                                devise/passwords#update
                          PUT    /users/password(.:format)                                                                devise/passwords#update
                          POST   /users/password(.:format)                                                                devise/passwords#create
 cancel_user_registration GET    /users/cancel(.:format)                                                                  devise/registrations#cancel
    new_user_registration GET    /users/sign_up(.:format)                                                                 devise/registrations#new
   edit_user_registration GET    /users/edit(.:format)                                                                    devise/registrations#edit
        user_registration PATCH  /users(.:format)                                                                         devise/registrations#update
                          PUT    /users(.:format)                                                                         devise/registrations#update
                          DELETE /users(.:format)                                                                         devise/registrations#destroy
                          POST   /users(.:format)                                                                         devise/registrations#create</code></pre>


<p>On va les décrypter une à une :</p>

<ul>
  <li><code>devise/sessions#new</code> : pour accéder à la view de connexion.</li>
  <li><code>devise/sessions#create</code> : le POST pour se connecter.</li>
  <li><code>devise/sessions#destroy</code> : le DELETE pour se déconnecter.</li>
  <li><code>devise/passwords#new</code> : pour accéder à l'écran "mot de
 passe oublié ?" où tu rentres ton adresse email pour recevoir un email 
de réinitialisation de mot de passe.</li>
  <li><code>devise/passwords#create</code> : le POST pour réinitialiser le mot de passe.</li>
  <li><code>devise/passwords#edit</code> : pour accéder à la view où tu 
rentres ton nouveau mot de passe (tu y accèdes en cliquant dans le lien 
"réinitialiser le mot de passe" dans ton email de réinitialisation de 
mot de passe)</li>
  <li><code>devise/passwords#update</code> : le PATCH/PUT pour changer de mot de passe.</li>
  <li><code>devise/registrations#cancel</code> (rarement utilisée) : pour accéder à la view permettant de supprimer une inscription.</li>
  <li><code>devise/registrations#new</code> : pour accéder à la view d'inscription au site.</li>
  <li><code>devise/registrations#create</code> : le POST pour s'inscrire sur le site.</li>
  <li><code>devise/registrations#edit</code> : pour accéder à la view de modification d'une inscription (notamment son email et son mot de passe).</li>
  <li><code>devise/registrations#update</code> : le PATCH/PUT pour modifier son email et mot de passe</li>
  <li><code>devise/registrations#destroy</code> : le DELETE pour détruire son compte</li>
</ul>

<p>Comme tu peux le voir, Devise gère pas mal de routes pour nous. 
L'autre bonne nouvelle est que les controllers sont déjà faits et que 
(sauf rare exception), il ne faut pas les toucher. A présent, tout est 
branché pour fonctionner correctement en local : il ne reste qu'à gérer 
les views.</p>

<h4>3.2.3. Génération des views</h4>
<p>Avec Devise, il est facile de générer les views que la gem va gérer, il suffit de rentrer la ligne suivante :</p>

<pre class=" language-shell"><code class=" language-shell">$ rails generate devise:views</code></pre>

<p>Ainsi, voici une liste des views qui sont créées par cette commande :</p>

<ul>
  <li><code>app/views/devise/shared/_links.html.erb</code> : une petite 
partial qui affiche les liens dont tu as besoin en fonction de la page 
(exemple : le lien "mot de passe oublié" sur l'écran de connexion).</li>
  <li><code>app/views/devise/confirmations/new.html.erb</code> : l'écran de confirmation (pas besoin pour le moment).</li>
  <li><code>app/views/devise/passwords/edit.html.erb</code> : la vue où 
tu rentres ton nouveau mot de passe (tu y accèdes en cliquant dans le 
lien "réinitialiser le mot de passe" dans ton email de réinitialisation 
de mot de passe).</li>
  <li><code>app/views/devise/passwords/new.html.erb</code> : l'écran "mot de passe oublié ?" où tu rentres ton adresse email pour recevoir un email de réinitialisation de mot de passe.</li>
  <li><code>app/views/devise/registrations/edit.html.erb</code> : l'écran pour modifier les informations de son compte utilisateur (notamment son email et son mot de passe).</li>
  <li><code>app/views/devise/registrations/new.html.erb</code> : la page d'inscription au site.</li>
  <li><code>app/views/devise/sessions/new.html.erb</code> : la page de connexion au site.</li>
  <li><code>app/views/devise/unlocks/new.html.erb</code> : écran pour déverrouiller son compte (pas besoin pour le moment).</li>
</ul>

<p>Au passage, plusieurs e-mails sont générés : </p>
<ul>
  <li><code>app/views/devise/mailer/confirmation_instructions.html.erb</code> : e-mail pour confirmer son compte (pas besoin pour le moment).</li>
  <li><code>app/views/devise/mailer/email_changed.html.erb</code> : e-mail pour annoncer un changement d'e-mail.</li>
  <li><code>app/views/devise/mailer/password_change.html.erb</code> : e-mail pour annoncer que ton mot de passe a été changé.</li>
  <li><code>app/views/devise/mailer/reset_password_instructions.html.erb</code> : e-mail pour donner le lien pour changer de mot de passe.</li>
  <li><code>app/views/devise/mailer/unlock_instructions.html.erb</code> : e-mail pour débloquer ton compte (pas besoin pour le moment).</li>
</ul>

<p>Pour le moment, ces vues sont assez basiques mais elles ont le mérite d'exister ! Lance le serveur, va sur <code>/users/sign_up</code> : tu devrais voir un écran d'inscription avec e-mail et mot de passe rudimentaire, mais fonctionnel.</p>

<img src="s7j2_fichiers/RJS4vNO.png" class="img-fluid">

<p>Clique sur le lien "login" : idem, tu devrais avoir un écran pour te 
connecter, avec en plus le lien pour t'inscrire, et le lien du mot de 
passe oublié. Clique sur ce dernier, qui devrait te demander une adresse
 e-mail, etc.</p>

<p>A ce stade, Devise est prêt à l'emploi. Reste à intégrer les views à l'ensemble de ton app : nous allons voir ça !</p>

<h3>3.3. Intégrer les views de Devise à ton app</h3>
<h4>3.3.1 Les helpers <code>user_signed_in?</code> et <code>current_user</code></h4>
<p>Commençons par créer une page d'accueil : fais <code>$ rails g controller static_pages index secret</code>, ce qui devrait générer un controller <code>static_pages</code> et 2 méthodes (<code>index</code> et <code>secret</code>). Il est assez pratique de réunir toutes tes pages statiques dans un seul et même controller.</p>

<p>Fais en sorte que <code>static_pages#index</code> soit la root de ton application, puis va sur <code>app/views/static_pages/index.html.erb</code> pour y mettre les lignes suivantes :</p>

<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  &lt;% if user_signed_in? %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
      &lt;%= link_to "Sign out", destroy_user_session_path, method: :delete %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
      Voici ton email : &lt;%= current_user.email %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
      &lt;%= link_to "Secret page", static_pages_secret_path %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
      &lt;%= link_to "Edit email / password", edit_user_registration_path %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

  &lt;% else %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>    
      &lt;%= link_to "Sign in", new_user_session_path %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
      &lt;%= link_to "Sign up", new_user_registration_path %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

  &lt;% end %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>

<p>Va sur la page d'accueil et inscris-toi, connecte-toi, déconnecte-toi
 : tu vois que la page d'accueil affiche les boutons qui correspondent à
 ton état de connexion. Tout ça simplement grâce à un <code>if</code> dans la view et l'utilisation de helpers comme <code>user_signed_in?</code> ou <code>current_user</code> dont <a href="https://github.com/plataformatec/devise#controller-filters-and-helpers" target="_blank">la documentation de Devise parle</a>. </p>
<p>Voilà la force de Devise, l'application gère toutes les notions de login / logout pour toi via des helpers, notamment :</p>
<ul>
  <li><code>user_signed_in?</code> te renvoie true/false selon si un utilisateur est connecté ou non.</li>
  <li><code>current_user</code> te renvoie l'objet <code>User</code> correspondant à l'utilisateur connecté.</li>
</ul>
<p>Maintenant prends 5 minutes pour bien comprendre le code de <code>index.html.erb</code> ci-dessus et repère où sont les 2 helpers dont je parle.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">🚀 ALERTE BONNE ASTUCE</h4>
      <p>Si tu mets un email valide dans l'écran "mot de passe oublié", et si tu as bien mis la ligne <code>config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }</code>,
 l'application ne devrait pas t'envoyer d'erreur. Mais si tu n'as pas 
letter_opener de branché, elle te redirige juste vers l'écran de login. 
Que fait-elle alors 🤔 Si tu vas dans ta console de serveur, quelques 
lignes devraient t'intéresser :</p>
      <pre class=" language-shell"><code class=" language-shell">Devise::Mailer#reset_password_instructions: processed outbound mail in 7.2ms
Sent mail to fef@fef.fef (1.2ms)
Date: Tue, 05 Feb 2019 18:06:18 +0100
From: please-change-me-at-config-initializers-devise@example.com
Reply-To: please-change-me-at-config-initializers-devise@example.com
To: fef@fef.fef
Message-ID: &lt;5c59c28a83b46_545d2add4ce62f5462976@felix.mail&gt;
Subject: Reset password instructions
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

&lt;p&gt;Hello fef@fef.fef!&lt;/p&gt;

&lt;p&gt;Someone has requested a link to change your password. You can do this through the link below.&lt;/p&gt;

&lt;p&gt;&lt;a href="http://localhost:3000/users/password/edit?reset_password_token=5nsneTHVGFWypsNVHuc4"&gt;Change my password&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you didn't request this, please ignore this email.&lt;/p&gt;
&lt;p&gt;Your password won't change until you access the link above and create a new one.&lt;/p&gt;

Redirected to http://localhost:3000/users/sign_in
Completed 302 Found in 29ms (ActiveRecord: 10.8ms)</code></pre>

    <p>En gros ton application envoie un email comme convenu (et son 
texte est visible dans le terminal), mais comme rien n'est paramétré 
pour le local, les emails sont justes envoyés via le serveur. Ce qui 
nous intéresse dans cet email, c'est l'url pour réinitialiser son mot de
 passe, celle qui fait <code>http://localhost:3000/users/password/edit?reset_password_token=ton_token</code>.
 Copie-colle cette url (à partir de TON terminal bien entendu sinon le 
token ne sera pas le bon), puis va sur le lien. Tu devrais avoir un lien
 qui te propose de changer ton mot de passe. Trop cool !</p>
    </div>
  </div>
</div>


<h4>3.3.2 Le helper <code>authenticate_user!</code></h4>

<p>Faisons d'autres tests de Devise : va sur la page <code>/users/edit</code>
 en étant connecté. Tu devrais y arriver sans souci. Déconnecte-toi et 
réessaye d'y aller : Devise te bloque et te demande de te connecter. 
Sécurité AU TOP. </p>

<p>Maintenant va sur la page <code>/static_pages/secret</code> en étant 
connecté : top. Puis déconnecte-toi et va dessus en étant déconnecté : 
tu peux y accéder également. Comment ne donner l'accès à cette page 
qu'aux utilisateurs connectés ? Gràce à la méthode <a href="https://github.com/plataformatec/devise#controller-filters-and-helpers" target="_blank">authenticate_user!</a>. Va dans le <code>static_pages_controller</code>, puis ajoute en ligne 2 la ligne suivante :</p>

<pre class=" language-ruby"><code class=" language-ruby">before_action <span class="token symbol">:authenticate_user</span><span class="token operator">!</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:secret</span><span class="token punctuation">]</span></code></pre>

<p>Maintenant tente d'aller sur <code>/static_pages/secret</code> en 
étant déconnecté : super, Devise t'a redirigé vers l'écran de login. 
Petit bonus : si tu te connectes à partir de cet écran, Devise va savoir
 où tu voulais aller et va t'envoyer ensuite sur <code>/static_pages/secret</code>. Pas mal pour une gem.</p>

<h3>3.4. Pimper les views de Devise</h3>
<p>Devise vient avec des views qui sont pour le moins minimalistes. Avec
 Bootstrap, y'a moyen de transformer rapidement les formulaires de 
Devise pour ne pas se retrouver avec un page affreuse de ce style :</p>
<img src="s7j2_fichiers/qU6TAhL.png" class="img-fluid"><br>


<p>Tu auras l'occasion, pendant le projet, de pimper les views mais on 
te propose une page d'inscription au site utilisant Bootstrap :</p>

<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-6 offset-md-3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
      &lt;%= form_for resource, as: resource_name, url: registration_path(resource_name), html: { class: "form-signin mt-3" } do |f| %&gt;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>h3 mb-3 font-weight-normal text-center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Sign up<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        &lt;%= devise_error_messages! %&gt;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          &lt;%= f.label :email, "Email" %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>
          &lt;%= f.email_field :email, autofocus: true, autocomplete: "email", class: "form-control" %&gt;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          &lt;%= f.label :password %&gt;
          &lt;% if @minimum_password_length %&gt;
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">&gt;</span></span>(&lt;%= @minimum_password_length %&gt; characters minimum)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">&gt;</span></span>
          &lt;% end %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>
          &lt;%= f.password_field :password, autocomplete: "new-password", class: "form-control" %&gt;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          &lt;%= f.label :password_confirmation %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>
          &lt;%= f.password_field :password_confirmation, autocomplete: "new-password", class: "form-control" %&gt;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>actions mt-5<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          &lt;%= f.submit "Sign up", class: "btn btn-lg btn-primary btn-block" %&gt;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      &lt;% end %&gt;
      &lt;%= render "devise/shared/links" %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre>

<p>Pour avoir un rendu un peu professionnel, prends le temps de gérer 
les 5 views les plus importantes de Devise : connexion, inscription, 
édition du profil, récupération par mail de son mot de passe et 
changement de mot de passe.</p>

<h3>3.5. Le mailer</h3>
<p>Le mailer est important dans Devise. Sans ce dernier, les 
utilisateurs qui ont perdu leur mot de passe n'ont plus accès à ton 
application et c'est pas ouf... L'avantage est que si ton mailer est 
bien branché, tout devrait être fonctionnel immédiatement, sauf une 
chose : il faut donner l'url de ton application pour la redirection. Je 
m'explique : quand tu vas recevoir un email pour récupérer ton mot de 
passe, l'email va te donner un lien à cliquer qui va rediriger vers 
l'application sur un formulaire pour changer le mot de passe. Il faut 
donc dire à Rails "pour la production (sur Heroku), l'URL de mon app est
 : monapp.herokuapp.com". Insère donc la ligne suivante dans le fichier <code>config/environments/production.rb</code> :</p>

<pre class=" language-ruby"><code class=" language-ruby">config<span class="token punctuation">.</span>action_mailer<span class="token punctuation">.</span>default_url_options <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token symbol">:host</span> <span class="token operator">=</span>&gt; <span class="token string">'YOURAPPNAME.herokuapp.com'</span> <span class="token punctuation">}</span></code></pre>


<h3>3.6. Quelques astuces pour être le champion de Devise</h3>
<p>Devise est très "Convention over configuration". Cette gem aime 
BEAUCOUP les conventions, et en sortir est un appel à la galère. Voici 
donc des astuces si jamais tu veux sortir des <i>rails</i> de Devise :</p>

<h4>3.6.1. Tu veux customiser un controller de Devise</h4>
<p>Changer le code source des controllers de Devise est une <b>très mauvaise</b> idée à ton niveau.</p>

<p>Imaginons que tu veux envoyer un email à un utilisateur à sa 
création, ou enregistrer ses infos sur un fichier Spreadsheet. Ceci est 
un <code>after_create</code> dans ton model et n'a rien à faire dans le controller.</p>

<p>Imaginons que tu veux rediriger sur une page spécifique après 
l'inscription de ton utilisateur. Au lieu de modifier le controller de 
Devise, ces derniers ont prévu une super méthode <code>after_sign_up_path_for</code> qui fera ceci. Tu peux trouver plus d'info <a href="https://github.com/plataformatec/devise/wiki/How-To:-Redirect-to-a-specific-page-on-successful-sign-up-(registration)" target="_blank">sur le wiki de la gem</a>, et voici <a href="https://www.youtube.com/watch?v=1FGwNzBPbPY" target="_blank">une vidéo</a> qui explique cela.</p>

<h4>3.6.2. Tu veux rassembler toutes les informations de l'utilisateur 
sur une seule page à l'inscription et à la modification du profil</h4>
<p>Les pages registrations/edit et registrations/new ne comportent, de 
base, que l'email et le mot de passe de l'utilisateur.  Mais tu veux 
potentiellement pouvoir mettre d'autres informations sur cette page : 
nom, prénom, adresse, etc.</p>
<p>Pour faire cela, deux méthodes :</p>
<ol>
  <li>Tu sépares en 2 views différentes pour te simplifier la vie. On aura une page en <code>registrations/edit</code> pour modifier l'email et le mot de passe (Un peu comme la page <a href="https://github.com/settings/admin" target="_blank">settings/admin</a> de GitHub) et une autre page <code>users/edit</code> pour changer le reste des détails comme ton code postal, ton prénom, ta description de profil, (Un peu comme la page <a href="https://github.com/settings/profile" target="_blank">settings/profile</a> de GitHub)</li>

  <li>Si tu tiens absolument à tout mettre dans une seule page, tu peux regarder <a href="https://gist.github.com/withoutwax/46a05861aa4750384df971b641170407" target="_blank">cet article</a> qui explique comment s'y prendre.</li>
</ol>

<p>En résumé, si on imagine que tu veux pouvoir définir un <code>first_name</code>, <code>last_name</code> et <code>is_alive</code> 😉  à la fois dans la page <code>registration/new</code> (sign-up) et <code>registration/update</code> (update), il te faut rajouter des champs <code>&lt;%= f.text_field :first_name&gt;</code>, <code>&lt;%= f.text_field :last_name&gt;</code> et <code>&lt;%= f.check_box :alive%&gt;</code> dans le <code>form_for</code> de ces views.</p>

<p>Ensuite tu vas dans <code>app/controller/application_controller.rb</code> et tu rajoutes les lignes :</p>

<pre class=" language-ruby"><code class=" language-ruby">before_action <span class="token symbol">:configure_devise_parameters</span><span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">:</span> <span class="token symbol">:devise_controller</span><span class="token operator">?</span>

<span class="token keyword">def</span> configure_devise_parameters
  devise_parameter_sanitizer<span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:sign_up</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">|</span>u<span class="token operator">|</span> u<span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:first_name</span><span class="token punctuation">,</span> <span class="token symbol">:last_name</span><span class="token punctuation">,</span> <span class="token symbol">:is_alive</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token symbol">:password</span><span class="token punctuation">,</span> <span class="token symbol">:password_confirmation</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  devise_parameter_sanitizer<span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:account_update</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">|</span>u<span class="token operator">|</span> u<span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:first_name</span><span class="token punctuation">,</span> <span class="token symbol">:last_name</span><span class="token punctuation">,</span> <span class="token symbol">:is_alive</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token symbol">:password</span><span class="token punctuation">,</span> <span class="token symbol">:password_confirmation</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token keyword">end</span></code></pre>



<h4>3.6.3. Autres astuces ?</h4>
<p>Le <a href="https://github.com/plataformatec/devise/wiki" target="_blank">wiki</a> de Devise a une rubrique <a href="https://github.com/plataformatec/devise/wiki/How-Tos" target="_blank">How-Tos</a> qui contient une centaine de tutoriels pour customiser Devise.</p>



<h2>4. Points importants à retenir</h2>
<p>Pour pouvoir utiliser Devise, voici la marche à suivre :</p>

<ul>
  <li>Mettre Devise dans les gems, puis faire bundle install</li>
  <li>Installer Devise en entrant la ligne <code>$ rails generate devise:install</code>
  <ul>
    <li>Si tu ne l'as pas déjà fait, il faut faire marcher les emails en local dans ton application en mettant la ligne <code>config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }</code> dans ton fichier <code>config/environments/development.rb</code></li>
  </ul></li>
  <li>Devise est installée, tu peux assigner ton model (99% du temps c'est user) à Devise : <code>$ rails g devise user</code>. Puis tu migres.</li>
  <li>Tu génères les views avec <code>$ rails generate devise:views</code></li>
  <li>Les 5 views de Devise devront être retouchées (par exemple avec Bootstrap) pour éviter la page de signup moche</li>
  <li>Tu peux utiliser les super helpers <code>user_signed_in?</code> (retourne true/false selon si un utilisateur est connecté) et <code>current_user</code> (retourne l'objet User correspondant à la personne connectée)</li>
  <li>Tu peux bloquer l'accès des visiteurs non-connectés à une page <code>secret</code> en rajoutant dans le controller lui correspondant un petit <code>before_action :authenticate_user!, only: [:secret]</code></li>
  <li>Tu as juste à appeler les views depuis ta page d'accueil et à toi la gloire !</li>
</ul>


<h2>5. Pour aller plus loin</h2>
<p>Il existe deux autres gems qui s'occupent de l'authentification. 
Elles sont moins "machines à café" que Devise, mais peuvent t'intéresser
 si tu aimes les gems plus minimalistes :</p>

<ul>
  <li><a href="https://github.com/thoughtbot/clearance" target="_blank">Clearance</a> de Thoughbot</li>
  <li><a href="https://github.com/Sorcery/sorcery" target="_blank">Sorcery</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #FF4081">
<h1>
Projets : 
Eventbrite : Devise et premières views
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/projects/101/project_submissions/new"><i class="ft-edit" data-original-title="Proposer une amélioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>Dans ce projet, tu vas reprendre le projet de la veille pour y 
construire tes premières vues. Tu vas installer Devise sur ton 
application et construire les premières vues.</p>

<p>Plus en détails, voici ce que nous attendons de toi :</p>

<ul>
  <li>Tu dois installer Devise sur l'application, et brancher le model <code>User</code> à Devise</li>
  <li>Tu vas brancher Bootstrap à ton application</li>
  <li>Tu vas faire un header qui comprend les liens importants de ton 
application, puis le mettre pour toutes les vues de ton application</li>
  <li>Tu vas faire la page d'accueil du site</li>
  <li>Tu vas faire la page profil d'un utilisateur</li>
  <li>Tu vas faire la page de création d'événement</li>
  <li>Tu vas faire la page qui affiche un événement</li>
</ul>

<p>Cela peut paraître flou, mais avec le REST, quelques méthodes de 
controllers, et un branchement Devise, ton application sera faite bien 
plus rapidement que la semaine qu'il t'a fallu pour l'application Gossip
 Project (alors que les deux applications sont très similaires). Ceci 
est dû principalement au fait que tu commences à gérer la fougère. Bravo
 ;)</p>

<h2>2. Le projet</h2>

<p>Avant de commencer, nous allons faire la première vue de 
l'application : la page d'accueil. Cette page d'accueil est la liste des
 événements de ta ville, donc l'index des événements. Génère un <code>events_controller</code>, avec la méthode index. Branche cette méthode index à la page d'accueil du site.</p>

<h3>2.1. Branchement de Bootstrap</h3>
<p>Bootstrap te permettra d'avoir une navbar qui te permet de naviguer 
dans l'application. Cette navbar contiendra les liens suivants :</p>

<ul>
  <li>Lien pour accéder à l'accueil du site (et donc la liste des événements)</li>
  <li>Lien pour créer un événement (<code>events#new</code>)</li>
  <li>Liens de profil :
  <ul>
    <li>Si le visiteur n'est pas connecté, un dropdown "S'inscrire / Se connecter" avec deux liens : 
    <ul>
      <li>"S'inscrire", qui correspond à l'inscription d'un utilisateur (<code>registrations#new</code>).</li>
      <li>"Se connecter", qui correspond à une connexion d'utilisateur (<code>sessions#new</code>).</li>
    </ul></li>
    <li>Si l'utilisateur est connecté, un dropdown "Mon profil" avec deux liens :
    <ul>
      <li>"Mon profil", qui est la page qui affiche le profil de l'utilisateur (<code>users#show</code>).</li>
      <li>"Se déconnecter", qui correspond à un logout (<code>sessions#destroy</code>).</li>
    </ul></li>
  </ul></li>
</ul>

<p>Fais donc cette navbar. Comme les routes de ces liens ne sont pas encore définies, mets <code>#</code> aux urls des liens. On les implémentera au fur et à mesure.</p>

<h3>2.2. Branchement de Devise</h3>
<p>Passons aux choses sérieuses. Nous allons passer par Devise pour 
toute l'authentification de ton application. Installe Devise et 
branche-la au model <code>User</code> comme vu dans le cours : </p>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">⚠️ ALERTE ERREUR COMMUNE</h4>
      <p>En temps normal, on créé le model user en même temps que le 
branchement Devise. Cependant, si l'on tavait demandé hier de faire la 
base de données ET brancher les emails ET brancher Devise, ton pauvre 
cerveau aurait déclaré forfait 😵</p>

<p>On va donc t'aider pour cette migration un peu rocambolesque. Ne t'en
 fais pas, ça va bien se passer et rien ne te pêtera à la gueule. Grosso
 modo, on va juste changer le fichier de migration.</p>

      <p>Installe Devise comme prévu, puis génère le devise user via <code>$ rails g devise user</code>.
 Cela va créer un fichier de migration, qui n'est pas bon. En effet, 
comme Devise est ajouté sur un model déjà existant, la gem ne sait pas 
trop comment gérer cette migration donc il y aura quelques éléments à 
changer. Ce sera l'occasion de réviser en douceur les migrations avec ce
 petit pas à pas. Super non ?</p>

      <p>Encore une fois, en général on créé le model via son ajout avec
 Devise ; mais comme il y avait beaucoup d'informations à gérer hier, on
 a pensé à ta santé mentale et à ton cerveau.</p>

      <p>Déjà, Devise avait compris que ton model <code>User</code> existe déjà : le fichier de migration ne fait plus <code>create_table</code>, mais <code>change_table</code>
 (si l'on compare avec celui donné dans la ressource). Malin. L'autre 
changement majeur par rapport à la ressource est qu'il ne fait plus <code>def change</code>, mais <code>def self.up</code> et <code>def self.down</code>. En gros Devise te laisse plus de choix dans ce que tu veux faire. Sympa, mais on s'en bat un peu les couilles pour le moment.</p>

<p>Maintenant, si tu regardes le <code>self.down</code>, tu devrais voir les lignes suivantes :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>down
  <span class="token comment"># By default, we don't want to make any assumption about how to roll back a migration when your
</span>  <span class="token comment"># model already existed. Please edit below which fields you would like to remove in this migration.
</span>  <span class="token keyword">raise</span> <span class="token const">ActiveRecord</span><span class="token punctuation">:</span><span class="token symbol">:IrreversibleMigration</span>
<span class="token keyword">end</span></code></pre>
  

<p>En gros, Devise te dit "on ne sait pas trop comment tu as géré ton 
model user jusqu'à présent, donc la seule ligne que l'on va mettre est <code>raise ActiveRecord::IrreversibleMigration</code>". Cette ligne va balancer une erreur et tu devras changer à la main le <code>self.down</code>
 pour faire marcher le rollback. Pour résumer, tu peux faire des 
migrations vers up, mais vers down il va te balancer une erreur. On va 
rectifier cela.</p>

<p>Enfin, avec un peu d'attention, tu peux remarquer que le fichier de 
migration va créer une colonne pour les emails et une colonne pour les 
encrypted_password. Comme tu l'as déjà fait hier, pas besoin de les 
ajouter. D'ailleurs si tu fais ta migration, cela plantera en te disant 
que les colonnes emails et encrypted_password existent déjà.</p>

<p>Pour résumer, voici ce qu'il faut faire pour faire marcher ton fichier de migration :</p>
<ul>
  <li>remplace <code>def self.up</code> par <code>def change</code></li>
  <li>vire toutes les lignes qui concernent <code>def self.down</code> (le <code>def.self.down</code> ainsi que le <code>end</code>, ainsi que ce qui est à l'intérieur)</li>
  <li>vire les lignes qui ajoutent une colonne <code>email</code> et une colonne <code>encrypted_password</code></li>
</ul>

<p>Voilou ! Tu pourras faire des migrations, des rollbacks, utiliser 
Devise comme un chef, faire la samba, et siroter un thé pendant que tes 
cookies seront cuisinés par cette gem qui fait le café (cette blague est
 drôle parce que en fait j'ai utilisé thé et café dans la même phrase. 
trolol).</p>    </div>
  </div>
</div>


<p>Une fois que Devise est branchée, je veux que tu génères les views de Devise :</p>

<ul>
  <li><code>app/views/devise/registrations/new.html.erb</code> : inscription au site : accessible depuis la navbar</li>
  <li><code>app/views/devise/sessions/new.html.erb</code> : connexion au site : accessible depuis la navbar</li>
  <li><code>app/views/devise/passwords/new.html.erb</code> : l'écran 
"mot de passe oublié ?" où tu rentres ton adresse email pour recevoir un
 email de réinitialisation de mot de passe : accessible grâce à la 
partial <code>shared_links</code></li>
  <li><code>app/views/devise/registrations/edit.html.erb</code> : l"écran pour modifier son email et son mot de passe : accessible depuis la page profil.</li>
  <li><code>app/views/devise/passwords/edit.html.erb</code> : la vue où 
tu rentres ton nouveau mot de passe (tu y accèdes en cliquant dans le 
lien "réinitialiser le mot de passe" dans ton email de réinitialisation 
de mot de passe) : accessible depuis l'email de demande de changement de
 mot de passe.</li>
</ul>

<p>Nous te laissons ajouter les liens d'inscription et de connexion à la
 navbar, puis de faire en sorte que toutes les views affichent bien la 
navbar.</p>


<p>Enfin, pour que Devise fonctionne correctement, il te faut faire le 
branchement du mailer. Rien de plus frustrant de faire une demande de 
réinitialisation de mot de passe et de ne jamais recevoir son mot de 
passe. Fais donc les modifications nécessaires pour que Devise envoie 
bien les emails de récupération.</p>

<p>Une fois que tu as fait cela, pousse le tout sur Heroku et assure toi que ça marche aussi bien que sur ton ordi !</p>

<p>Et là, tu réalises que tu viens de réaliser un système complet 
d'authentification d'utilisateurs, fonctionnel et en production. C'est 
une excellente étape vers un site fonctionnel et tu peux être fier de 
toi.</p>


<h3>2.3. Faire les premières views</h3>
<p>Avant de passer à cette partie, assure toi que l'ensemble des 
fonctionnalités demandées ci-dessus fonctionne au poil : c'est le 
minimum pour valider le projet.</p>
<p>Dans cette partie, nous allons construire les premières views pour 
que l'application commence à marcher. C'est un processus long donc tu 
n'arriveras probablement pas à tout faire :</p>

<ol>
  <li>La page d'accueil du site (<code>events#index</code>)</li>
  <li>La page profil d'un utilisateur (<code>users#show</code>) =&gt; Essaye de finir cette view</li>
  <li>La page de création d'un événement (<code>events#new</code>) =&gt; Super si tu arrives jusqu'ici</li>
  <li>La page d'affichage d'un événement (<code>events#show</code>) =&gt; Pour les plus déterminés</li>
</ol>

<p>Tu peux commencer à générer les controllers, leurs méthodes, et 
écrire les routes pour ces premières views. Bien entendu, il est 
interdit d'utiliser les routes en <code>GET</code>/<code>POST</code> et tu devras utiliser <code>resources</code>.</p>

<h4>2.3.1. La page d'accueil</h4>
<p>La page d'accueil du site affiche tous les événements de 
l'application. Pour chaque événement, tu pourras cliquer sur un lien qui
 t'emmènera vers la page <code>show</code> de l'événement. La page d'accueil invitera l'utilisateur à créer son événement.</p>

<p>Pour le front, on est comme d'habitude fans <a href="https://getbootstrap.com/docs/4.0/examples/" target="_blank">des exemples</a> de Bootstrap. La page <a href="https://getbootstrap.com/docs/4.0/examples/jumbotron/" target="_blank">jumbotron</a> par exemple a l'air de bien correspondre à ce que l'on veut en page d'accueil.</p>

<p>Bien sûr assure toi que ton seed génère quelques <code>Event</code> afin de donner un peu de contenu à cette page d'accueil.</p>

<h4>2.3.2. La page profil d'un utilisateur</h4>
<p>La page profil d'un utilisateur devra afficher les informations de 
l'utilisateur : prénom, nom, description, e-mail (la plupart de ces 
informations ne sont pas encore renseignées par l'utilisateur, mais le 
but de cette page est de vous faire faire ce qui va suivre).</p>

<p>La page de profil d'un utilisateur va afficher les événements qu'il a créés (un <code>title</code> et un lien pour chaque <code>Event</code> dont il est administrateur).</p>


<p>Ensuite, la page de profil d'un utilisateur ne doit pas être accessible par ces deux types de personnes :</p>

<ul>
  <li>Les visiteurs non connectés (<code>authenticate_user!</code>)</li>
  <li>Les utilisateurs connectés, mais qui ne sont pas sur la page de 
leur profil (user 23 n'a pas le droit d'aller sur la page profil de user
 36). Pour ceci, il te faudra coder une méthode spécifique et t'assure 
qu'elle est appelée avant (ou au début) de la méthode <code>users#show</code></li>
</ul>

<p>En gros, la page profil ne doit être accessible que par la personne 
concernée. La page de profil doit aussi insérer un lien pour l'édition 
de l'email et du mot de passe informations importantes (<code>registrations#edit</code>). Les autres informations (la description, le prénom, le nom) ne seront pas éditables.</p>


<p><b>BONUS pour ceux qui sont en GODMODE</b> : vous pouvez ajouter un lien pour éditer les informations de profil (<code>users#edit</code>) : la description, le prénom, le nom.</p>

<h4>2.3.3. Création d'un événement</h4>
<p>À partir de la navbar (et de la page d'accueil), il est possible de créer un événement. La création d'événement demandera :</p>

<ul>
  <li>Sa <code>start_date</code></li>
  <li>Sa <code>duration</code></li>
  <li>Son <code>title</code></li>
  <li>Sa <code>description</code></li>
  <li>Son <code>price</code></li>
  <li>Sa <code>location</code> (un input normal suffira)</li>
</ul>

<p>Nous t'invitons à regarder <a href="https://getbootstrap.com/docs/4.0/components/forms/" target="_blank">la page des formulaires de Bootstrap</a> pour t'inspirer sur les visuels que tu peux utiliser.</p>

<p>Quand un événement est créé, le <code>current_user</code> doit y être
 associé en tant qu'administrateur. Cela veut dire que Devise devra 
authentifier l'utilisateur avant de pouvoir faire <code>new</code> ou <code>create</code>. Une fois l'événement créé, l'utilisateur sera redirigé vers la page <code>show</code> de l'événement.</p>

<h4>2.3.4. Afficher un événement</h4>
<p>C'est long de tout implémenter non ? Si tu es arrivé jusqu'ici, BRAVO
 ! Maintenant tu vas afficher un événement. Cette page devra montrer :</p>

<ul>
  <li>Le titre de l'événement</li>
  <li>Sa description complète</li>
  <li>Le nombre d'inscrits à l'événement</li>
  <li>Le créateur (son email suffira)</li>
  <li>Sa date de début, et sa date de fin (la date de fin est une méthode d'instance)</li>
  <li>Le lieu de l'événement</li>
  <li>Son prix</li>
</ul>

<p>Demain nous verrons la page pour s'inscrire à l'événement en tant que participant.</p>


<h2>3. Rendu attendu</h2>
<p>Un repo GitHub accueillant l'app Rails avec un maximum des 
fonctionnalités ci-dessus. Le tout doit être disponible sur Heroku (lien
 dans le README).</p>
<p>Avec ceci, tu as une belle application où les gens peuvent voir la 
liste des événements disponibles dans leur ville. C'est un excellent 
début et tu peux être fier de toi.</p>
<p> Demain nous allons ajouter les fonctionnalités pour rejoindre un 
événement et ton application sera prête et fonctionnelle pour être 
montrée à la Terre entière. À partir de jeudi on implémentera des 
fonctionnalités pas indispensables, mais qui vont agrémenter 
l'expérience utilisateur (gestion des images, interface administrateur).</p>
</div>
</div>
</div>
</div>
</div>
</div>

</div>

      </div>
    </div>
<script type="text/javascript" id="hs-script-loader" src="s7j2_fichiers/9310539.js"></script><script type="text/javascript" id="">(function(e,c){if(!c.__SV){var l,h;window.mixpanel=c;c._i=[];c.init=function(q,r,f){function t(d,a){var g=a.split(".");2==g.length&&(d=d[g[0]],a=g[1]);d[a]=function(){d.push([a].concat(Array.prototype.slice.call(arguments,0)))}}var b=c;"undefined"!==typeof f?b=c[f]=[]:f="mixpanel";b.people=b.people||[];b.toString=function(d){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);d||(a+=" (stub)");return a};b.people.toString=function(){return b.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<l.length;h++)t(b,l[h]);var n="set set_once union unset remove delete".split(" ");b.get_group=function(){function d(p){a[p]=function(){call2_args=arguments;call2=[p].concat(Array.prototype.slice.call(call2_args,0));b.push([g,call2])}}for(var a={},g=["get_group"].concat(Array.prototype.slice.call(arguments,0)),m=0;m<n.length;m++)d(n[m]);return a};c._i.push([q,r,f])};c.__SV=1.2;var k=e.createElement("script");k.type="text/javascript";k.async=!0;k.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=e.getElementsByTagName("script")[0];e.parentNode.insertBefore(k,e)}})(document,window.mixpanel||[]);mixpanel.init("ab79c62023f2a925bfe5f7922c70de67");mixpanel.track("Sign up");</script>
<script type="text/javascript" id="">!function(){var a=window.analytics=window.analytics||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0;a.methods="trackSubmit trackClick trackLink trackForm pageview identify reset group track ready alias debug page once off on addSourceMiddleware addIntegrationMiddleware setAnonymousId addDestinationMiddleware".split(" ");a.factory=function(b){return function(){var c=Array.prototype.slice.call(arguments);c.unshift(b);
a.push(c);return a}};for(var e=0;e<a.methods.length;e++){var f=a.methods[e];a[f]=a.factory(f)}a.load=function(b,c){var d=document.createElement("script");d.type="text/javascript";d.async=!0;d.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(d,b);a._loadOptions=c};a._writeKey="HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j";a.SNIPPET_VERSION="4.13.2";a.load("HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j");a.page()}}();</script>


    <div class="thp-flashes"></div>



    <script src="s7j2_fichiers/dashboard-6681459c92372465340c.js"></script>

    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  

<iframe style="display: none; visibility: hidden;" owner="archetype" title="archetype"></iframe></body></html>