<!DOCTYPE html>
<html class="loaded" lang="fr"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="s5j1_fichiers/NRJS-71f55aa980e498e276b"></script><script type="text/javascript" async="" src="s5j1_fichiers/insight.js"></script><script src="s5j1_fichiers/nr-1212.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/gtm_002.js"></script><script type="text/javascript" src="s5j1_fichiers/commons.js" async="" status="loaded"></script><script type="text/javascript" src="s5j1_fichiers/google-tag-manager.js" async="" status="loaded"></script><script type="text/javascript" async="" src="s5j1_fichiers/analytics.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/mixpanel-2-latest.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/conversion_async.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/analytics_002.js"></script><script src="s5j1_fichiers/conversations-embed.js" type="text/javascript" id="hubspot-messages-loader" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/9310539_003.js" type="text/javascript" id="hs-analytics"></script><script src="s5j1_fichiers/9310539_002.js" type="text/javascript" id="cookieBanner-9310539" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/fb.js" type="text/javascript" id="hs-ads-pixel-9310539" data-ads-portal-id="9310539" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/collectedforms.js" type="text/javascript" id="CollectedForms-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/leadflows.js" type="text/javascript" id="LeadFlows-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script async="" crossorigin="anonymous" src="s5j1_fichiers/fs.js"></script><script src="s5j1_fichiers/773401719499556.js" async=""></script><script async="" src="s5j1_fichiers/fbevents.js"></script><script async="" src="s5j1_fichiers/gtm.js"></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"NRJS-71f55aa980e498e276b","applicationID":"576835834","transactionName":"dgpYEBRYDg9XQh8AA0YNVAsHRQZMVlFJF01GDVkT","queueTime":0,"applicationTime":149,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-71f55aa980e498e276b",applicationID:"576835834"};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var i=e[n]={exports:{}};t[n][0].call(i.exports,function(e){var i=t[n][1][e];return r(i||e)},i,i.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,n){function r(){}function i(t,e,n,r){return function(){return s.recordSupportability("API/"+e+"/called"),o(t+e,[u.now()].concat(c(arguments)),n?null:this,r),n?void 0:this}}var o=t("handle"),a=t(10),c=t(11),f=t("ee").get("tracer"),u=t("loader"),s=t(4),d=NREUM;"undefined"==typeof window.newrelic&&(newrelic=d);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",v=l+"ixn-";a(p,function(t,e){d[e]=i(l,e,!0,"api")}),d.addPageAction=i(l,"addPageAction",!0),d.setCurrentRouteName=i(l,"routeName",!0),e.exports=newrelic,d.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(t,e){var n={},r=this,i="function"==typeof e;return o(v+"tracer",[u.now(),t,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return e.apply(this,arguments)}catch(t){throw f.emit("fn-err",[arguments,this,t],n),t}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){m[e]=i(v,e)}),newrelic.noticeError=function(t,e){"string"==typeof t&&(t=new Error(t)),s.recordSupportability("API/noticeError/called"),o("err",[t,u.now(),!1,e])}},{}],2:[function(t,e,n){function r(t){if(NREUM.init){for(var e=NREUM.init,n=t.split("."),r=0;r<n.length-1;r++)if(e=e[n[r]],"object"!=typeof e)return;return e=e[n[n.length-1]]}}e.exports={getConfiguration:r}},{}],3:[function(t,e,n){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}catch(o){}e.exports=function(t){return r?{passive:!0,capture:!!t}:!!t}},{}],4:[function(t,e,n){function r(t,e){var n=[a,t,{name:t},e];return o("storeMetric",n,null,"api"),n}function i(t,e){var n=[c,t,{name:t},e];return o("storeEventMetrics",n,null,"api"),n}var o=t("handle"),a="sm",c="cm";e.exports={constants:{SUPPORTABILITY_METRIC:a,CUSTOM_METRIC:c},recordSupportability:r,recordCustom:i}},{}],5:[function(t,e,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=t(12);e.exports=r,e.exports.offset=a,e.exports.getLastTimestamp=i},{}],6:[function(t,e,n){function r(t){return!(!t||!t.protocol||"file:"===t.protocol)}e.exports=r},{}],7:[function(t,e,n){function r(t,e){var n=t.getEntries();n.forEach(function(t){"first-paint"===t.name?p("timing",["fp",Math.floor(t.startTime)]):"first-contentful-paint"===t.name&&p("timing",["fcp",Math.floor(t.startTime)])})}function i(t,e){var n=t.getEntries();if(n.length>0){var r=n[n.length-1];if(f&&f<r.startTime)return;p("lcp",[r])}}function o(t){t.getEntries().forEach(function(t){t.hadRecentInput||p("cls",[t])})}function a(t){if(t instanceof g&&!y){var e=Math.round(t.timeStamp),n={type:t.type};e<=l.now()?n.fid=l.now()-e:e>l.offset&&e<=Date.now()?(e-=l.offset,n.fid=l.now()-e):e=l.now(),y=!0,p("timing",["fi",e,n])}}function c(t){"hidden"===t&&(f=l.now(),p("pageHide",[f]))}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d,p=t("handle"),l=t("loader"),v=t(9),m=t(3),g=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){u=new PerformanceObserver(r);try{u.observe({entryTypes:["paint"]})}catch(h){}s=new PerformanceObserver(i);try{s.observe({entryTypes:["largest-contentful-paint"]})}catch(h){}d=new PerformanceObserver(o);try{d.observe({type:"layout-shift",buffered:!0})}catch(h){}}if("addEventListener"in document){var y=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(t){document.addEventListener(t,a,m(!1))})}v(c)}},{}],8:[function(t,e,n){function r(t,e){if(!i)return!1;if(t!==i)return!1;if(!e)return!0;if(!o)return!1;for(var n=o.split("."),r=e.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}e.exports={agent:i,version:o,match:r}},{}],9:[function(t,e,n){function r(t){function e(){t(c&&document[c]?document[c]:document[o]?"hidden":"visible")}"addEventListener"in document&&a&&document.addEventListener(a,e,i(!1))}var i=t(3);e.exports=r;var o,a,c;"undefined"!=typeof document.hidden?(o="hidden",a="visibilitychange",c="visibilityState"):"undefined"!=typeof document.msHidden?(o="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(o="webkitHidden",a="webkitvisibilitychange",c="webkitVisibilityState")},{}],10:[function(t,e,n){function r(t,e){var n=[],r="",o=0;for(r in t)i.call(t,r)&&(n[o]=e(r,t[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],11:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(i<0?0:i);++r<i;)o[r]=t[e+r];return o}e.exports=r},{}],12:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(t,e,n){function r(){}function i(t){function e(t){return t&&t instanceof r?t:t?u(t,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){t&&a&&t(n,r,i);for(var c=e(i),f=m(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[w[n]];return p&&p.push([b,n,r,c]),c}}function o(t,e){y[t]=m(t).concat(e)}function v(t,e){var n=y[t];if(n)for(var r=0;r<n.length;r++)n[r]===e&&n.splice(r,1)}function m(t){return y[t]||[]}function g(t){return p[t]=p[t]||i(n)}function h(t,e){l.aborted||s(t,function(t,n){e=e||"feature",w[n]=e,e in d||(d[e]=[])})}var y={},w={},b={on:o,addEventListener:o,removeEventListener:v,emit:n,get:g,listeners:m,context:e,buffer:h,abort:c,aborted:!1};return b}function o(t){return u(t,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=t("gos"),s=t(10),d={},p={},l=e.exports=i();e.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(t,e,n){function r(t,e,n){if(i.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return t[e]=r,r}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){i.buffer([t],r),i.emit(t,e,n)}var i=t("ee").get("handle");e.exports=r,r.ee=i},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,o,function(){return i++})}var i=1,o="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!T++){var t=P.info=NREUM.info,e=g.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(O,function(e,n){t[e]||(t[e]=n)});var n=a();c("mark",["onload",n+P.offset],null,"api"),c("timing",["load",n]);var r=g.createElement("script");0===t.agent.indexOf("http://")||0===t.agent.indexOf("https://")?r.src=t.agent:r.src=v+"://"+t.agent,e.parentNode.insertBefore(r,e)}}function i(){"complete"===g.readyState&&o()}function o(){c("mark",["domContent",a()+P.offset],null,"api")}var a=t(5),c=t("handle"),f=t(10),u=t("ee"),s=t(8),d=t(6),p=t(2),l=t(3),v=p.getConfiguration("ssl")===!1?"http":"https",m=window,g=m.document,h="addEventListener",y="attachEvent",w=m.XMLHttpRequest,b=w&&w.prototype,E=!d(m.location);NREUM.o={ST:setTimeout,SI:m.setImmediate,CT:clearTimeout,XHR:w,REQ:m.Request,EV:m.Event,PR:m.Promise,MO:m.MutationObserver};var x=""+location,O={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1212.min.js"},M=w&&b&&b[h]&&!/CriOS/.test(navigator.userAgent),P=e.exports={offset:a.getLastTimestamp(),now:a,origin:x,features:{},xhrWrappable:M,userAgent:s,disabled:E};if(!E){t(1),t(7),g[h]?(g[h]("DOMContentLoaded",o,l(!1)),m[h]("load",r,l(!1))):(g[y]("onreadystatechange",i),m[y]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var T=0}},{}],"wrap-function":[function(t,e,n){function r(t,e){function n(e,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],t)}c(n+"start",[o,a,f],s,u);try{return p=e.apply(a,o)}catch(v){throw c(n+"err",[o,a,v],s,u),v}finally{c(n+"end",[o,a,p],s,u)}}return a(e)?e:(n||(n=""),nrWrapper[p]=e,o(e,nrWrapper,t),nrWrapper)}function r(t,e,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<e.length;u++)f=e[u],c=t[f],a(c)||(t[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!v||e){var c=v;v=!0;try{t.emit(n,r,o,e,a)}catch(f){i([f,n,r,o],t)}v=c}}return t||(t=s),n.inPlace=r,n.flag=p,n}function i(t,e){e||(e=s);try{e.emit("internal-error",t)}catch(n){}}function o(t,e,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(t);return r.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(o){i([o],n)}for(var a in t)l.call(t,a)&&(e[a]=t[a]);return e}function a(t){return!(t&&t instanceof Function&&t.apply&&!t[p])}function c(t,e){var n=e(t);return n[p]=t,o(t,n,s),n}function f(t,e,n){var r=t[e];t[e]=c(r,n)}function u(){for(var t=arguments.length,e=new Array(t),n=0;n<t;++n)e[n]=arguments[n];return e}var s=t("ee"),d=t(11),p="nr@original",l=Object.prototype.hasOwnProperty,v=!1;e.exports=r,e.exports.wrapFunction=c,e.exports.wrapInPlace=f,e.exports.argsToArray=u},{}]},{},["loader"]);</script>
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="+eE6ma6MY3DZx7OxAks5TQ2DVJspzDqy/65JVWjJ/NmKcRS9AWw0QRGWxWDCWoDRqd2nrQdt3/XmCQ5hIZ9YRQ==">
    <title>Le tableau de bord | The Hacking Project</title>
<meta name="description" content="Nous cassons les codes de l'éducation, vous apprenez d'où vous voulez, en communauté.">
<meta name="robots" content="noindex, nofollow">
<meta property="og:title" content="Le tableau de bord">
<meta property="og:site_name" content="The Hacking Project">
<meta name="url" content="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/1">
<meta name="image" content="https://www.thehackingproject.org/packs/images/logo/20210910-THP-Logo_color_transparent-31229dd881904e010092de63be97cdfa.png">


    <link rel="apple-touch-icon" sizes="180x180" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-c01aaccf467f7cc3d79bbce743d60779f5b833fdc4500cebd07a5e11a07a5c31.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-precomposed-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.thehackingproject.org/assets/favicon/favicon-32x32-804b12d1c41c60fe721477b7c3b0a32811dc610580dd40ac92f1cc04cbd05ca4.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.thehackingproject.org/assets/favicon/favicon-16x16-d96ba65e5785d32474df9ebc6fbfd5442c751d527b10981a474bc3b7a4079d01.png">
<link rel="manifest" href="https://www.thehackingproject.org/assets/favicon/manifest-cf975201fd8ac78a1f1a203357573d50031f1cc33436d099743df6428b8a38a2.json">
<link rel="mask-icon" href="https://www.thehackingproject.org/assets/favicon/safari-pinned-tab-8af1cfcf7525ccdccb490f9f5adad396653a4969b419e0a9a9d3a1088140a912.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://www.thehackingproject.org/assets/favicon/favicon-cbf10361dc90b277565960736d4897fddef5468bff6299811ea9498459d56d21.ico">
<meta name="msapplication-config" content="/assets/favicon/browserconfig-dab38db6040ef54ac56e91fdd77e3d7b06746a634e87b68c99b59b216cb8611a.xml">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" media="screen" href="s5j1_fichiers/vendor-dab9e12f0ba58215899de05f149caa5f.css">
    <link rel="stylesheet" media="screen" href="s5j1_fichiers/dashboard-4ab6ba9737cbfc4c38b17a9a4de7833a.css">
    <link rel="stylesheet" media="screen" href="s5j1_fichiers/dashboard-ea5a94b9045ccb8d8ce8974b71b640603915dc183d5907c643.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="s5j1_fichiers/js.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-105991867-1');
  </script>
<!-- End Google Analytics -->

<!-- Google Tag Manager -->
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-P8XRQ3M");
</script>
<!-- End Google Tag Manager -->

<!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
         fbq('init', '773401719499556');
        fbq('track', 'PageView');
    </script>
    <noscript>
     <img height="1" width="1"
    src="https://www.facebook.com/tr?id=773401719499556&ev=PageView
    &noscript=1"/>
    </noscript>
<!-- End Facebook Pixel Code -->

<script>
window['_fs_debug'] = false;
window['_fs_host'] = 'fullstory.com';
window['_fs_script'] = 'edge.fullstory.com/s/fs.js';
window['_fs_org'] = '14AEET';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
    g=m[e]=function(a,b,s){g.q?g.q.push([a,b,s]):g._api(a,b,s);};g.q=[];
    o=n.createElement(t);o.async=1;o.crossOrigin='anonymous';o.src='https://'+_fs_script;
    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
    g.identify=function(i,v,s){g(l,{uid:i},s);if(v)g(l,v,s)};g.setUserVars=function(v,s){g(l,v,s)};g.event=function(i,v,s){g('event',{n:i,p:v},s)};
    g.anonymize=function(){g.identify(!!0)};
    g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
    g.log = function(a,b){g("log",[a,b])};
    g.consent=function(a){g("consent",!arguments.length||a)};
    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
    g.clearUserCookie=function(){};
    g.setVars=function(n, p){g('setVars',[n,p]);};
    g._w={};y='XMLHttpRequest';g._w[y]=m[y];y='fetch';g._w[y]=m[y];
    if(m[y])m[y]=function(){return g._w[y].apply(this,arguments)};
    g._v="1.3.0";
})(window,document,window['_fs_namespace'],'script','user');
</script>
<!-- Start of HubSpot Embed Code -->
<script async="" defer="defer" id="hs-script-loader" src="s5j1_fichiers/9310539.js" type="text/javascript"></script>
<!-- End of HubSpot Embed Code -->


    <script src="s5j1_fichiers/thp-3cc5aa6fdf57842a7b6c714621cc7f2d3d31b51cb700b1de4e795d773.js"></script>
    <script src="s5j1_fichiers/manifest-1613feea780cfc5342f4.js"></script>
    <script src="s5j1_fichiers/vendor-ff3cb5540e737de52c97.js"></script>
    <script src="s5j1_fichiers/dashboard-25875e14460b4458b1bccffaa93d4a8cbee9691b06d54976fde.js"></script>

    <link href="s5j1_fichiers/css.css" rel="stylesheet">
  <script src="s5j1_fichiers/a"></script></head>

  <body class="vertical-layout 2-columns fixed-navbar menu-hide vertical-overlay-menu" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns" data-thp-controller="days" data-thp-action="show" data-thp-layout="dashboard"><style type="text/css">html.hs-messages-widget-open.hs-messages-mobile,html.hs-messages-widget-open.hs-messages-mobile body{overflow:hidden!important;position:relative!important}html.hs-messages-widget-open.hs-messages-mobile body{height:100%!important;margin:0!important}#hubspot-messages-iframe-container{display:initial!important;z-index:2147483647;position:fixed!important;bottom:0!important}#hubspot-messages-iframe-container.widget-align-left{left:0!important}#hubspot-messages-iframe-container.widget-align-right{right:0!important}#hubspot-messages-iframe-container.internal{z-index:1016}#hubspot-messages-iframe-container.internal iframe{min-width:108px}#hubspot-messages-iframe-container .shadow-container{display:initial!important;z-index:-1;position:absolute;width:0;height:0;bottom:0;content:""}#hubspot-messages-iframe-container .shadow-container.internal{display:none!important}#hubspot-messages-iframe-container .shadow-container.active{width:400px;height:400px}#hubspot-messages-iframe-container iframe{display:initial!important;width:100%!important;height:100%!important;border:none!important;position:absolute!important;bottom:0!important;right:0!important;background:transparent!important}</style>
    <!-- Google Tag Manager (noscript) -->
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-P8XRQ3M' style='display:none;visibility:hidden' width='0'></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->



    <nav class="header-navbar navbar-expand-md navbar navbar-with-menu navbar-without-dd-arrow fixed-top navbar-semi-light" style="padding:0;">
<div class="navbar-wrapper">
<div class="navbar-container content">
<div class="collapse navbar-collapse show" id="navbar-mobile">
<ul class="nav navbar-nav mr-auto float-left">
<li class="nav-item mobile-menu d-md-none mr-auto">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu font-large-1"></i>
</a>
</li>
<li class="nav-item d-none d-md-block">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu"></i>
</a>
</li>
</ul>
<ul class="nav navbar-nav float-right">
<li class="dropdown dropdown-user nav-item">
<a class="dropdown-toggle nav-link dropdown-user-link" data-toggle="dropdown" href="#">
<span class="avatar avatar-online">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s5j1_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
</a>
<div class="dropdown-menu dropdown-menu-right">
<div class="arrow_box_right">
<a class="dropdown-toggle nav-link dropdown-user-link" href="https://www.thehackingproject.org/fr/dashboard/profile/user"><span class="avatar avatar-online pt-0">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s5j1_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
<span class="user-name text-bold-700 ml-1 text-dark">
Lucie
</span>
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit"><i class="ft-edit"></i>Éditer profil
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit?edit=danger"><i class="ft-alert-triangle"></i>Zone à risques
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" rel="nofollow" data-method="delete" href="https://www.thehackingproject.org/users/sign_out?locale=fr"><i class="ft-power"></i>
Déconnexion
</a></div>
</div>
</li>
</ul>
</div>
</div>
</div>
</nav>

      <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true">
<div class="navbar-header">
<ul class="nav navbar-nav flex-row">
<li class="nav-item mr-auto">
<a class="navbar-brand" href="https://www.thehackingproject.org/?locale=fr"><h3 class="brand-text">The Hacking Project</h3>
</a></li>
<li class="nav-item d-md-none">
<a class="nav-link close-navbar">
<i class="ft-x"></i>
</a>
</li>
</ul>
</div>
<div class="main-menu-content">
<ul class="navigation navigation-main" data-menu="menu-navigation" id="main-menu-navigation">
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard"><i class="ft-calendar"></i>
<span class="menu-title" data-i18n="">
Aujourd'hui
</span>
</a></li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard"><i class="ft-monitor"></i>
<span class="menu-title" data-i18n="">
Mon dashboard
</span>
</a></li>
<li class="nav-item has-sub">
<a href="#"><i class="fas fa-user-graduate"></i>
<span class="menu-title" data-i18n="">
Mon inscription
</span>
</a><ul class="menu-content">
<li>
<a href="https://www.thehackingproject.org/parcours?locale=fr">Choisir un parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/new">Nouveau parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/7209/edit">Changer parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/modalites">Modalités</a>
</li>
</ul>
</li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/certifications"><i class="fa ft-download"></i>
<span class="menu-title" data-i18n="">
Documents
</span>
</a></li>
<br>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/help"><i class="fa ft-help-circle"></i>
<span class="menu-title" data-i18n="">
Aide
</span>
</a></li>
</ul>
</div>
</div>



    <div class="app-content content">
      <div class="content-wrapper">
        <div class="content-wrapper-before"></div>
        <div class="content-header row"></div>
        <div class="container">
<div class="row">
<div class="col-12">
<ol class="breadcrumb">
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard">Dashboard</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1">Fullstack web</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2">Initiation à Rails</a>
</li>
<li class="breadcrumb-item active">
Franck Sinatra
</li>
</ol>
</div>
</div>
<!-- / PARTIAL FOR FREE MOUSSES -->
<!-- / PARTIAL FOR NEXT -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-body">
<div class="row">
<div class="col-12 col-xl-12 text-center mb-3">
<h2 class="mb-2">
Initiation à Rails
</h2>
<h3>
<i class="ft-check-square success" data-placement="top" data-toggle="tooltip" title="" data-original-title="Projet bien reçu !"></i>
Franck Sinatra
</h3>
<h4>
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet à rendre ce jour-là"></i>

</h4>
<h5>
Nous allons voir un framework minimaliste de Ruby pour faire du web : 
Sinatra. Sinatra est bien plus bas-niveau que Rails, et voir ce 
framework en premier te donnera les bases pour comprendre le web.
Dans l'après midi, les ateliers t'apprendront à faire des trucs bien 
coolos.
</h5>
</div>
<div class="col-12 col-xl-12 timeline-left" id="activity">
<div class="timeline pt-2">
<ul class="list-unstyled base-timeline activity-timeline">
<li>
<div class="timeline-icon bg-primary">
<i class="ft-map-pin font-medium-1"></i>
</div>
<div class="act-time">
Lundi
</div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet à rendre ce jour-là"></i>

Franck Sinatra
</div>
</div>
<small class="text-muted">
Nous allons voir un framework minimaliste de Ruby pour faire du web : 
Sinatra. Sinatra est bien plus bas-niveau que Rails, et voir ce 
framework en premier te donnera les bases pour comprendre le web.
Dans l'après midi, les ateliers t'apprendront à faire des trucs bien 
coolos.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/2"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/2">Mardi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journée là"></i>

Découverte de SQL
</div>
</div>
<small class="text-muted">
Pour ce premier jour, tu verras l'univers des bases de données, comment 
créer ta première base de données, comment la concevoir, puis comment 
intéragir avec une base de données.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/3"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/3">Mercredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">

Passage de SQL à ActiveRecord
</div>
</div>
<small class="text-muted">
Nous allons voir comment utiliser ActiveRecord pour se simplifier la vie
 avec les bases de données. C’est également le pont entre le SQL et le 
Ruby
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/4"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/4">Jeudi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet à rendre ce jour-là"></i>

Relations entre BDD
</div>
</div>
<small class="text-muted">
Comment faire en sorte qu'un docteur puisse avoir plusieurs patients et 
que les patients puissent avoir plusieurs docteurs ? Grâce aux relations
 entre bases de données, bien entendu !
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/5"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/5">Vendredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journée là"></i>

Validations &amp; Conceptions de BDD
</div>
</div>
<small class="text-muted">
Et allez encore des bases de données 😎
</small>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Les fameuses corrections qui n'arrivent que les jours concernés -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #5E66E5">
<h1>
Ressource : 
Sinatra
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/lessons/23/lesson_submissions/new"><i class="ft-edit" data-original-title="Proposer une amélioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>Dans cette ressource, nous allons te montrer comment travailler avec 
Sinatra, un framework Ruby conçu pour coder des applications web. C'est 
un framework plus bas-niveau que Ruby on Rails (= une ligne de Rails = 3
 lignes en Sinatra) et c'est parfait au début pour comprendre les 
rouages d'une application web. Par contre on ne l'utilisera pas 
longtemps car Sinatra te fait réinventer la roue.</p>

<p>Sinatra se présente tout simplement sous la forme d'une gem (tout comme Rails).</p>

<p>Objectif de la journée : te présenter les grands concepts qui vont 
t'accompagner tout au long de ton apprentissage de Rails. Cela inclus 
l'utilisation d'un serveur local, l'archi MVC, les routes, les views, 
les BDD, l'utilisation de formulaires, etc.</p>

<p> Allez Sinatra, Fly me to the moon 🚀 !</p>


<h2>2. Historique et contexte</h2>
<p>Sinatra est une bibliothèque Ruby open source qui permet de faire des
 applications web. Elle a été créée en 2007 (donc deux ans après Rails) 
par un certain Blake Mizerany dans le but de créer des applications, en 
mode ultra minimal, sans effort. Sinatra ne suit pas le modèle MVC : il 
laisse les utilisateurs faire un choix d'architecture logicielle web.</p>

<p>Et sinon : "oui". Sinatra est nommée ainsi à cause de Frank Sinatra 🎤 ☔</p>

<h2>3. La ressource</h2>

<p>On va construire ensemble une application ultra basique qui te permettra de découvrir le fonctionnement de Sinatra.</p>

<p>Une grosse fonctionnalité de Sinatra est de <b>pouvoir lancer un serveur local (sur ton ordi) en Ruby</b>.
 Le rôle d'un serveur c'est, grosso modo, de recevoir des requêtes HTTP 
et de retourner en réponse des fichiers (HTML, CSS, JS, etc.). Par 
exemple si tu vas sur https://www.facebook.com/, le serveur de Facebook 
va faire "Hé j'ai reçu une requête de type GET sur ma page portant l'URL
 '/'. Je vais donc renvoyer le code HTML et CSS qui correspond !". Et là
 il va te balancer ce qu'il faut pour afficher la page d'accueil de 
Facebook.</p>

<p>Pour ton info, sache que sur le web, certaines requêtes peuvent 
donner lieu à l'envoi d'autres formats que des fichiers HTML ou CSS. Par
 exemple si tu vas sur <a href="http://www.omdbapi.com/?t=pulp+fiction&amp;apikey=5c030292" target="_blank">ce lien</a>, tu vas voir dans le code source que le site t'a renvoyé un JSON.</p>

<p>Bref, quand tu vas sur facebook.com, une page s'affiche sur ton 
navigateur web, car ce dernier sait interpréter les fichiers HTML/CSS 
obtenus. Si le site est statique (un blog de base par exemple), chaque 
visiteur reçoit les mêmes fichiers HTML/CSS (les mêmes articles du 
blog). Par contre si le site est dynamique, comme Facebook, la page 
affichée pour toi (qui est connecté à ton compte) sera différente de la 
mienne (si je suis connecté), ou de celle d'une personne non connectée. 
Par exemple on aura chacun une page profil différente et un newsfeed 
différent. C'est parce que les serveurs de Facebook génèrent leurs 
réponses HTML / CSS de manière dynamique et en fonction de l'utilisateur
 qui navigue sur le site. </p>
<p>Avec Sinatra, tu vas pouvoir faire de même et générer des sites web 
dynamiques où la réponse HTML / CSS dépendra du code que tu vas écrire !
 Allez, on se lance dans notre premier site web.</p>

<h3>3.1. Hello World !</h3>
<p>Tu vas lancer ton premier serveur et il aura pour rôle de faire une 
réponse statique : un message simple. Commence par créer un dossier <code>hello_world_sinatra</code> qui contiendra deux fichiers : un <code>Gemfile</code> et un fichier <code>app.rb</code>.</p>

<h4>Gemfile</h4>
<p>Le Gemfile va contenir notre version de Ruby habituelle, ainsi que <code>gem 'sinatra'</code>. Je te laisse faire le <code>bundle install</code>.</p>

<h4>app.rb</h4>
<p>Voici ce que va contenir le fichier <code>app.rb</code> : </p>
<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'sinatra'</span>

get <span class="token string">'/hello'</span> <span class="token keyword">do</span>
  <span class="token string">'&lt;h1&gt;Hello world ! &lt;/h1&gt;'</span>
<span class="token keyword">end</span></code></pre>

<h4>C'est prêt !</h4>
<p>On t'avait prévenu : Sinatra c'est tout basique. 🤓 </p>
<p>Pour tester ton programme, tu n'as qu'à exécuter ton programme <code>$ ruby app.rb</code>. Le terminal va balancer un message du style :</p>
<pre class=" language-bash"><code class=" language-bash">== Sinatra (v2.0.4) has taken the stage on 4567 for development with backup from Puma
Puma starting in single mode…
* Version 3.12.0 (ruby 2.5.1-p57), codename: Llamas in Pajamas
* Min threads: 0, max threads: 16
* Environment: development
* Listening on tcp://localhost:4567
Use Ctrl-C to stop</code></pre>

<p>Prends le temps de le lire 2 secondes. En gros, ce qu'il faut 
comprendre c'est qu'il te dit "j'ai lancé Puma (un serveur), c'est 
cool", il t'informe qu'il écoute d'éventuelles requêtes HTTP sur le port
 <code>localhost:4567</code>, et que tu peux arrêter le serveur en faisant <code>Ctrl-C</code> (ne fais pas ça pour le moment). <br>
On va aller voir ce que le serveur Puma nous répond si on va sur <a href="http://localhost:4567/hello" target="_blank">http://localhost:4567/hello</a>
 avec notre navigateur. Et là, SURPRISE, il t'affiche un gros "Hello 
world !" et si tu regardes le code source de la page, tu verras qu'il 
correspond exactement à <code>app.rb</code> et son code : <code>&lt;h1&gt;Hello world !  &lt;/h1&gt;</code>.</p>

<h3>3.2. Que s'est-il passé ?</h3>
<p>C'est la magie de Sinatra : dès que tu l'exécutes, il lance un 
serveur qui va réagir en fonction du code que tu as écrit. Ainsi le 
serveur va tourner en local (sur ton ordi), et s'il voit passer une 
requête sur le port où il est en écoute (localhost:4567 dans notre cas),
 il exécute le code correspondant à cette requête et produit un fichier 
HTML en fonction. Là, notre code lui dit "si quelqu'un va à l'adresse <code>/hello</code> en GET, renvoie-lui ce code HTML : <code>&lt;h1&gt;Hello world !  &lt;/h1&gt;</code>".</p>

<h5>3.2.1 C'est quoi un GET ?</h5>
<p>Il existe <b>plusieurs types de requêtes HTTP</b>, et nous allons en voir deux aujourd'hui : GET et POST.</p>
<p> Quand tu saisis l'adresse "www.facebook.com" dans ton navigateur 
web, en fait tu lui demandes de faire une requête GET sur cette URL. 
Cette requête GET va arriver au serveur de Facebook qui va l'interpréter
 comme si tu lui disais : "Peux-tu m'envoyer le contenu correspondant à 
www.facebook.com ?". Ce qu'il va faire avec plaisir</p>

<p>La requête POST, elle, est un peu plus complète. Un bon exemple 
serait quand tu te login sur facebook.com : en faisant ça, tu envoies 
plus qu'une simple URL. En effet, pour te connecter à ton compte, tu 
soumets un formulaire avec de l'info dedans : ton e-mail et ton mot de 
passe. Dans ce cas, c'est un POST où tu dis au serveur de Facebook : 
"voici les informations demandées (login + mot de passe), maintenant 
traite-les et balance-moi du contenu en retour".</p>

<p>Pour faire simple, une requête GET c'est juste demander d'afficher le
 contenu d'une URL donnée. Une requête POST c'est envoyer le contenu 
d'un formulaire et obtenir une réponse en retour. <br>
Pour schématiser, GET pourrait correspondre à <code>puts</code> et POST pourrait correspondre à un <code>gets.chomp</code> suivi d'un <code>puts</code>.</p>

<p>Pour notre exemple, si j'avais mis dans le code <code>post '/hello' do --- end </code>, cela voulait dire que si quelqu'un complétait un formulaire sur la page <code>/hello</code>, Sinatra aurait exécuté le code entre <code>do</code> et <code>end</code>. Et non plus la partie en <code>get '/hello'</code>.</p>

<h5>3.2.2 Les routes</h5>
<p>Les routes sont les URL qui vont entraîner une réponse du serveur et donc une action. En écrivant <code>get '/hello' do ---- end</code>, tu as mis une route sur le GET de <code>/hello</code>. Cela indique au serveur : "si quelqu'un va sur <code>/hello</code>, voilà le code à exécuter". </p>

<p>Par contre, si tu vas sur une URL non prévue (exemple : <a href="http://localhost:4567/bonjour" target="_blank">http://localhost:4567/bonjour</a>),
 Sinatra va te renvoyer une page HTML qui dit "hé, y'a pas de route à 
cette adresse-là". En gros, comme tu ne lui as pas expliqué quoi faire 
si quelqu'un va sur <code>/bonjour</code>, il est perdu et renvoie une erreur.</p>

<p>Maintenant on va s'amuser à paramétrer cette route <code>/bonjour</code> qui était jusque-là inconnue. Ajoute dans ton fichier <code>app.rb</code> le code suivant :</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/bonjour'</span> <span class="token keyword">do</span>
  <span class="token string">'&lt;h1&gt;Bonjour, monde !&lt;/h1&gt;'</span>
<span class="token keyword">end</span></code></pre>

<p>Pour que cette nouvelle route soit prise en compte, il faut que tu coupes le serveur (CTRL-C) et relances <code>$ ruby app.rb</code>. Maintenant, retourne sur <a href="http://localhost:4567/bonjour" target="_blank">http://localhost:4567/bonjour</a> : Sinatra sait quoi faire et va t'afficher "Bonjour, monde !".</p>



<h2>4. Pour aller plus loin</h2>
<p>Bon, un programme statique qui affiche "Hello world&nbsp;!", c'est un
 peu limité. Ce que nous allons faire ensuite, c'est utiliser ces bases 
pour faire une application dynamique, qui interagit avec l'utilisateur. 
Nous allons ranger le programme dans un beau dossier bien ordonné et 
faire des requêtes POST qui traiteront de l'information.</p>

<p>Voici <a href="http://sinatrarb.com/intro.html" target="_blank">la doc de la gem Sinatra</a>, que tu peux survoler si le cœur t'en dit.</p>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #FF4081">
<h1>
Projets : 
Une application en Sinatra
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/projects/27/project_submissions/new"><i class="ft-edit" data-original-title="Proposer une amélioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>Maintenant que tu sais faire des applications en Ruby pur comme un 
grand, on va enfin passer au web grâce à Sinatra ! Ce sera l'occasion de
 te prouver que les notions déjà acquises te permettent déjà de faire 
des choses sympas.</p>

<p>Aujourd'hui, nous allons te demander de faire The Gossip Project en 
Sinatra. Grosso modo, tu vas refaire cette application, mais dans les 
views, au lieu d'avoir <code>puts</code> et <code>gets.chomp</code>, tu 
auras du code HTML. Fini le terminal tout moche, on passe à une 
application web toute belle qu'il ne resterait qu'à mettre en production
 sur un serveur 😇 Merveilleux, n'est-ce pas ?</p>

<p>Pour ceux qui ont la mémoire courte, voici le pitch de The Gossip Project. <br>
=&gt; The Hacking Project est une chouette formation, où la communauté 
est reine. Il se passe plein de choses à Paris, Lyon, Montpellier, 
Bordeaux et c'est dur de connaître tous les ragots. Nous allons donc 
créer une application où tout le monde va pouvoir ajouter des potins sur
 ses camarades moussaillons.</p>

<p>Dans les grandes lignes, voici les fonctionnalités principales de notre application web : </p>
<ul>
  <li>La page d'accueil du site affichera tous les potins que nous avons en base.</li>
  <li>Cette page d'accueil donnera un lien pour un formulaire où quiconque pourra ajouter un potin en base.</li>
  <li>Chaque potin aura une page dédiée.</li>
</ul>

<p>Cette application sera très bas-niveau, c’est-à-dire que nous allons 
quasiment tout faire à la main. Ça va t'obliger à réinventer la roue en 
organisant bien ton programme, en gérant toi-même la base de données, 
etc. Mais, après avoir passé du temps les mains dans le cambouis, tu 
seras armé pour dompter Rails où tout est automatisé (sauf le café).</p>

<p>On va t'accompagner dans ce travail en mode "pas à pas" et à la fin, voilà ce que tu auras appris :</p>
<ul>
  <li>Utiliser un serveur ;</li>
  <li>Lancer une application en Sinatra, et bien ranger le code en MVC ;</li>
  <li>Définir des routes et endpoints dans ton application ;</li>
  <li>Utiliser les views pour gérer plus facilement le HTML / CSS ;</li>
  <li>Créer et avoir une base de données ;</li>
  <li>Récupérer de l'information à partir de formulaires et la stocker en base de données.</li>
</ul>

<h2>2. Le projet</h2>
<h3>2.1. Architecture et rangement</h3>
<p>Dans ce chapitre, nous allons voir comment avoir un dossier Sinatra 
bien organisé. On insiste dessus mais il n'est jamais inutile de vous 
rafraîchir la mémoire : vous allez commencer à faire programmes 
complexes et longs, basés sur plusieurs gems et framework. Sans un 
rangement propre, une personne extérieur à votre cerveau ne pourra pas 
la comprendre rapidement et simplement. Même vous dans 3 mois vous vous y
 perdrez en revenant sur le projet. Donc on va investir sur l'avenir et 
appliquer les bonnes pratiques d'un développeur professionnel qui veut 
pouvoir travailler en équipe et produire du code maintenable à long 
terme. </p>

<p>On va donc partir sur un dossier bien rangé en architecture MVC, avec
 chaque fichier qui a un but unique, et des dossiers qui suivent la 
convention. C'est parti !</p>

<h4>2.1.1. Création des premiers fichiers</h4>
<p>Évidemment, pour commencer, nous allons créer un dossier <code>the_gossip_project_sinatra</code> qui contiendra notre application. Comme pour l'application précédente, nous allons créer un fichier <code>Gemfile</code>, ainsi qu'un fichier <code>controller.rb</code>. <code>Gemfile</code> devra appeler la gem <code>sinatra</code> ainsi que notre version habituelle de Ruby. Le fichier <code>controller.rb</code> va nous permettre de finir la classe du controller sous le nom <code>ApplicationController</code>. Il doit contenir les lignes suivantes :</p>

<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require

<span class="token keyword">class</span> <span class="token const">ApplicationController</span> &lt; <span class="token const">Sinatra</span><span class="token punctuation">:</span><span class="token symbol">:Base</span>
  get <span class="token string">'/'</span> <span class="token keyword">do</span>
    <span class="token string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Gossip Project&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Mon super site de gossip !&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>
  <span class="token keyword">end</span>

  run<span class="token operator">!</span> <span class="token keyword">if</span> app_file <span class="token operator">==</span> $<span class="token number">0</span>
<span class="token keyword">end</span></code></pre>

<p>Nous allons expliquer ces lignes de code, mais d'abord exécute l'application <code>controller.rb</code> après avoir fait l'installation du serveur. Si tu vas sur <a href="http://localhost:4567/" target="_blank">http://localhost:4567/</a>, cela devrait afficher un site avec le code source correspondant.</p>


<h4>2.1.2. Les lignes du fichier controller.rb</h4>
<p>Nous allons expliquer ces lignes unes à unes. En route : ⛵️</p>

<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require</code></pre>

<p>Tu connais déjà ces lignes : elles appellent le bundler et permettent
 de lire le Gemfile. Ainsi, pas besoin de mettre partout des <code>require 'gem'</code>.</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token const">ApplicationController</span> &lt; <span class="token const">Sinatra</span><span class="token punctuation">:</span><span class="token symbol">:Base</span>
  <span class="token comment"># blabla
</span><span class="token keyword">end</span></code></pre>
<p>Dans cette partie, nous avons créé une classe <code>ApplicationController</code> qui hérite (<code>&lt;</code>) de la classe <code>Sinatra::Base</code>. Grâce à l'héritage, <code>ApplicationController</code> aura toutes les fonctionnalités que propose la classe <code>Sinatra::Base</code> (= toutes les fonctionnalités de base de Sinatra).</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token comment"># blabla
</span><span class="token keyword">end</span></code></pre>
<p>Ça on l'a vu dans la ressource. Cela dit à l'appli Sinatra "si quelqu'un va sur l'URL '/', exécute le code qui suit !"</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Gossip Project&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Mon super site de gossip !&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span></code></pre>
<p>Doit-on vraiment expliquer cette partie ? C'est le code HTML de la 
page à afficher, bien sûr. Simplement il est affiché sur une ligne (ce 
qui est très moche à lire).</p>

<pre class=" language-ruby"><code class=" language-ruby">run<span class="token operator">!</span> <span class="token keyword">if</span> app_file <span class="token operator">==</span> $<span class="token number">0</span></code></pre>
<p>Cette ligne est assez mystérieuse pour toi, mais en gros, elle permet d’exécuter le code de la classe sans avoir à écrire un <code>ApplicationController.new.perform</code>
 en bas du fichier. Si tu te rappelles bien, exécuter un fichier qui 
définit une classe (et c'est tout), eh bien ça ne donne rien... Il faut 
forcément l'exécution d'une méthode en bas de la classe pour lancer la 
machine ! C'est ce que fait cette ligne.</p>

<p>Voici donc à quoi ressemble notre dossier de projet :</p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra
│
├── .git, README, toussa
├── Gemfile
├── Gemfile.lock
└── controller.rb</code></pre>


<p>Poursuivons le pas-à-pas pour étoffer un peu notre programme.</p>

<h4>2.1.3. Lancer proprement son serveur</h4>
<p>Bon, si tu relis le contenu de ton fichier <code>controller.rb</code>, tu devrais avoir le sentiment qu'il y a une verrue au milieu de ton code. C'est chelou ce <code>run! if app_file == $0</code>
 non ? Maintenant que l'on sait que faire du code propre, c'est 
primordial, on voudrait bien pouvoir séparer le code qui défini nos 
classes/variables/méthodes du code qui ne sert qu'à l'exécuter. On va 
créer un fichier dont la mission est de lancer le serveur.</p>

<h5>a) Rack</h5>
<p>Il existe un standard qui s'appelle <a href="https://rack.github.io/" target="_blank">Rack</a> et qui lance des serveurs Ruby. C'est parfait et nous allons l'utiliser.</p>

<h5>b) config.ru</h5>
<p>Nous allons créer un fichier <code>config.ru</code> qui contient les 
informations nécessaires au lancement de notre serveur. Promis, son 
extension russe ne cache rien de louche : un fichier <code>.ru</code> est juste un fichier <i>rack up</i>, qui est un fichier Ruby. Crée donc un fichier <code>config.ru</code> et mets-y les lignes suivantes :</p>

<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require

require <span class="token string">'./controller'</span>

run <span class="token const">ApplicationController</span></code></pre>

<p>Les lignes sont plutôt explicites : on demande simplement au serveur d'exécuter le contenu de la classe <code>ApplicationController</code> 🎭.<br>
Avant de lancer le serveur, enlève les lignes de <code>controller.rb</code> qui sont en doublons avec <code>config.ru</code> : les lignes qui appellent le bundler ainsi que la ligne <code>run! if app_file == $0</code> qui ne sert plus à rien. </p>
<p>Haaaa. Notre fichier <code>controller.rb</code> est tout propre maintenant : il ne contient plus que les infos de la classe qu'on définit et ça, c'est cool 🤓</p>

<h5>c) Rackup</h5>

<p>Maintenant on va lancer le serveur. Exécute la commande <code>$ rackup</code>,
 ce qui devrait lancer le serveur. Si tu regardes les lignes s'affichant
 à l'exécution, tu verras que le port d'écoute a changé. Maintenant on 
est sur <a href="http://localhost:9292/" target="_blank">http://localhost:9292/</a> car Rackup se met par défaut sur le port <code>9292</code>, contrairement au port <code>4567</code> de Sinatra. <br>
Comme c'est la convention de se mettre sur <code>4567</code> pour une app Sinatra et que nous sommes dans une app Sinatra, tu peux te brancher sur le port <code>4567</code> en exécutant plutôt <code>$ rackup -p 4567</code> 😎</p>


<h4>2.1.4. Construire l'architecture MVC</h4>
<h5>a) Les views (et shotgun)</h5>
<p>Allez, on poursuit la clarification de notre architecture. La prochaine étape, quand on regarde le code de <code>controller.rb</code>,
 c'est de se dire "purée, c'est dégueu d'avoir du HTML sur une seule 
ligne et au milieu de mon code. Ça va être affreux le jour où j'ai des 
10 pages différentes qui font 1000 lignes de HTML chacune."</p>

<p>On va donc utiliser la fonctionnalité des views de Sinatra, et mettre notre HTML dans un fichier à part. Crée donc un dossier <code>views</code> avec dedans un premier fichier <code>index.erb</code>. Ce fichier va contenir le code HTML de la view <code>index</code> : c'est la view qui liste tous les gossip présents en BDD. Au passage, sache qu'un fichier <code>.erb</code>
 est un fichier HTML dans lequel tu peux y rajouter du Ruby. En 
mélangeant les deux langages, tu vas pouvoir afficher en HTML des trucs 
du genre <code>user.first_name</code>, ce qui est plutôt pratique pour dire "Bienvenue Félix" ou "Bienvenue José" selon qui se connecte 😘</p>

<p>Bref, voici ce que le fichier <code>index.erb</code> doit contenir : </p>
<pre class=" language-ruby"><code class=" language-ruby">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;<span class="token const">The</span> <span class="token const">Gossip</span> <span class="token const">Project</span>&lt;<span class="token operator">/</span>title&gt;
  &lt;<span class="token operator">/</span>head&gt;
  &lt;body&gt;
    &lt;h1&gt;<span class="token const">Mon</span> <span class="token keyword">super</span> site de gossip<span class="token punctuation">,</span> depuis le dossier views <span class="token operator">!</span>&lt;<span class="token operator">/</span>h1&gt;
  &lt;<span class="token operator">/</span>body&gt;
&lt;<span class="token operator">/</span>html&gt;</code></pre>

<p>Haaaaa (soulagement)....du HTML indenté ! C'est quand même plus 
agréable à lire qu'un gros blob sur une ligne non ? Bon maintenant on va
 faire pointer la bonne route de <code>controller.rb</code> vers ce fichier en disant "si quelqu'un va sur '/', affiche la view <code>index.erb</code>". <br>
Dans le fichier <code>controller.rb</code>, voici comment tu dois modifier la route :</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  erb <span class="token symbol">:index</span>
<span class="token keyword">end</span></code></pre>

<p>Tout simplement ! Sinatra comprend tout seul qu'il doit aller chercher le fichier <code>index.erb</code> rangé dans le dossier <code>/views</code>.</p>

<p></p>Maintenant si tu vas  <a href="http://localhost:4567/" target="_blank">sur la page d'accueil de ton serveur</a>, tu devrais avoir cette nouvelle page, qui dit "depuis le dossier views".<p></p>

<p>Là, certains diront <b>"Elle n'a pas changé 😢"</b></p>

<p>Damnit ! En fait c'est tout bête, mais étant donné que tu as changé le fichier <code>controller.rb</code>, la modification ne sera pas prise en compte tant que le fichier <code>config.ru</code> tourne toujours (il ne recharge pas automatique la dernière version du fichier <code>controller.rb</code>). Il faut donc quitter le serveur et le redémarrer : fais le test.</p>

<p>Ce n'est pas pratique de relancer à chaque fois son serveur. On va 
donc ajouter une surcouche à Rackup qui recharge automatiquement 
l'application en cas de modification. Cette surcouche est <a href="https://github.com/rtomayko/shotgun" target="_blank">une gem dénommée shotgun</a>. Comme d'hab, on l'ajoute dans le <code>Gemfile</code> en faisant <code>gem 'shotgun'</code>, puis, après avoir fait l'installation du bundle, on peut l'utiliser en passant la commande <code>$ shotgun -p 4567</code> dans le terminal. À toi le nouveau serveur qui déchire !</p>


<h5>b) Une vraie arborescence</h5>
<p>Allez, promis, ce sont les derniers changements avant de s'attaquer 
au coeur du code 😇. Notre application devrait ressembler à ceci pour le
 moment :</p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra/
├── Gemfile
├── Gemfile.lock
├── controller.rb
├── config.ru
└── views
    └── index.erb</code></pre>

<p>C'est pas trop mal, mais ça ne respecte pas les standards que tu connais hein ? Tu l'as vu direct, il manque le dossier <code>lib</code>
 qui évite qu'on entasse tout à la racine comme des sagouins. Fais donc 
les changements nécessaires pour avoir l'arborescence suivante : </p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra/
├── Gemfile
├── Gemfile.lock
├── config.ru
└── lib
    ├── views
    │   └── index.erb
    └── controller.rb</code></pre>

<p>Ainsi, notre application suit mieux la convention MVC maintenant : ce
 sera plus pratique pour comprendre ce qu'elle fait. Dernier détail, 
pour la faire marcher, il faut dire à notre fichier <code>config.ru</code> de prendre en compte tous les fichiers dans le dossier <code>lib</code>. On va modifier deux lignes, et voici ce à quoi il devrait ressembler :</p>
<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require

$<span class="token punctuation">:</span><span class="token punctuation">.</span>unshift <span class="token builtin">File</span><span class="token punctuation">.</span>expand_path<span class="token punctuation">(</span><span class="token string">"./../lib"</span><span class="token punctuation">,</span> __FILE__<span class="token punctuation">)</span>
require <span class="token string">'controller'</span>
run <span class="token const">ApplicationController</span></code></pre>

<p>Si tu lances le serveur avec <code>$ shotgun -p 4567</code>, tout 
devrait fonctionner normalement. On a les bases pour une application 
solide, bien rangée. Maintenant on peut passer à la suite 💪.</p>

<h3>2.2. Les premières views</h3>
<h4>2.2.1. Index</h4>
<p>Notre view "index" doit afficher la liste des gossips, ainsi qu'un 
lien pour créer un gossip. Pour le moment, notre base de données est 
vide donc on va se focaliser sur l'ajout d'un lien pour créer un nouveau
 gossip (histoire de pouvoir alimenter la BDD).</p>

<p>Par convention, quand on veut créer une nouvelle entrée en BDD (ici, un nouveau potin de la classe <code>Gossip</code>), on va sur un lien URL qui suit cette structure<code>/nom_classe_au_pluriel/new/</code>. Ainsi, pour créer un potin, nous voulons que ça se passe sur <code>gossips/new/</code>. </p>

<p>Pour créer un lien HTML qui pointe vers cette adresse, il te suffit d'ajouter un tag HTML selon ce modèle <code>&lt;a href="/gossips/new/"&gt;le texte du lien&lt;/a&gt;</code>. En effet, Sinatra est malin et comprendra qu'il faut renvoyer via l'URL complète <code>http://localhost:4567/gossips/new/</code>
 : inutile de préciser le localhost donc. C'est même une très mauvaise 
idée car si tu décides de changer le port d'écoute du serveur (par 
exemple, tu oublies de mettre <code>-p 4567</code> et ça pointe vers <code>9292</code>), plus aucun lien ne marche sur ton site 😄.</p>

<p>Pour commencer, on va donc coder une view <code>index</code> simple :
 souhaitons la bienvenue à ton utilisateur en lui disant que la liste 
des potins arrive bientôt, et qu'en attendant, il peut <a href="http://localhost:4567/gossips/new/" target="_blank">aller créer un nouveau potin</a>. Insère donc le lien pour qu'il aille sur <code>/gossips/new/</code>. </p>

<p>Si tu cliques sur ce lien, Sinatra devrait te renvoyer une erreur 
pour te dire qu'il n'y a pas de routes sur cette adresse. Eh bien 
créons-la !</p>

<h4>2.2.2. A new gossip !</h4>
<h5>a) Paramétrer la route GET en entrée</h5>
<p>Il faut donc commencer par paramétrer la route pour que le serveur pointe vers une nouvelle view <code>new_gossip.erb</code> quand on va sur <code>/gossips/new/</code>. Mets en place la route en suivant le modèle de ta première route et crée dans le dossier <code>views</code> un fichier <code>new_gossip.erb</code>. Puis fais pointer la route <code>/gossips/new/</code> vers cette nouvelle view depuis le controller.</p>

<h5>b) Créer la view</h5>
<p>Pour cette view, nous allons insérer un <a href="https://www.w3schools.com/htmL/html_forms.asp" target="_blank">formulaire</a>
 ultra simple. Comme vu dans la ressource, un formulaire permet 
d'envoyer de l'information vers une URL précise via une requête POST. 
Pour notre exemple, le formulaire devra envoyer le potin en POST à 
l'adresse <code>/gossips/new/</code>. Nous aimons bien faire réfléchir les moussaillons à THP, mais on va te guider encore un peu en te donnant le code de la page <code>new_gossip.erb</code> : </p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;<span class="token const">Cr</span>éer un potin&lt;<span class="token operator">/</span>title&gt;
  &lt;<span class="token operator">/</span>head&gt;
  &lt;body&gt;
    &lt;h1&gt;<span class="token const">Cr</span>ée un potin <span class="token operator">!</span>&lt;<span class="token operator">/</span>h1&gt;
    &lt;p&gt;<span class="token const">Balance</span> ton potin via le formulaire ci<span class="token operator">-</span>dessous&lt;<span class="token operator">/</span>p&gt;
    &lt;form action<span class="token operator">=</span><span class="token string">'/gossips/new/'</span> method<span class="token operator">=</span><span class="token string">'POST'</span>&gt;
      <span class="token const">Saisi</span> ici ton nom <span class="token punctuation">:</span>  &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_author'</span><span class="token operator">/</span>&gt;&lt;br<span class="token operator">/</span>&gt;
      <span class="token const">Balance</span> ton potin <span class="token punctuation">:</span> &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_content'</span><span class="token operator">/</span>&gt;&lt;br<span class="token operator">/</span>&gt;
      &lt;input type<span class="token operator">=</span><span class="token string">'submit'</span><span class="token operator">/</span>&gt;
    &lt;<span class="token operator">/</span>form&gt;
  &lt;<span class="token operator">/</span>body&gt;
&lt;<span class="token operator">/</span>html&gt;</code></pre>

<h5>c) Regardons ce formulaire de près</h5>
<p>Comme c'est ton premier formulaire et que je n'aime pas te faire 
bosser sur des copier-coller idiots, on va décortiquer le contenu du 
formulaire.</p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;form action<span class="token operator">=</span><span class="token string">'/gossips/new/'</span> method<span class="token operator">=</span><span class="token string">'POST'</span>&gt;
<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
&lt;<span class="token operator">/</span>form&gt;</code></pre>
<p>Cette partie est l'ossature du formulaire. Le champ <code>action</code> définit l'URL qui va recevoir le contenu du formulaire et le champ <code>method</code> définit le type de requête. Ici, on enverra donc le contenu du formulaire vers l'URL <code>/gossips/new/</code> avec une requête POST.</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token const">Saisi</span> ici ton nom <span class="token punctuation">:</span> &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_author'</span><span class="token operator">/</span>&gt;</code></pre>
<p>Ici, on rajoute un champ de saisie de texte à remplir par l'utilisateur avec le tag HTML <code>&lt;input type='text'&gt;</code>. L'option <code>name</code>
 définir le nom que portera ce contenu saisi, tout comme on lui 
donnerait un nom de variable en Ruby du genre "user_name" ou autre. En 
l'appelant <code>gossip_author</code> et en mettant avant le champ de 
saisie la phrase "Saisie ici ton nom", on comprend bien qu'on veut que 
l'utilisateur tape ici son nom.</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token const">Balance</span> ton potin <span class="token punctuation">:</span> &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_content'</span><span class="token operator">/</span>&gt;</code></pre>
<p>Idem que plus haut mais cette fois on veut que l'utilisateur tape ici le texte du gossip à créer.</p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;input type<span class="token operator">=</span><span class="token string">'submit'</span><span class="token operator">/</span>&gt;</code></pre>
<p>Tout formulaire qui se respecte termine forcément par un bouton 
"submit". En cliquant dessus, l'utilisateur va déclencher l'envoi de la 
requête POST avec toutes les informations des champs du formulaire.</p>

<h5>d) Testons cela</h5>
<p>Va sur <a href="http://localhost:4567/gossips/new/" target="_blank">la page de création de potin</a>, puis clique sur <code>submit</code>. Sinatra va t'envoyer bouler car tu n'as pas créé de route pour le POST de <code>/gossips/new/</code> alors même que tu as une route pour le GET de cette même URL. <br>
Et oui, pour une même URL, l'action sera différente entre un GET et un 
POST. En GET, tu vas dire à Sinatra : "hey, si quelqu'un va sur 
/gossips/new/ envoie-lui les view <code>new_gossip</code>", cependant en
 POST, ce sera plutôt un truc du genre "hey bro, récupère les 
informations du formulaire et convertis-les en une création de gossip 
dans ma base".</p>

<h5>e) Paramétrer la route POST en sortie</h5>
<p>Nous allons paramétrer donc cette route, puis nous irons créer un Gossip en base de donnée. Dans le fichier <code>controller.rb</code>, mets donc la route suivante :</p>

<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  puts <span class="token string">"Ce programme ne fait rien pour le moment, on va donc afficher un message dans le terminal"</span>
<span class="token keyword">end</span></code></pre>

<p>Si tu soumets le formulaire le programme ne t'affiche plus d'erreur 
de route, mais te renvoie une page blanche (c'est normal, puisque on ne 
lui a pas dit d'afficher une view). Si tu regardes la fenêtre de ton 
serveur, tu vas voir la phrase <i>"Ce programme ne fait rien pour le moment, on va donc afficher un message dans le terminal"</i>. C'est super intéressant, car : <br>
1️⃣ cela veut dire que ta route marche car le <code>puts</code> est bien exécuté. <br>
2️⃣ tu aurais pu exécuter autre chose qu'un <code>puts</code>. N'importe
 quoi d'autre en fait : par exemple, tu pourrais insérer tout ton 
programme de scrapping de cryptomonnaies pour qu'il soit exécuté au <code>submit</code> du formulaire.🐧</p>

<p>Bref, maintenant, ce serait bien de pouvoir créer un Gossip quand on soumet le formulaire. Nous allons donc créer une classe <code>Gossip</code> dont le rôle sera de sauvegarder les potins dans une base de données maison. BOUM !</p>


<h3>2.3. La classe Gossip et la base de données</h3>
<p>Dans ce chapitre, nous allons voir comment créer un Gossip et 
l'ajouter en base de données. En gros, nous voudrions avoir dans notre 
fichier <code>controller.rb</code> une route POST du genre :</p>
<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  <span class="token const">Gossip</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>les_entrées_du_gossip<span class="token punctuation">)</span><span class="token punctuation">.</span>save
<span class="token keyword">end</span></code></pre>

<p><code>Gossip.new(les_entrées_du_gossip)</code> crée la nouvelle instance de <code>Gossip</code>. Et en lui appliquant un <code>.save</code>, on veut qu'elle soit inscrite dans la base de donnée. Donc mettons ça en place ! 🤠</p>

<h4>2.3.1. La classe Gossip</h4>
<p>Nous allons créer une classe <code>Gossip</code> (c'est notre model !). Elle aura une méthode <code>#save</code>
 qui enregistrera dans une base de données l'objet sur laquelle elle est
 appliquée. Comme ça on stocke tous les potins, et puis y'aura juste à 
aller les chercher quand nécessaire.</p>

<p>Crée dans le dossier <code>lib</code> un fichier <code>gossip.rb</code> qui contiendra le code de la classe <code>Gossip</code>. Pour le moment, on va se focaliser sur le fichier <code>gossip.rb</code>, et puis quand il sera fonctionnel, on le branchera au controller.</p>

<p>Dans le fichier <code>gossip.rb</code>, crée la classe <code>Gossip</code> et ajoute-lui une méthode <code>#save</code> qui sera vide pour l'instant.</p>

<h4>2.3.2. Lien avec la base de données</h4>
<p>Ce que nous voulons faire, c'est qu'une action comme <code>instance_de_la_classe_gossip.save</code>
 enregistre en base de données le potin. Nous pouvons le faire avec 
JSON, CSV, SQL, ou même Google Spreadsheet. Je vais te montrer comment 
le faire en CSV car c'est le plus simple de mon point de vue. Choisi 
l'option que tu préfères mais sache qu'à terme, nous utiliserons de 
vraies bases de données en SQL.</p>

<p>Comme tu le sais, une base de données ça se ranger dans un dossier <code>/db</code> à la racine de notre application. Ainsi, voici à quoi va ressembler l'arborescence de notre application :</p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra
├── Gemfile
├── Gemfile.lock
├── config.ru
├── db
│   └── gossip.csv
└── lib
    ├── controller.rb
    ├── gossip.rb
    └── views
        ├── index.erb
        └── new_gossip.erb</code></pre>

<p>Avec les connaissances acquises la semaine passée, tu devrais savoir comment faire pour que <code>gossip.rb</code> puisse écrire sur un CSV via la méthode <code>#save</code>.<br>
Juste au cas où, je te mets quand même à quoi elle devrait ressembler : </p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> save
  <span class="token const">CSV</span><span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"./db/gossip.csv"</span><span class="token punctuation">,</span> <span class="token string">"ab"</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>csv<span class="token operator">|</span>
    csv &lt;&lt; <span class="token punctuation">[</span><span class="token string">"Mon super auteur"</span><span class="token punctuation">,</span> <span class="token string">"Ma super description"</span><span class="token punctuation">]</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>

<p>Pour rappel, ces lignes se lisent ainsi : <br>
1) Nous ouvrons le CSV en mode écriture (<a href="http://ruby-doc.org/core-2.0.0/IO.html#method-c-new-label-IO+Open+Mode" target="_blank">ab</a>) (le CSV a le path <code>db/gossip.csv</code>). <br>
2) Nous insérons dedans une ligne avec deux colonnes. La première colonne a pour entrée le string <code>Mon super auteur</code> et la seconde colonne a le string <code>Ma super description</code>.</p>

<p>Je te laisse mettre tout ça dans la classe <code>Gossip</code> puis tester (par exemple avec PRY et un petit <code>Gossip.new.save</code>) que la méthode <code>save</code> ajoute bien une ligne "Mon super auteur, Ma super description" à ton CSV. <br>
Maintenant nous allons donc brancher ceci à notre fichier <code>controller.rb</code>.</p>


<h4>2.3.3. Dans l'application</h4>
<p>Maintenant il faut s'arranger pour que quand quelqu'un soumet le formulaire, notre programme appelle la méthode <code>save</code> de la classe Gossip. Pour ceci, ajoute la ligne <code>Gossip.new.save</code> à la route POST concernée de notre fichier <code>controller.rb</code>. Avec <code>Gossip.new</code> on crée un nouvel objet Gossip et avec <code>.save</code> on lui applique la méthode save</p>

<p>Essaye maintenant de soumettre le formulaire : le programme va 
t'envoyer bouler en te disant que la classe Gossip n'existe pas. C'est 
juste qu'on a oublié de lier les deux classes entre elles : ajoute tout 
en haut du programme <code>controller.rb</code> la ligne <code>require 'gossip'</code>.</p>

<p>À présent, si tu soumets le formulaire, cela devrait ajouter à 
nouveau la ligne "Mon super auteur, Ma super description" à notre CSV. 
C'est –presque– exactement ce que l'on cherchait à faire ! Youpi !</p>

<h4>2.3.4. Enregistrer en CSV mais avec des paramètres dynamiques</h4>
<p>Bon, là tu dois te dire "c'est cool son programme, mais ça enregistre à chaque <code>submit</code> la même ligne <i>Mon super auteur</i> et <i>Ma super description</i>
 dans le CSV. C'est un peu bidon". C'est parce que nous n'avons pas pris
 en compte les infos saisies par l'utilisateur ! Il faut rendre tout 
cela paramétrable en faisant un truc du genre <code>Gossip.new(author, content).save</code> pour que cela écrive dans le CSV le <code>author</code> et le <code>content</code>.</p>

<p>Si tu as bonne mémoire, tu peux définir des variables d'instance dans ta classe <code>Gossip</code>. Ajoute donc deux variables d'instance <code>@author</code> et <code>@content</code> en les passant en paramètres dans une méthode <code>initialize</code>. <br>
A présent, il te faut modifier la méthode <code>#save</code> pour qu'elle écrive non plus <code>"Mon super auteur"</code> et <code>"Ma super description"</code> mais plutôt les valeurs contenues dans <code>@author</code> et <code>@content</code> dans le CSV. Ainsi il faut que <code>Gossip.new("José", "Josiane est nulle").save</code> rajoute la ligne "José, Josiane est nulle" dans le CSV.</p>

<p>Je te laisse passer les modifications. </p>

<p>Maintenant met la ligne <code>Gossip.new("super_auteur", "super gossip").save</code> dans le fichier <code>controller.rb</code>
 et vérifie qu'en soumettant le formulaire (sans le remplir. Juste pour 
activer la route POST)cela ajoute une ligne dans le fichier <code>gossip.csv</code> avec les colonnes <code>super_auteur</code> et <code>super gossip</code>. Si oui, c'est que tu as réussi !</p>

<p>Waow ! Tu as réussi à créer une base de données qui se met à jour 
toute seule comme une grande, dans une application faite à partir de 
rien. C'est quand même sacrément solide 😇 Bon maintenant, ce qui serait
 top, ce serait de récupérer le contenu du formulaire et de 
l'enregistrer en faisant <code>Gossip.new(info_formulaire_1, info_formulaire_2).save</code>.Eh bien c'est ce que nous allons voir !</p>

<h3>2.4. Ajouter un Gossip à partir du front</h3>
<p>Dans cette partie, nous allons apprendre à récupérer l'information du formulaire, puis de l'ajouter en base dans notre base.</p>

<h4>2.4.1. Récupérer les infos du formulaire via <code>params</code></h4>
<p>Quand on fait du web, il existe une variable assez ultime qui s'appelle <code>params</code>.
 En gros, params est un hash qui va stocker temporairement les 
informations que nous envoie l'utilisateur. Cela peut être une 
information quand il fait un GET (avec par exemple une URL du genre <code>/facebook.com/username</code>), ou alors un formulaire qu'il nous soumet avec un POST.</p>

<p>Fais donc un test en écrivant, dans le controller, le code suivant :</p>

<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  puts <span class="token string">"Salut, je suis dans le serveur"</span>
  puts "<span class="token const">Ceci</span> est le contenu du hash params <span class="token punctuation">:</span> <span class="token comment">#{params}"
</span>  puts "<span class="token const">Trop</span> bien <span class="token operator">!</span> <span class="token const">Et</span> ceci est ce que l'utilisateur a passé dans le champ gossip_author <span class="token punctuation">:</span> <span class="token comment">#{params["gossip_author"]}"
</span>  puts "<span class="token const">De</span> la bombe<span class="token punctuation">,</span> et du coup ça<span class="token punctuation">,</span> ça doit être ce que l'utilisateur a passé dans le champ gossip_content <span class="token punctuation">:</span> <span class="token comment">#{params["gossip_content"]}"
</span>  puts <span class="token string">"Ça déchire sa mémé, bon allez je m'en vais du serveur, ciao les BGs !"</span>
<span class="token keyword">end</span></code></pre>

<p>Maintenant retourne sur le formulaire, rempli les 2 cases avec 
quelque chose et soumets-le. Va voir ton terminal, et hop, magie, tu 
retrouves les informations de ton formulaire ! Cet exemple illustre par 
ailleurs que "dans le doute, mets des puts partout" : ça te permet de 
comprendre comment marche un programme (et donc le débugger).</p>

<p><b>Conclusion de notre test</b> : quand l'utilisateur soumet le formulaire, <code>params</code> récupère son contenu et le stocke avec les noms qu'on avait choisis pour chaque champ de texte. <code>params["gossip_author"]</code> et <code>params["gossip_content"]</code> contiennent les 2 strings rentrés par l'utilisateur.</p>

<p>Note importante : le contenu de <code>params</code> ne persiste que 
d’une page sur l’autre. Le hash se vide à chaque requête HTTP 
(changement de page). Il faut donc récupérer le contenu immédiatement 
après la saisie, sinon c'est perdu !</p>


<h4>2.4.2. Créer un gossip</h4>
<p>Maintenant, on va devoir s'arranger pour récupérer les informations du formulaire et les injecter dans le code <code>Gossip.new(truc_1, truc_2).save</code> pour qu'elles soient enregistrées dans notre base de données. Je t'invite donc à mettre <code>params["gossip_author"]</code> et <code>params["gossip_content"]</code> dans la commande <code>Gossip.new(truc_1, truc_2).save</code> de ton controller.</p>

<p>Tu peux tester ton code en soumettant le formulaire et en regardant ce qu'il fait à ton fichier <code>gossip.csv</code>. N'hésite pas non plus à mettre des <code>puts</code> dans ton code et regarder ce que ça donne sur le terminal. </p>

<p>Une fois que tu as réussi à faire marcher cela, eh bien bravo ! Tu 
sais créer un formulaire, et enregistrer en base de données les 
informations de ce formulaire.</p>

<h4>2.4.3. Rediriger vers l'accueil</h4>
<p>Ton formulaire, quand il est soumis, dit à l'application "hé, voici 
les informations : crée un gossip avec". C'est tip top. Cependant, 
l'utilisateur n'a aucun retour : ce serait bien de pouvoir revenir sur 
la page d'accueil une fois que le gossip a été créé.</p>

<p>Et bien il existe une super commande qui s'appelle <code>redirect</code>
 et qui dit à Sinatra "maintenant, redirige le user vers cette route". 
Ainsi, pour rediriger vers la route '/', il faudra écrire <code>redirect '/'</code>. Du coup, pour rediriger l'utilisateur après avoir sauvegardé le gossip, il faudra écrire :</p>

<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  <span class="token comment"># ton super code qui enregistre un gossip en fonction de params
</span>  redirect <span class="token string">'/'</span>
<span class="token keyword">end</span></code></pre>

<p>Et quand tu vas soumettre le formulaire, voici ce qui va se passer :</p>
<ol>
  <li>Le programme va récupérer les informations du formulaire avec <code>params</code> ;</li>
  <li>Il enregistre ces informations dans un fichier CSV grâce à notre classe Gossip ;</li>
  <li>Il redirige l'utilisateur vers la page d'accueil.</li>
</ol>

<p>Une fois que t'as fait ça, on y est : tu as fini le boulot pour la partie "création d'un gossip" et c'est top.</p>
<p> Je ne sais pas si tu te souviens, mais on avait dit que l'on 
aimerait bien afficher tous les potins sur la page d'index. Nous allons 
donc créer une méthode <code>#all</code> pour la classe Gossip qui nous sort tous les gossips, bien rangés dans un array.</p>

<h3>2.5. Afficher l'index des gossips</h3>
<p>Pour avoir un truc propre, on voudrait pouvoir faire <code>Gossip.all</code> et que ça nous ressorte tous les potins dans un bel array. Puis dans la view, j'afficherai chaque gossip avec un truc du genre <code>all_gossips.each { |gossip| #blabla }</code>. Le rêve</p>

<h4>2.5.1. La méthode <code>#all</code></h4>
<p>Une méthode <code>#all</code>, c’est quand même pratique. Cela me 
sort tous les potins au format array, et donc proprement rangés : je 
n'ai plus qu'à m'amuser avec. <br>
En gros, ça retournerait un array du genre <code>array = [gossip_1, gossip_2, etc]</code> avec <code>gossip_1</code> et <code>gossip_2</code> qui sont des objets de type <code>Gossip</code>. Tu pourrais alors faire <code>gossip_1.author</code> pour avoir l'auteur du premier, ou même juste <code>array[0].author</code>. </p>

<p>Pour faire cette méthode <code>all</code>, on va passer sur le fichier <code>gossip.csv</code> puis enregistrer chacune des lignes comme étant un objet <code>Gossip</code> qu'on va ranger dans un array. Et à la fin, on retourne l'array. <br>
Le pseudo-code va donc ressembler à ceci :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>all
  all_gossips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">#on initialise un array vide
</span>
  <span class="token comment"># va chercher chacune des lignes du csv do
</span>    <span class="token comment"># crée un gossip avec les infos de la ligne
</span>    <span class="token comment"># all_gossips &lt;&lt; gossip qui vient d'être créé
</span>  <span class="token comment"># end
</span>
  <span class="token keyword">return</span> all_gossips <span class="token comment">#on retourne un array rempli d'objets Gossip
</span><span class="token keyword">end</span></code></pre>

<p>Je te donne, en exclusivité mondiale, le code de la méthode <code>#all</code> :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>all
  all_gossips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token const">CSV</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"./db/gossip.csv"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>csv_line<span class="token operator">|</span>
    all_gossips &lt;&lt; <span class="token const">Gossip</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>csv_line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> csv_line<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
  <span class="token keyword">return</span> all_gossips
<span class="token keyword">end</span></code></pre>

<p>Et voilà, cette méthode va récupérer chacune des lignes de notre CSV, en fait un objet <code>Gossip</code> avec son <code>author</code> et <code>content</code> puis ressort un array avec tous nos potins. Maintenant il n'y a plus qu'à afficher nos potins dans notre site.</p>

<h4>2.5.2. Afficher tous les gossips dans la vue</h4>
<p>On a un bel array avec tous nos potins, ce qui est cool serait de pouvoir faire une boucle <code>all_gossips.each do</code>
 dans un fichier HTML pour afficher tous les gossips. Figure-toi que 
c'est exactement ce à quoi servent les fichiers ERB : on peut mélanger 
du Ruby avec de l'HTML. De la bombe 💣</p>

<h5>a) Passer une variable à une view (via les routes)</h5>

<p>Pour ceci, il suffit d'utiliser une méthode <code>locals</code>, qui permet d'envoyer à notre fichier ERB des variables que l'on utilisera. Ici on veut lui envoyer l'array obtenu par <code>Gossip.all</code> donc voici ce à quoi devrait ressembler la route pour l'index : </p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  erb <span class="token symbol">:index</span><span class="token punctuation">,</span> locals<span class="token punctuation">:</span> <span class="token punctuation">{</span>gossips<span class="token punctuation">:</span> <span class="token const">Gossip</span><span class="token punctuation">.</span>all<span class="token punctuation">}</span>
<span class="token keyword">end</span></code></pre>

<p>Bien sûr je te laisse créer le fichier <code>index.erb</code> là où il faut.</p>

<h5>b) Utiliser cette variable dans la view</h5>
<p>Quand tu joues avec un string, on peut insérer une variable Ruby dans le string avec <code>#{}</code>. Avec un fichier ERB, on peut faire ceci avec <code>&lt;% %&gt;</code>, ou <code>&lt;%= %&gt;</code>. Pour que tu comprennes la différence, voici le contenu de <code>index.erb</code> qui va afficher tous les potins en HTML:</p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;% gossips<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>gossip<span class="token operator">|</span> %&gt;
        &lt;p&gt;
          &lt;%<span class="token operator">=</span> gossip<span class="token punctuation">.</span>author %&gt;&lt;br<span class="token operator">/</span>&gt;
          &lt;%<span class="token operator">=</span> gossip<span class="token punctuation">.</span>content %&gt;
        &lt;<span class="token operator">/</span>p&gt;
      &lt;% <span class="token keyword">end</span> %&gt;</code></pre>

<p>En fait, <code>&lt;% %&gt;</code> te sert à exécuter du Ruby au sein d'un fichier HTML. Par exemple pour faire un <code>each do</code>.</p>
<p>Par contre <code>&lt;%= %&gt;</code> va te servir à afficher un string Ruby qui est entre ces balises (c'est l'équivalent d'un <code>puts</code> mais sur du HTML).</p>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">⚠️ ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">Tu vas potentiellement avoir un souci si tu appelles <code>.author</code> et <code>.content</code> d'un objet <code>Gossip</code> sans qu'ils soient tous les deux en <code>attr_accessor</code>... As-tu pensé à bien paramétrer ça ?</p>
    </div>
  </div>
</div>

<h3>2.6. La vue show d'un potin</h3>
<p>Bravo, tu as fait une grosse partie du projet et c'est déjà un super 
résultat. Tu peux être fier ! Comme je sens que tu as le niveau, la 
suite sera moins pas à pas et ce sera un peu plus dur. Mais avec les 
bonnes recherches et les bons indices, tu vas cartonner j'en suis sûr 😘</p>
<p>Prochaine étape : afficher tes potins un à un.</p>

<h4>2.6.1. Le principe</h4>

<p>Nous allons faire des pages "profil" pour chaque potin, c’est-à-dire 
que nous allons créer une page par potin afin de l'afficher lui seul. 
C'est ce qu'on appelle un page "show". Quand "index" est une page unique
 qui affiche tous les potins, il existe autant de page "show" que de 
potin.</p>

<p>Nous voudrions faire en sorte que si l'on va sur <a href="http://localhost:4567/gossips/2/" target="_blank">http://localhost:4567/gossips/2/</a>,
 le site nous affiche la page "show" du gossip n°2. Idem avec le numéro 
3, numéro 4, numéro 1, etc. Alors tu imagines bien qu'on peut avoir 10, 
100 voire 1000 potins : on va pas rentrer toutes ces routes à la main, 
même en tentant un <code>.each</code> sur tous les gossips pour faire les routes correspondantes. Pour cela, on va créer dans notre app Sinatra ce qu'on appelle une <b>URL dynamique</b>.</p>

<p>C'est quoi une URL dynamique ? C'est une URL qui contient une 
variable. Au lieu de saisir les routes "gossips/2", "gossips/3", etc. On
 va se débrouiller pour pouvoir saisir une route "gossips/x" et qu'en 
fonction de la valeur de <code>x</code>, notre code s'adapte et affiche ce qu'il faut.</p>

<p>Pour récapituler, nous allons :</p>
<ol>
  <li>Créer une route dynamique pour qu'à chaque fois qu'un utilisateur rentre une URL du type <a href="http://localhost:4567/gossips/x/" target="_blank">http://localhost:4567/gossips/x/</a>, Sinatra comprenne que l'on veut voir la page show du potin N°x en BDD ;</li>
  <li>Récupérer dans notre BDD le potin N°x avec une belle méthode <code>#find</code> ;</li>
  <li>Afficher le contenu du potin dans la page show.</li>
</ol>

<h4>2.6.2. Les routes dynamiques</h4>
<p>Pour éviter d'avoir à rentrer à la main une route pour chaque potin, 
il existe une méthode pour avoir des URLs dynamiques. Pour ceci, je 
t'invite à regarder <a href="http://sinatrarb.com/intro.html" target="_blank">la documentation d'introduction de Sinatra</a>
 qui explique comment faire ses routes. Voici l'exemple qu'elle propose 
afin de rajouter, au sein d'une route, une variable (par exemple <code>:name</code>) :</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/hello/:name'</span> <span class="token keyword">do</span>
  <span class="token comment"># matches "GET /hello/foo" and "GET /hello/bar"
</span>  <span class="token comment"># params['name'] is 'foo' or 'bar'
</span>  "<span class="token const">Hello</span> <span class="token comment">#{params['name']}!"
</span><span class="token keyword">end</span></code></pre>

<p>Si tu suis bien, la valeur de <code>:name</code> (saisie par l'utilisateur dans l'URL) sera alors accessible dans le hash <code>params</code> sous <code>params['name']</code>.</p>

<p>Essaye d'implémenter cet exemple ci-dessus dans ton application Sinatra. Ton objectif est que quand on va <a href="http://localhost:4567/gossips/2/" target="_blank">http://localhost:4567/gossips/2/</a>,
 le serveur Sinatra t'affiche (en HTML ou sur le terminal, peu importe) :
 "Voici le numéro du potin que tu veux : 2 !". Idem si on remplace le <code>2</code> par n'importe quelle valeur (ça doit marcher avec "coucou" ou autre). <br>
Seule consigne : ta variable d'URL doit s'appeler <code>:id</code> (et pas <code>:name</code>) car elle correspondra à l'<code>id</code> du gossip qu'on veut afficher.</p>

<p>Pour les routes dynamiques, mon conseil est de "tester plus de choses
 en mettant des puts partout". Aide-toi de la communauté et essaie les 
solutions qui te semblent bien. Le métier de développeur est ceci la 
plupart du temps : essayer des trucs, et voir si c'est ce que tu veux 
faire.</p>

<h4>2.6.3. Find</h4>
<p>Maintenant que nous avons notre <code>id</code>, nous voudrions faire un truc comme <code>Gossip.find(id)</code> et cela nous ressortirait le bon gossip (celui qui est numéro <code>id</code> dans la base de données). Eh bien je t'invite à ouvrir le fichier <code>gossip.rb</code> et d'ajouter une méthode <code>#find</code>,
 qui prend un paramètre, et qui ressort le gossip correspondant. La 
beauté du code n'a pas d'importance, étant donné que nous allons voir 
SQL très vite, et ce sera plus simple pour le faire.</p>

<p>Une fois que, dans ton fichier <code>controller.rb</code>, le code <code>Gossip.find(id)</code> te ressort le bon potin. Utilise donc cette ligne dans la route dynamique de ton show <code>get 'gossips/:id'</code>.</p>

<p>Te voilà prêt à l'afficher le potin dans ta view !</p>

<h4>2.6.4. La vue show du potin</h4>
<p>Nous voudrions afficher une page du genre :</p>
<pre class=" language-ruby"><code class=" language-ruby"><span class="token const">PAGE</span> <span class="token const">POTIN</span>
<span class="token const">Voici</span> la page du potin n°<span class="token const">X</span>
<span class="token const">Son</span> auteur <span class="token punctuation">:</span> <span class="token operator">==</span>author<span class="token operator">==</span>
<span class="token const">Le</span> contenu du potin <span class="token punctuation">:</span> <span class="token operator">==</span>content<span class="token operator">==</span>

<span class="token const">Lien</span> pour revenir à la page des potins</code></pre>

<p>Pour faire ça, tu as tous les outils à présent (inspire-toi de ce qu'on a fait avec index) ! Il te faut créer un page <code>show.erb</code>, lui passer le potin, et ensuite jouer avec les balises <code>&lt;%= %&gt;</code> dans ton HTML. Et à toi la gloire ❤️</p>

<h4>2.6.5. Pour finir : le lien</h4>
<p>Pour finir, voici la dernière requête : dans la page d'index, ce 
serait bien que chaque potin affiché porte un lien vers sa propre page 
show. Voici les quelques conseils pour y arriver :</p>
<ul>
  <li><code>#each_with_index</code> est ton amie</li>
  <li><code>&lt;%= %&gt;</code> pour les URLs aussi</li>
</ul>

<h3>2.7. Éditer un potin</h3>
<p>Ok, si t'es arrivé jusqu'ici, c'est que t'es chaud aujourd'hui ! On 
va corser tout ça en étant encore moins pas à pas... Pas de honte si tu 
n'arrives pas au bout de cette partie !</p>
<p>Nos potins sont géniaux, mais ce serait bien de pouvoir les éditer : </p>
<ul>
  <li>Le concept : à partir de la view show, un utilisateur peut cliquer sur un lien "éditer le potin" qui renvoie sur une view <code>edit.erb</code> dont l'adresse est <code>/gossips/id/edit/</code>.</li>
  <li>Sur cette page d'edit, tu dois y mettre un formulaire qui permet 
d'éditer le potin. Si tu n'es pas inspiré, tu peux reprendre le même que
 celui de la page new.</li>
  <li>Ce formulaire va envoyer une requête en POST qui déclenche ensuite une méthode <code>#update</code> de la classe <code>Gossip</code>. Cette méthode va mettre à jour le potin en base de données.</li>
</ul>

<h3>2.8. Les commentaires de potins</h3>
<p>Allez, un petit dernier exercice (pour les plus à l'aise) avant de 
clore la journée. Ce serait bien de pouvoir commenter les potins, via 
des commentaires. En gros, la page show du potin devra afficher les 
commentaires, qui seront juste des textes. Un potin peut avoir 0, 1, ou n
 commentaires. Un commentaire ne concerne qu'un seul potin, c’est-à-dire
 que la page show du potin ne devra afficher que les commentaires du 
potin concerné.</p>

<p>De la vue show, il est possible créer un commentaire avec un simple formulaire.</p>

<p>Cet exercice n'est pas facile, et il existe plein de solutions 
différentes. Je te laisse voir avec ton équipe laquelle vous allez 
opter. Je vous invite à réfléchir au comment, avant de partir tête 
baissée dans le code.</p>

<h3>3. Rendu attendu </h3>
<p>Un repo par personne avec l'ensemble de ton application Sinatra (BDD 
comprise) et un README qui explique jusqu'où tu as pu aller dans le 
projet.</p>

<h4>3.1. Quelques mots pour finir</h4>
<h5>Bravo !</h5>
<p>Waow ! Tu as fait ta première application web : pour la première 
fois, tu allies du Ruby en back-end et des pages en HTML en front ! 
C'est quand même impressionnant, surtout quand tu penses qu'il y a 
quelque temps, tes programmes lançaient juste des pyramides de Mario ! 
Évidemment, il y a toujours moyen d'aller plus loin dans l'application, 
et il y a encore un peu de chemin avant de faire le prochain Airbnb. 
Mais le début est là et tu as vu les bases pour comprendre comment une 
application web marche.</p>


<h5>Les limites de ton app : la base de données</h5>
<p>Même si tu n'es pas arrivé jusqu'au dernier exercice des 
commentaires, lis-le rapidement et pose-toi la question "comment 
aurais-je fais ?". Très vite tu vas réaliser qu'il est particulièrement 
ardu de lier les commentaires au potin avec un CSV/JSON. Imagine 
maintenant la galère que ce sera de lier les potins aux utilisateurs 
enregistrés dans l'application ! C'est pour ça qu'à partir de demain et 
pour le reste de la semaine, nous allons voir ensemble comment faire des
 bases de données solides, en utilisant SQL puis ActiveRecords (sur 
Rails).</p>

<p>Quand on fait une application, il est important de savoir construire 
une base de données robuste et utilisable. Aussi nous allons passer du 
temps sur ce sujet afin que tu puisses t'attaquer à des sites complexes 
dans les meilleures conditions possibles.</p>


<h5>Les limites de ton app : Sinatra et son bas-niveau</h5>
<p>Sinatra est un super outil pour comprendre, en venant de Ruby, 
comment une application simple fonctionne. Son défaut est qu'il est très
 bas-niveau, et tu te retrouves à faire pas mal de plomberie : tu crées 
chaque fichier, chaque dossier, tu écris les routes de A à Z, etc. 
Regarde tous les branchements que tu as dû faire pour ton application, 
qui était pourtant très simple !</p>

<p>Un autre exemple est ton fichier <code>controller.rb</code> : si tu voulais faire un AirBnb-like, il deviendrait rapidement trop grand et impossible à maintenir. Idem pour le dossier <code>lib/</code> qui contiendrait trop de fichiers différents. </p>

<p>C'est bien de tout maîtriser, mais parfois, il est plus préférable 
d'avancer plus vite en laissant certaines choses s'automatiser. Sinatra 
est bien pour comprendre l'univers du web, mais quand on débute 
l'informatique, tu verras qu'il est ultra agréable de pouvoir s'appuyer 
sur des outils comme Rails qui te mâche le travail de base.</p>
</div>
</div>
</div>
</div>
</div>
</div>

</div>

      </div>
    </div>

    <div class="thp-flashes"></div>



    <script src="s5j1_fichiers/dashboard-6681459c92372465340c.js"></script>
    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  

<iframe style="display: none; visibility: hidden;" owner="archetype" title="archetype"></iframe>
<script type="text/javascript" id="hs-script-loader" src="s5j1_fichiers/9310539.js"></script><script type="text/javascript" id="">(function(e,c){if(!c.__SV){var l,h;window.mixpanel=c;c._i=[];c.init=function(q,r,f){function t(d,a){var g=a.split(".");2==g.length&&(d=d[g[0]],a=g[1]);d[a]=function(){d.push([a].concat(Array.prototype.slice.call(arguments,0)))}}var b=c;"undefined"!==typeof f?b=c[f]=[]:f="mixpanel";b.people=b.people||[];b.toString=function(d){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);d||(a+=" (stub)");return a};b.people.toString=function(){return b.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<l.length;h++)t(b,l[h]);var n="set set_once union unset remove delete".split(" ");b.get_group=function(){function d(p){a[p]=function(){call2_args=arguments;call2=[p].concat(Array.prototype.slice.call(call2_args,0));b.push([g,call2])}}for(var a={},g=["get_group"].concat(Array.prototype.slice.call(arguments,0)),m=0;m<n.length;m++)d(n[m]);return a};c._i.push([q,r,f])};c.__SV=1.2;var k=e.createElement("script");k.type="text/javascript";k.async=!0;k.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=e.getElementsByTagName("script")[0];e.parentNode.insertBefore(k,e)}})(document,window.mixpanel||[]);mixpanel.init("ab79c62023f2a925bfe5f7922c70de67");mixpanel.track("Sign up");</script>
<script type="text/javascript" id="">!function(){var a=window.analytics=window.analytics||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0;a.methods="trackSubmit trackClick trackLink trackForm pageview identify reset group track ready alias debug page once off on addSourceMiddleware addIntegrationMiddleware setAnonymousId addDestinationMiddleware".split(" ");a.factory=function(b){return function(){var c=Array.prototype.slice.call(arguments);c.unshift(b);
a.push(c);return a}};for(var e=0;e<a.methods.length;e++){var f=a.methods[e];a[f]=a.factory(f)}a.load=function(b,c){var d=document.createElement("script");d.type="text/javascript";d.async=!0;d.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(d,b);a._loadOptions=c};a._writeKey="HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j";a.SNIPPET_VERSION="4.13.2";a.load("HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j");a.page()}}();</script>

</body></html>