<!DOCTYPE html>
<html class="loaded" lang="fr"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="s5j1_fichiers/NRJS-71f55aa980e498e276b"></script><script type="text/javascript" async="" src="s5j1_fichiers/insight.js"></script><script src="s5j1_fichiers/nr-1212.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/gtm_002.js"></script><script type="text/javascript" src="s5j1_fichiers/commons.js" async="" status="loaded"></script><script type="text/javascript" src="s5j1_fichiers/google-tag-manager.js" async="" status="loaded"></script><script type="text/javascript" async="" src="s5j1_fichiers/analytics.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/mixpanel-2-latest.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/conversion_async.js"></script><script type="text/javascript" async="" src="s5j1_fichiers/analytics_002.js"></script><script src="s5j1_fichiers/conversations-embed.js" type="text/javascript" id="hubspot-messages-loader" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/9310539_003.js" type="text/javascript" id="hs-analytics"></script><script src="s5j1_fichiers/9310539_002.js" type="text/javascript" id="cookieBanner-9310539" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/fb.js" type="text/javascript" id="hs-ads-pixel-9310539" data-ads-portal-id="9310539" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/collectedforms.js" type="text/javascript" id="CollectedForms-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s5j1_fichiers/leadflows.js" type="text/javascript" id="LeadFlows-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script async="" crossorigin="anonymous" src="s5j1_fichiers/fs.js"></script><script src="s5j1_fichiers/773401719499556.js" async=""></script><script async="" src="s5j1_fichiers/fbevents.js"></script><script async="" src="s5j1_fichiers/gtm.js"></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"NRJS-71f55aa980e498e276b","applicationID":"576835834","transactionName":"dgpYEBRYDg9XQh8AA0YNVAsHRQZMVlFJF01GDVkT","queueTime":0,"applicationTime":149,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-71f55aa980e498e276b",applicationID:"576835834"};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var i=e[n]={exports:{}};t[n][0].call(i.exports,function(e){var i=t[n][1][e];return r(i||e)},i,i.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,n){function r(){}function i(t,e,n,r){return function(){return s.recordSupportability("API/"+e+"/called"),o(t+e,[u.now()].concat(c(arguments)),n?null:this,r),n?void 0:this}}var o=t("handle"),a=t(10),c=t(11),f=t("ee").get("tracer"),u=t("loader"),s=t(4),d=NREUM;"undefined"==typeof window.newrelic&&(newrelic=d);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",v=l+"ixn-";a(p,function(t,e){d[e]=i(l,e,!0,"api")}),d.addPageAction=i(l,"addPageAction",!0),d.setCurrentRouteName=i(l,"routeName",!0),e.exports=newrelic,d.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(t,e){var n={},r=this,i="function"==typeof e;return o(v+"tracer",[u.now(),t,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return e.apply(this,arguments)}catch(t){throw f.emit("fn-err",[arguments,this,t],n),t}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){m[e]=i(v,e)}),newrelic.noticeError=function(t,e){"string"==typeof t&&(t=new Error(t)),s.recordSupportability("API/noticeError/called"),o("err",[t,u.now(),!1,e])}},{}],2:[function(t,e,n){function r(t){if(NREUM.init){for(var e=NREUM.init,n=t.split("."),r=0;r<n.length-1;r++)if(e=e[n[r]],"object"!=typeof e)return;return e=e[n[n.length-1]]}}e.exports={getConfiguration:r}},{}],3:[function(t,e,n){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}catch(o){}e.exports=function(t){return r?{passive:!0,capture:!!t}:!!t}},{}],4:[function(t,e,n){function r(t,e){var n=[a,t,{name:t},e];return o("storeMetric",n,null,"api"),n}function i(t,e){var n=[c,t,{name:t},e];return o("storeEventMetrics",n,null,"api"),n}var o=t("handle"),a="sm",c="cm";e.exports={constants:{SUPPORTABILITY_METRIC:a,CUSTOM_METRIC:c},recordSupportability:r,recordCustom:i}},{}],5:[function(t,e,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=t(12);e.exports=r,e.exports.offset=a,e.exports.getLastTimestamp=i},{}],6:[function(t,e,n){function r(t){return!(!t||!t.protocol||"file:"===t.protocol)}e.exports=r},{}],7:[function(t,e,n){function r(t,e){var n=t.getEntries();n.forEach(function(t){"first-paint"===t.name?p("timing",["fp",Math.floor(t.startTime)]):"first-contentful-paint"===t.name&&p("timing",["fcp",Math.floor(t.startTime)])})}function i(t,e){var n=t.getEntries();if(n.length>0){var r=n[n.length-1];if(f&&f<r.startTime)return;p("lcp",[r])}}function o(t){t.getEntries().forEach(function(t){t.hadRecentInput||p("cls",[t])})}function a(t){if(t instanceof g&&!y){var e=Math.round(t.timeStamp),n={type:t.type};e<=l.now()?n.fid=l.now()-e:e>l.offset&&e<=Date.now()?(e-=l.offset,n.fid=l.now()-e):e=l.now(),y=!0,p("timing",["fi",e,n])}}function c(t){"hidden"===t&&(f=l.now(),p("pageHide",[f]))}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d,p=t("handle"),l=t("loader"),v=t(9),m=t(3),g=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){u=new PerformanceObserver(r);try{u.observe({entryTypes:["paint"]})}catch(h){}s=new PerformanceObserver(i);try{s.observe({entryTypes:["largest-contentful-paint"]})}catch(h){}d=new PerformanceObserver(o);try{d.observe({type:"layout-shift",buffered:!0})}catch(h){}}if("addEventListener"in document){var y=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(t){document.addEventListener(t,a,m(!1))})}v(c)}},{}],8:[function(t,e,n){function r(t,e){if(!i)return!1;if(t!==i)return!1;if(!e)return!0;if(!o)return!1;for(var n=o.split("."),r=e.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}e.exports={agent:i,version:o,match:r}},{}],9:[function(t,e,n){function r(t){function e(){t(c&&document[c]?document[c]:document[o]?"hidden":"visible")}"addEventListener"in document&&a&&document.addEventListener(a,e,i(!1))}var i=t(3);e.exports=r;var o,a,c;"undefined"!=typeof document.hidden?(o="hidden",a="visibilitychange",c="visibilityState"):"undefined"!=typeof document.msHidden?(o="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(o="webkitHidden",a="webkitvisibilitychange",c="webkitVisibilityState")},{}],10:[function(t,e,n){function r(t,e){var n=[],r="",o=0;for(r in t)i.call(t,r)&&(n[o]=e(r,t[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],11:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(i<0?0:i);++r<i;)o[r]=t[e+r];return o}e.exports=r},{}],12:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(t,e,n){function r(){}function i(t){function e(t){return t&&t instanceof r?t:t?u(t,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){t&&a&&t(n,r,i);for(var c=e(i),f=m(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[w[n]];return p&&p.push([b,n,r,c]),c}}function o(t,e){y[t]=m(t).concat(e)}function v(t,e){var n=y[t];if(n)for(var r=0;r<n.length;r++)n[r]===e&&n.splice(r,1)}function m(t){return y[t]||[]}function g(t){return p[t]=p[t]||i(n)}function h(t,e){l.aborted||s(t,function(t,n){e=e||"feature",w[n]=e,e in d||(d[e]=[])})}var y={},w={},b={on:o,addEventListener:o,removeEventListener:v,emit:n,get:g,listeners:m,context:e,buffer:h,abort:c,aborted:!1};return b}function o(t){return u(t,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=t("gos"),s=t(10),d={},p={},l=e.exports=i();e.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(t,e,n){function r(t,e,n){if(i.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return t[e]=r,r}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){i.buffer([t],r),i.emit(t,e,n)}var i=t("ee").get("handle");e.exports=r,r.ee=i},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,o,function(){return i++})}var i=1,o="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!T++){var t=P.info=NREUM.info,e=g.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(O,function(e,n){t[e]||(t[e]=n)});var n=a();c("mark",["onload",n+P.offset],null,"api"),c("timing",["load",n]);var r=g.createElement("script");0===t.agent.indexOf("http://")||0===t.agent.indexOf("https://")?r.src=t.agent:r.src=v+"://"+t.agent,e.parentNode.insertBefore(r,e)}}function i(){"complete"===g.readyState&&o()}function o(){c("mark",["domContent",a()+P.offset],null,"api")}var a=t(5),c=t("handle"),f=t(10),u=t("ee"),s=t(8),d=t(6),p=t(2),l=t(3),v=p.getConfiguration("ssl")===!1?"http":"https",m=window,g=m.document,h="addEventListener",y="attachEvent",w=m.XMLHttpRequest,b=w&&w.prototype,E=!d(m.location);NREUM.o={ST:setTimeout,SI:m.setImmediate,CT:clearTimeout,XHR:w,REQ:m.Request,EV:m.Event,PR:m.Promise,MO:m.MutationObserver};var x=""+location,O={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1212.min.js"},M=w&&b&&b[h]&&!/CriOS/.test(navigator.userAgent),P=e.exports={offset:a.getLastTimestamp(),now:a,origin:x,features:{},xhrWrappable:M,userAgent:s,disabled:E};if(!E){t(1),t(7),g[h]?(g[h]("DOMContentLoaded",o,l(!1)),m[h]("load",r,l(!1))):(g[y]("onreadystatechange",i),m[y]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var T=0}},{}],"wrap-function":[function(t,e,n){function r(t,e){function n(e,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],t)}c(n+"start",[o,a,f],s,u);try{return p=e.apply(a,o)}catch(v){throw c(n+"err",[o,a,v],s,u),v}finally{c(n+"end",[o,a,p],s,u)}}return a(e)?e:(n||(n=""),nrWrapper[p]=e,o(e,nrWrapper,t),nrWrapper)}function r(t,e,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<e.length;u++)f=e[u],c=t[f],a(c)||(t[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!v||e){var c=v;v=!0;try{t.emit(n,r,o,e,a)}catch(f){i([f,n,r,o],t)}v=c}}return t||(t=s),n.inPlace=r,n.flag=p,n}function i(t,e){e||(e=s);try{e.emit("internal-error",t)}catch(n){}}function o(t,e,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(t);return r.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(o){i([o],n)}for(var a in t)l.call(t,a)&&(e[a]=t[a]);return e}function a(t){return!(t&&t instanceof Function&&t.apply&&!t[p])}function c(t,e){var n=e(t);return n[p]=t,o(t,n,s),n}function f(t,e,n){var r=t[e];t[e]=c(r,n)}function u(){for(var t=arguments.length,e=new Array(t),n=0;n<t;++n)e[n]=arguments[n];return e}var s=t("ee"),d=t(11),p="nr@original",l=Object.prototype.hasOwnProperty,v=!1;e.exports=r,e.exports.wrapFunction=c,e.exports.wrapInPlace=f,e.exports.argsToArray=u},{}]},{},["loader"]);</script>
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="+eE6ma6MY3DZx7OxAks5TQ2DVJspzDqy/65JVWjJ/NmKcRS9AWw0QRGWxWDCWoDRqd2nrQdt3/XmCQ5hIZ9YRQ==">
    <title>Le tableau de bord | The Hacking Project</title>
<meta name="description" content="Nous cassons les codes de l'√©ducation, vous apprenez d'o√π vous voulez, en communaut√©.">
<meta name="robots" content="noindex, nofollow">
<meta property="og:title" content="Le tableau de bord">
<meta property="og:site_name" content="The Hacking Project">
<meta name="url" content="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/1">
<meta name="image" content="https://www.thehackingproject.org/packs/images/logo/20210910-THP-Logo_color_transparent-31229dd881904e010092de63be97cdfa.png">


    <link rel="apple-touch-icon" sizes="180x180" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-c01aaccf467f7cc3d79bbce743d60779f5b833fdc4500cebd07a5e11a07a5c31.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-precomposed-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.thehackingproject.org/assets/favicon/favicon-32x32-804b12d1c41c60fe721477b7c3b0a32811dc610580dd40ac92f1cc04cbd05ca4.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.thehackingproject.org/assets/favicon/favicon-16x16-d96ba65e5785d32474df9ebc6fbfd5442c751d527b10981a474bc3b7a4079d01.png">
<link rel="manifest" href="https://www.thehackingproject.org/assets/favicon/manifest-cf975201fd8ac78a1f1a203357573d50031f1cc33436d099743df6428b8a38a2.json">
<link rel="mask-icon" href="https://www.thehackingproject.org/assets/favicon/safari-pinned-tab-8af1cfcf7525ccdccb490f9f5adad396653a4969b419e0a9a9d3a1088140a912.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://www.thehackingproject.org/assets/favicon/favicon-cbf10361dc90b277565960736d4897fddef5468bff6299811ea9498459d56d21.ico">
<meta name="msapplication-config" content="/assets/favicon/browserconfig-dab38db6040ef54ac56e91fdd77e3d7b06746a634e87b68c99b59b216cb8611a.xml">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" media="screen" href="s5j1_fichiers/vendor-dab9e12f0ba58215899de05f149caa5f.css">
    <link rel="stylesheet" media="screen" href="s5j1_fichiers/dashboard-4ab6ba9737cbfc4c38b17a9a4de7833a.css">
    <link rel="stylesheet" media="screen" href="s5j1_fichiers/dashboard-ea5a94b9045ccb8d8ce8974b71b640603915dc183d5907c643.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="s5j1_fichiers/js.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-105991867-1');
  </script>
<!-- End Google Analytics -->

<!-- Google Tag Manager -->
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-P8XRQ3M");
</script>
<!-- End Google Tag Manager -->

<!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
         fbq('init', '773401719499556');
        fbq('track', 'PageView');
    </script>
    <noscript>
     <img height="1" width="1"
    src="https://www.facebook.com/tr?id=773401719499556&ev=PageView
    &noscript=1"/>
    </noscript>
<!-- End Facebook Pixel Code -->

<script>
window['_fs_debug'] = false;
window['_fs_host'] = 'fullstory.com';
window['_fs_script'] = 'edge.fullstory.com/s/fs.js';
window['_fs_org'] = '14AEET';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
    g=m[e]=function(a,b,s){g.q?g.q.push([a,b,s]):g._api(a,b,s);};g.q=[];
    o=n.createElement(t);o.async=1;o.crossOrigin='anonymous';o.src='https://'+_fs_script;
    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
    g.identify=function(i,v,s){g(l,{uid:i},s);if(v)g(l,v,s)};g.setUserVars=function(v,s){g(l,v,s)};g.event=function(i,v,s){g('event',{n:i,p:v},s)};
    g.anonymize=function(){g.identify(!!0)};
    g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
    g.log = function(a,b){g("log",[a,b])};
    g.consent=function(a){g("consent",!arguments.length||a)};
    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
    g.clearUserCookie=function(){};
    g.setVars=function(n, p){g('setVars',[n,p]);};
    g._w={};y='XMLHttpRequest';g._w[y]=m[y];y='fetch';g._w[y]=m[y];
    if(m[y])m[y]=function(){return g._w[y].apply(this,arguments)};
    g._v="1.3.0";
})(window,document,window['_fs_namespace'],'script','user');
</script>
<!-- Start of HubSpot Embed Code -->
<script async="" defer="defer" id="hs-script-loader" src="s5j1_fichiers/9310539.js" type="text/javascript"></script>
<!-- End of HubSpot Embed Code -->


    <script src="s5j1_fichiers/thp-3cc5aa6fdf57842a7b6c714621cc7f2d3d31b51cb700b1de4e795d773.js"></script>
    <script src="s5j1_fichiers/manifest-1613feea780cfc5342f4.js"></script>
    <script src="s5j1_fichiers/vendor-ff3cb5540e737de52c97.js"></script>
    <script src="s5j1_fichiers/dashboard-25875e14460b4458b1bccffaa93d4a8cbee9691b06d54976fde.js"></script>

    <link href="s5j1_fichiers/css.css" rel="stylesheet">
  <script src="s5j1_fichiers/a"></script></head>

  <body class="vertical-layout 2-columns fixed-navbar menu-hide vertical-overlay-menu" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns" data-thp-controller="days" data-thp-action="show" data-thp-layout="dashboard"><style type="text/css">html.hs-messages-widget-open.hs-messages-mobile,html.hs-messages-widget-open.hs-messages-mobile body{overflow:hidden!important;position:relative!important}html.hs-messages-widget-open.hs-messages-mobile body{height:100%!important;margin:0!important}#hubspot-messages-iframe-container{display:initial!important;z-index:2147483647;position:fixed!important;bottom:0!important}#hubspot-messages-iframe-container.widget-align-left{left:0!important}#hubspot-messages-iframe-container.widget-align-right{right:0!important}#hubspot-messages-iframe-container.internal{z-index:1016}#hubspot-messages-iframe-container.internal iframe{min-width:108px}#hubspot-messages-iframe-container .shadow-container{display:initial!important;z-index:-1;position:absolute;width:0;height:0;bottom:0;content:""}#hubspot-messages-iframe-container .shadow-container.internal{display:none!important}#hubspot-messages-iframe-container .shadow-container.active{width:400px;height:400px}#hubspot-messages-iframe-container iframe{display:initial!important;width:100%!important;height:100%!important;border:none!important;position:absolute!important;bottom:0!important;right:0!important;background:transparent!important}</style>
    <!-- Google Tag Manager (noscript) -->
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-P8XRQ3M' style='display:none;visibility:hidden' width='0'></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->



    <nav class="header-navbar navbar-expand-md navbar navbar-with-menu navbar-without-dd-arrow fixed-top navbar-semi-light" style="padding:0;">
<div class="navbar-wrapper">
<div class="navbar-container content">
<div class="collapse navbar-collapse show" id="navbar-mobile">
<ul class="nav navbar-nav mr-auto float-left">
<li class="nav-item mobile-menu d-md-none mr-auto">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu font-large-1"></i>
</a>
</li>
<li class="nav-item d-none d-md-block">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu"></i>
</a>
</li>
</ul>
<ul class="nav navbar-nav float-right">
<li class="dropdown dropdown-user nav-item">
<a class="dropdown-toggle nav-link dropdown-user-link" data-toggle="dropdown" href="#">
<span class="avatar avatar-online">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s5j1_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
</a>
<div class="dropdown-menu dropdown-menu-right">
<div class="arrow_box_right">
<a class="dropdown-toggle nav-link dropdown-user-link" href="https://www.thehackingproject.org/fr/dashboard/profile/user"><span class="avatar avatar-online pt-0">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s5j1_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
<span class="user-name text-bold-700 ml-1 text-dark">
Lucie
</span>
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit"><i class="ft-edit"></i>√âditer profil
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit?edit=danger"><i class="ft-alert-triangle"></i>Zone √† risques
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" rel="nofollow" data-method="delete" href="https://www.thehackingproject.org/users/sign_out?locale=fr"><i class="ft-power"></i>
D√©connexion
</a></div>
</div>
</li>
</ul>
</div>
</div>
</div>
</nav>

      <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true">
<div class="navbar-header">
<ul class="nav navbar-nav flex-row">
<li class="nav-item mr-auto">
<a class="navbar-brand" href="https://www.thehackingproject.org/?locale=fr"><h3 class="brand-text">The Hacking Project</h3>
</a></li>
<li class="nav-item d-md-none">
<a class="nav-link close-navbar">
<i class="ft-x"></i>
</a>
</li>
</ul>
</div>
<div class="main-menu-content">
<ul class="navigation navigation-main" data-menu="menu-navigation" id="main-menu-navigation">
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard"><i class="ft-calendar"></i>
<span class="menu-title" data-i18n="">
Aujourd'hui
</span>
</a></li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard"><i class="ft-monitor"></i>
<span class="menu-title" data-i18n="">
Mon dashboard
</span>
</a></li>
<li class="nav-item has-sub">
<a href="#"><i class="fas fa-user-graduate"></i>
<span class="menu-title" data-i18n="">
Mon inscription
</span>
</a><ul class="menu-content">
<li>
<a href="https://www.thehackingproject.org/parcours?locale=fr">Choisir un parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/new">Nouveau parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/7209/edit">Changer parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/modalites">Modalit√©s</a>
</li>
</ul>
</li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/certifications"><i class="fa ft-download"></i>
<span class="menu-title" data-i18n="">
Documents
</span>
</a></li>
<br>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/help"><i class="fa ft-help-circle"></i>
<span class="menu-title" data-i18n="">
Aide
</span>
</a></li>
</ul>
</div>
</div>



    <div class="app-content content">
      <div class="content-wrapper">
        <div class="content-wrapper-before"></div>
        <div class="content-header row"></div>
        <div class="container">
<div class="row">
<div class="col-12">
<ol class="breadcrumb">
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard">Dashboard</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1">Fullstack web</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2">Initiation √† Rails</a>
</li>
<li class="breadcrumb-item active">
Franck Sinatra
</li>
</ol>
</div>
</div>
<!-- / PARTIAL FOR FREE MOUSSES -->
<!-- / PARTIAL FOR NEXT -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-body">
<div class="row">
<div class="col-12 col-xl-12 text-center mb-3">
<h2 class="mb-2">
Initiation √† Rails
</h2>
<h3>
<i class="ft-check-square success" data-placement="top" data-toggle="tooltip" title="" data-original-title="Projet bien re√ßu !"></i>
Franck Sinatra
</h3>
<h4>
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

</h4>
<h5>
Nous allons voir un framework minimaliste de Ruby pour faire du web : 
Sinatra. Sinatra est bien plus bas-niveau que Rails, et voir ce 
framework en premier te donnera les bases pour comprendre le web.
Dans l'apr√®s midi, les ateliers t'apprendront √† faire des trucs bien 
coolos.
</h5>
</div>
<div class="col-12 col-xl-12 timeline-left" id="activity">
<div class="timeline pt-2">
<ul class="list-unstyled base-timeline activity-timeline">
<li>
<div class="timeline-icon bg-primary">
<i class="ft-map-pin font-medium-1"></i>
</div>
<div class="act-time">
Lundi
</div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

Franck Sinatra
</div>
</div>
<small class="text-muted">
Nous allons voir un framework minimaliste de Ruby pour faire du web : 
Sinatra. Sinatra est bien plus bas-niveau que Rails, et voir ce 
framework en premier te donnera les bases pour comprendre le web.
Dans l'apr√®s midi, les ateliers t'apprendront √† faire des trucs bien 
coolos.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/2"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/2">Mardi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journ√©e l√†"></i>

D√©couverte de SQL
</div>
</div>
<small class="text-muted">
Pour ce premier jour, tu verras l'univers des bases de donn√©es, comment 
cr√©er ta premi√®re base de donn√©es, comment la concevoir, puis comment 
int√©ragir avec une base de donn√©es.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/3"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/3">Mercredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">

Passage de SQL √† ActiveRecord
</div>
</div>
<small class="text-muted">
Nous allons voir comment utiliser ActiveRecord pour se simplifier la vie
 avec les bases de donn√©es. C‚Äôest √©galement le pont entre le SQL et le 
Ruby
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/4"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/4">Jeudi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

Relations entre BDD
</div>
</div>
<small class="text-muted">
Comment faire en sorte qu'un docteur puisse avoir plusieurs patients et 
que les patients puissent avoir plusieurs docteurs ? Gr√¢ce aux relations
 entre bases de donn√©es, bien entendu !
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/5"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/2/days/5">Vendredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journ√©e l√†"></i>

Validations &amp; Conceptions de BDD
</div>
</div>
<small class="text-muted">
Et allez encore des bases de donn√©es üòé
</small>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Les fameuses corrections qui n'arrivent que les jours concern√©s -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #5E66E5">
<h1>
Ressource : 
Sinatra
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/lessons/23/lesson_submissions/new"><i class="ft-edit" data-original-title="Proposer une am√©lioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>Dans cette ressource, nous allons te montrer comment travailler avec 
Sinatra, un framework Ruby con√ßu pour coder des applications web. C'est 
un framework plus bas-niveau que Ruby on Rails (= une ligne de Rails = 3
 lignes en Sinatra) et c'est parfait au d√©but pour comprendre les 
rouages d'une application web. Par contre on ne l'utilisera pas 
longtemps car Sinatra te fait r√©inventer la roue.</p>

<p>Sinatra se pr√©sente tout simplement sous la forme d'une gem (tout comme Rails).</p>

<p>Objectif de la journ√©e : te pr√©senter les grands concepts qui vont 
t'accompagner tout au long de ton apprentissage de Rails. Cela inclus 
l'utilisation d'un serveur local, l'archi MVC, les routes, les views, 
les BDD, l'utilisation de formulaires, etc.</p>

<p> Allez Sinatra, Fly me to the moon üöÄ !</p>


<h2>2. Historique et contexte</h2>
<p>Sinatra est une biblioth√®que Ruby open source qui permet de faire des
 applications web. Elle a √©t√© cr√©√©e en 2007 (donc deux ans apr√®s Rails) 
par un certain Blake Mizerany dans le but de cr√©er des applications, en 
mode ultra minimal, sans effort. Sinatra ne suit pas le mod√®le MVC : il 
laisse les utilisateurs faire un choix d'architecture logicielle web.</p>

<p>Et sinon : "oui". Sinatra est nomm√©e ainsi √† cause de Frank Sinatra üé§ ‚òî</p>

<h2>3. La ressource</h2>

<p>On va construire ensemble une application ultra basique qui te permettra de d√©couvrir le fonctionnement de Sinatra.</p>

<p>Une grosse fonctionnalit√© de Sinatra est de <b>pouvoir lancer un serveur local (sur ton ordi) en Ruby</b>.
 Le r√¥le d'un serveur c'est, grosso modo, de recevoir des requ√™tes HTTP 
et de retourner en r√©ponse des fichiers (HTML, CSS, JS, etc.). Par 
exemple si tu vas sur https://www.facebook.com/, le serveur de Facebook 
va faire "H√© j'ai re√ßu une requ√™te de type GET sur ma page portant l'URL
 '/'. Je vais donc renvoyer le code HTML et CSS qui correspond !". Et l√†
 il va te balancer ce qu'il faut pour afficher la page d'accueil de 
Facebook.</p>

<p>Pour ton info, sache que sur le web, certaines requ√™tes peuvent 
donner lieu √† l'envoi d'autres formats que des fichiers HTML ou CSS. Par
 exemple si tu vas sur <a href="http://www.omdbapi.com/?t=pulp+fiction&amp;apikey=5c030292" target="_blank">ce lien</a>, tu vas voir dans le code source que le site t'a renvoy√© un JSON.</p>

<p>Bref, quand tu vas sur facebook.com, une page s'affiche sur ton 
navigateur web, car ce dernier sait interpr√©ter les fichiers HTML/CSS 
obtenus. Si le site est statique (un blog de base par exemple), chaque 
visiteur re√ßoit les m√™mes fichiers HTML/CSS (les m√™mes articles du 
blog). Par contre si le site est dynamique, comme Facebook, la page 
affich√©e pour toi (qui est connect√© √† ton compte) sera diff√©rente de la 
mienne (si je suis connect√©), ou de celle d'une personne non connect√©e. 
Par exemple on aura chacun une page profil diff√©rente et un newsfeed 
diff√©rent. C'est parce que les serveurs de Facebook g√©n√®rent leurs 
r√©ponses HTML / CSS de mani√®re dynamique et en fonction de l'utilisateur
 qui navigue sur le site. </p>
<p>Avec Sinatra, tu vas pouvoir faire de m√™me et g√©n√©rer des sites web 
dynamiques o√π la r√©ponse HTML / CSS d√©pendra du code que tu vas √©crire !
 Allez, on se lance dans notre premier site web.</p>

<h3>3.1. Hello World !</h3>
<p>Tu vas lancer ton premier serveur et il aura pour r√¥le de faire une 
r√©ponse statique : un message simple. Commence par cr√©er un dossier <code>hello_world_sinatra</code> qui contiendra deux fichiers : un <code>Gemfile</code> et un fichier <code>app.rb</code>.</p>

<h4>Gemfile</h4>
<p>Le Gemfile va contenir notre version de Ruby habituelle, ainsi que <code>gem 'sinatra'</code>. Je te laisse faire le <code>bundle install</code>.</p>

<h4>app.rb</h4>
<p>Voici ce que va contenir le fichier <code>app.rb</code> : </p>
<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'sinatra'</span>

get <span class="token string">'/hello'</span> <span class="token keyword">do</span>
  <span class="token string">'&lt;h1&gt;Hello world ! &lt;/h1&gt;'</span>
<span class="token keyword">end</span></code></pre>

<h4>C'est pr√™t !</h4>
<p>On t'avait pr√©venu : Sinatra c'est tout basique. ü§ì </p>
<p>Pour tester ton programme, tu n'as qu'√† ex√©cuter ton programme <code>$ ruby app.rb</code>. Le terminal va balancer un message du style :</p>
<pre class=" language-bash"><code class=" language-bash">== Sinatra (v2.0.4) has taken the stage on 4567 for development with backup from Puma
Puma starting in single mode‚Ä¶
* Version 3.12.0 (ruby 2.5.1-p57), codename: Llamas in Pajamas
* Min threads: 0, max threads: 16
* Environment: development
* Listening on tcp://localhost:4567
Use Ctrl-C to stop</code></pre>

<p>Prends le temps de le lire 2 secondes. En gros, ce qu'il faut 
comprendre c'est qu'il te dit "j'ai lanc√© Puma (un serveur), c'est 
cool", il t'informe qu'il √©coute d'√©ventuelles requ√™tes HTTP sur le port
 <code>localhost:4567</code>, et que tu peux arr√™ter le serveur en faisant <code>Ctrl-C</code> (ne fais pas √ßa pour le moment). <br>
On va aller voir ce que le serveur Puma nous r√©pond si on va sur <a href="http://localhost:4567/hello" target="_blank">http://localhost:4567/hello</a>
 avec notre navigateur. Et l√†, SURPRISE, il t'affiche un gros "Hello 
world !" et si tu regardes le code source de la page, tu verras qu'il 
correspond exactement √† <code>app.rb</code> et son code : <code>&lt;h1&gt;Hello world !  &lt;/h1&gt;</code>.</p>

<h3>3.2. Que s'est-il pass√© ?</h3>
<p>C'est la magie de Sinatra : d√®s que tu l'ex√©cutes, il lance un 
serveur qui va r√©agir en fonction du code que tu as √©crit. Ainsi le 
serveur va tourner en local (sur ton ordi), et s'il voit passer une 
requ√™te sur le port o√π il est en √©coute (localhost:4567 dans notre cas),
 il ex√©cute le code correspondant √† cette requ√™te et produit un fichier 
HTML en fonction. L√†, notre code lui dit "si quelqu'un va √† l'adresse <code>/hello</code> en GET, renvoie-lui ce code HTML : <code>&lt;h1&gt;Hello world !  &lt;/h1&gt;</code>".</p>

<h5>3.2.1 C'est quoi un GET ?</h5>
<p>Il existe <b>plusieurs types de requ√™tes HTTP</b>, et nous allons en voir deux aujourd'hui : GET et POST.</p>
<p> Quand tu saisis l'adresse "www.facebook.com" dans ton navigateur 
web, en fait tu lui demandes de faire une requ√™te GET sur cette URL. 
Cette requ√™te GET va arriver au serveur de Facebook qui va l'interpr√©ter
 comme si tu lui disais : "Peux-tu m'envoyer le contenu correspondant √† 
www.facebook.com ?". Ce qu'il va faire avec plaisir</p>

<p>La requ√™te POST, elle, est un peu plus compl√®te. Un bon exemple 
serait quand tu te login sur facebook.com : en faisant √ßa, tu envoies 
plus qu'une simple URL. En effet, pour te connecter √† ton compte, tu 
soumets un formulaire avec de l'info dedans : ton e-mail et ton mot de 
passe. Dans ce cas, c'est un POST o√π tu dis au serveur de Facebook : 
"voici les informations demand√©es (login + mot de passe), maintenant 
traite-les et balance-moi du contenu en retour".</p>

<p>Pour faire simple, une requ√™te GET c'est juste demander d'afficher le
 contenu d'une URL donn√©e. Une requ√™te POST c'est envoyer le contenu 
d'un formulaire et obtenir une r√©ponse en retour. <br>
Pour sch√©matiser, GET pourrait correspondre √† <code>puts</code> et POST pourrait correspondre √† un <code>gets.chomp</code> suivi d'un <code>puts</code>.</p>

<p>Pour notre exemple, si j'avais mis dans le code <code>post '/hello' do --- end </code>, cela voulait dire que si quelqu'un compl√©tait un formulaire sur la page <code>/hello</code>, Sinatra aurait ex√©cut√© le code entre <code>do</code> et <code>end</code>. Et non plus la partie en <code>get '/hello'</code>.</p>

<h5>3.2.2 Les routes</h5>
<p>Les routes sont les URL qui vont entra√Æner une r√©ponse du serveur et donc une action. En √©crivant <code>get '/hello' do ---- end</code>, tu as mis une route sur le GET de <code>/hello</code>. Cela indique au serveur : "si quelqu'un va sur <code>/hello</code>, voil√† le code √† ex√©cuter". </p>

<p>Par contre, si tu vas sur une URL non pr√©vue (exemple : <a href="http://localhost:4567/bonjour" target="_blank">http://localhost:4567/bonjour</a>),
 Sinatra va te renvoyer une page HTML qui dit "h√©, y'a pas de route √† 
cette adresse-l√†". En gros, comme tu ne lui as pas expliqu√© quoi faire 
si quelqu'un va sur <code>/bonjour</code>, il est perdu et renvoie une erreur.</p>

<p>Maintenant on va s'amuser √† param√©trer cette route <code>/bonjour</code> qui √©tait jusque-l√† inconnue. Ajoute dans ton fichier <code>app.rb</code> le code suivant :</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/bonjour'</span> <span class="token keyword">do</span>
  <span class="token string">'&lt;h1&gt;Bonjour, monde !&lt;/h1&gt;'</span>
<span class="token keyword">end</span></code></pre>

<p>Pour que cette nouvelle route soit prise en compte, il faut que tu coupes le serveur (CTRL-C) et relances <code>$ ruby app.rb</code>. Maintenant, retourne sur <a href="http://localhost:4567/bonjour" target="_blank">http://localhost:4567/bonjour</a> : Sinatra sait quoi faire et va t'afficher "Bonjour, monde !".</p>



<h2>4. Pour aller plus loin</h2>
<p>Bon, un programme statique qui affiche "Hello world&nbsp;!", c'est un
 peu limit√©. Ce que nous allons faire ensuite, c'est utiliser ces bases 
pour faire une application dynamique, qui interagit avec l'utilisateur. 
Nous allons ranger le programme dans un beau dossier bien ordonn√© et 
faire des requ√™tes POST qui traiteront de l'information.</p>

<p>Voici <a href="http://sinatrarb.com/intro.html" target="_blank">la doc de la gem Sinatra</a>, que tu peux survoler si le c≈ìur t'en dit.</p>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #FF4081">
<h1>
Projets : 
Une application en Sinatra
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/projects/27/project_submissions/new"><i class="ft-edit" data-original-title="Proposer une am√©lioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>Maintenant que tu sais faire des applications en Ruby pur comme un 
grand, on va enfin passer au web gr√¢ce √† Sinatra ! Ce sera l'occasion de
 te prouver que les notions d√©j√† acquises te permettent d√©j√† de faire 
des choses sympas.</p>

<p>Aujourd'hui, nous allons te demander de faire The Gossip Project en 
Sinatra. Grosso modo, tu vas refaire cette application, mais dans les 
views, au lieu d'avoir <code>puts</code> et <code>gets.chomp</code>, tu 
auras du code HTML. Fini le terminal tout moche, on passe √† une 
application web toute belle qu'il ne resterait qu'√† mettre en production
 sur un serveur üòá Merveilleux, n'est-ce pas ?</p>

<p>Pour ceux qui ont la m√©moire courte, voici le pitch de The Gossip Project. <br>
=&gt; The Hacking Project est une chouette formation, o√π la communaut√© 
est reine. Il se passe plein de choses √† Paris, Lyon, Montpellier, 
Bordeaux et c'est dur de conna√Ætre tous les ragots. Nous allons donc 
cr√©er une application o√π tout le monde va pouvoir ajouter des potins sur
 ses camarades moussaillons.</p>

<p>Dans les grandes lignes, voici les fonctionnalit√©s principales de notre application web : </p>
<ul>
  <li>La page d'accueil du site affichera tous les potins que nous avons en base.</li>
  <li>Cette page d'accueil donnera un lien pour un formulaire o√π quiconque pourra ajouter un potin en base.</li>
  <li>Chaque potin aura une page d√©di√©e.</li>
</ul>

<p>Cette application sera tr√®s bas-niveau, c‚Äôest-√†-dire que nous allons 
quasiment tout faire √† la main. √áa va t'obliger √† r√©inventer la roue en 
organisant bien ton programme, en g√©rant toi-m√™me la base de donn√©es, 
etc. Mais, apr√®s avoir pass√© du temps les mains dans le cambouis, tu 
seras arm√© pour dompter Rails o√π tout est automatis√© (sauf le caf√©).</p>

<p>On va t'accompagner dans ce travail en mode "pas √† pas" et √† la fin, voil√† ce que tu auras appris :</p>
<ul>
  <li>Utiliser un serveur ;</li>
  <li>Lancer une application en Sinatra, et bien ranger le code en MVC ;</li>
  <li>D√©finir des routes et endpoints dans ton application ;</li>
  <li>Utiliser les views pour g√©rer plus facilement le HTML / CSS ;</li>
  <li>Cr√©er et avoir une base de donn√©es ;</li>
  <li>R√©cup√©rer de l'information √† partir de formulaires et la stocker en base de donn√©es.</li>
</ul>

<h2>2. Le projet</h2>
<h3>2.1. Architecture et rangement</h3>
<p>Dans ce chapitre, nous allons voir comment avoir un dossier Sinatra 
bien organis√©. On insiste dessus mais il n'est jamais inutile de vous 
rafra√Æchir la m√©moire : vous allez commencer √† faire programmes 
complexes et longs, bas√©s sur plusieurs gems et framework. Sans un 
rangement propre, une personne ext√©rieur √† votre cerveau ne pourra pas 
la comprendre rapidement et simplement. M√™me vous dans 3 mois vous vous y
 perdrez en revenant sur le projet. Donc on va investir sur l'avenir et 
appliquer les bonnes pratiques d'un d√©veloppeur professionnel qui veut 
pouvoir travailler en √©quipe et produire du code maintenable √† long 
terme. </p>

<p>On va donc partir sur un dossier bien rang√© en architecture MVC, avec
 chaque fichier qui a un but unique, et des dossiers qui suivent la 
convention. C'est parti !</p>

<h4>2.1.1. Cr√©ation des premiers fichiers</h4>
<p>√âvidemment, pour commencer, nous allons cr√©er un dossier <code>the_gossip_project_sinatra</code> qui contiendra notre application. Comme pour l'application pr√©c√©dente, nous allons cr√©er un fichier <code>Gemfile</code>, ainsi qu'un fichier <code>controller.rb</code>. <code>Gemfile</code> devra appeler la gem <code>sinatra</code> ainsi que notre version habituelle de Ruby. Le fichier <code>controller.rb</code> va nous permettre de finir la classe du controller sous le nom <code>ApplicationController</code>. Il doit contenir les lignes suivantes :</p>

<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require

<span class="token keyword">class</span> <span class="token const">ApplicationController</span> &lt; <span class="token const">Sinatra</span><span class="token punctuation">:</span><span class="token symbol">:Base</span>
  get <span class="token string">'/'</span> <span class="token keyword">do</span>
    <span class="token string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Gossip Project&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Mon super site de gossip !&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>
  <span class="token keyword">end</span>

  run<span class="token operator">!</span> <span class="token keyword">if</span> app_file <span class="token operator">==</span> $<span class="token number">0</span>
<span class="token keyword">end</span></code></pre>

<p>Nous allons expliquer ces lignes de code, mais d'abord ex√©cute l'application <code>controller.rb</code> apr√®s avoir fait l'installation du serveur. Si tu vas sur <a href="http://localhost:4567/" target="_blank">http://localhost:4567/</a>, cela devrait afficher un site avec le code source correspondant.</p>


<h4>2.1.2. Les lignes du fichier controller.rb</h4>
<p>Nous allons expliquer ces lignes unes √† unes. En route : ‚õµÔ∏è</p>

<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require</code></pre>

<p>Tu connais d√©j√† ces lignes : elles appellent le bundler et permettent
 de lire le Gemfile. Ainsi, pas besoin de mettre partout des <code>require 'gem'</code>.</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token const">ApplicationController</span> &lt; <span class="token const">Sinatra</span><span class="token punctuation">:</span><span class="token symbol">:Base</span>
  <span class="token comment"># blabla
</span><span class="token keyword">end</span></code></pre>
<p>Dans cette partie, nous avons cr√©√© une classe <code>ApplicationController</code> qui h√©rite (<code>&lt;</code>) de la classe <code>Sinatra::Base</code>. Gr√¢ce √† l'h√©ritage, <code>ApplicationController</code> aura toutes les fonctionnalit√©s que propose la classe <code>Sinatra::Base</code> (= toutes les fonctionnalit√©s de base de Sinatra).</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token comment"># blabla
</span><span class="token keyword">end</span></code></pre>
<p>√áa on l'a vu dans la ressource. Cela dit √† l'appli Sinatra "si quelqu'un va sur l'URL '/', ex√©cute le code qui suit !"</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;The Gossip Project&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Mon super site de gossip !&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span></code></pre>
<p>Doit-on vraiment expliquer cette partie ? C'est le code HTML de la 
page √† afficher, bien s√ªr. Simplement il est affich√© sur une ligne (ce 
qui est tr√®s moche √† lire).</p>

<pre class=" language-ruby"><code class=" language-ruby">run<span class="token operator">!</span> <span class="token keyword">if</span> app_file <span class="token operator">==</span> $<span class="token number">0</span></code></pre>
<p>Cette ligne est assez myst√©rieuse pour toi, mais en gros, elle permet d‚Äôex√©cuter le code de la classe sans avoir √† √©crire un <code>ApplicationController.new.perform</code>
 en bas du fichier. Si tu te rappelles bien, ex√©cuter un fichier qui 
d√©finit une classe (et c'est tout), eh bien √ßa ne donne rien... Il faut 
forc√©ment l'ex√©cution d'une m√©thode en bas de la classe pour lancer la 
machine ! C'est ce que fait cette ligne.</p>

<p>Voici donc √† quoi ressemble notre dossier de projet :</p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra
‚îÇ
‚îú‚îÄ‚îÄ .git, README, toussa
‚îú‚îÄ‚îÄ Gemfile
‚îú‚îÄ‚îÄ Gemfile.lock
‚îî‚îÄ‚îÄ controller.rb</code></pre>


<p>Poursuivons le pas-√†-pas pour √©toffer un peu notre programme.</p>

<h4>2.1.3. Lancer proprement son serveur</h4>
<p>Bon, si tu relis le contenu de ton fichier <code>controller.rb</code>, tu devrais avoir le sentiment qu'il y a une verrue au milieu de ton code. C'est chelou ce <code>run! if app_file == $0</code>
 non ? Maintenant que l'on sait que faire du code propre, c'est 
primordial, on voudrait bien pouvoir s√©parer le code qui d√©fini nos 
classes/variables/m√©thodes du code qui ne sert qu'√† l'ex√©cuter. On va 
cr√©er un fichier dont la mission est de lancer le serveur.</p>

<h5>a) Rack</h5>
<p>Il existe un standard qui s'appelle <a href="https://rack.github.io/" target="_blank">Rack</a> et qui lance des serveurs Ruby. C'est parfait et nous allons l'utiliser.</p>

<h5>b) config.ru</h5>
<p>Nous allons cr√©er un fichier <code>config.ru</code> qui contient les 
informations n√©cessaires au lancement de notre serveur. Promis, son 
extension russe ne cache rien de louche : un fichier <code>.ru</code> est juste un fichier <i>rack up</i>, qui est un fichier Ruby. Cr√©e donc un fichier <code>config.ru</code> et mets-y les lignes suivantes :</p>

<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require

require <span class="token string">'./controller'</span>

run <span class="token const">ApplicationController</span></code></pre>

<p>Les lignes sont plut√¥t explicites : on demande simplement au serveur d'ex√©cuter le contenu de la classe <code>ApplicationController</code> üé≠.<br>
Avant de lancer le serveur, enl√®ve les lignes de <code>controller.rb</code> qui sont en doublons avec <code>config.ru</code> : les lignes qui appellent le bundler ainsi que la ligne <code>run! if app_file == $0</code> qui ne sert plus √† rien. </p>
<p>Haaaa. Notre fichier <code>controller.rb</code> est tout propre maintenant : il ne contient plus que les infos de la classe qu'on d√©finit et √ßa, c'est cool ü§ì</p>

<h5>c) Rackup</h5>

<p>Maintenant on va lancer le serveur. Ex√©cute la commande <code>$ rackup</code>,
 ce qui devrait lancer le serveur. Si tu regardes les lignes s'affichant
 √† l'ex√©cution, tu verras que le port d'√©coute a chang√©. Maintenant on 
est sur <a href="http://localhost:9292/" target="_blank">http://localhost:9292/</a> car Rackup se met par d√©faut sur le port <code>9292</code>, contrairement au port <code>4567</code> de Sinatra. <br>
Comme c'est la convention de se mettre sur <code>4567</code> pour une app Sinatra et que nous sommes dans une app Sinatra, tu peux te brancher sur le port <code>4567</code> en ex√©cutant plut√¥t <code>$ rackup -p 4567</code> üòé</p>


<h4>2.1.4. Construire l'architecture MVC</h4>
<h5>a) Les views (et shotgun)</h5>
<p>Allez, on poursuit la clarification de notre architecture. La prochaine √©tape, quand on regarde le code de <code>controller.rb</code>,
 c'est de se dire "pur√©e, c'est d√©gueu d'avoir du HTML sur une seule 
ligne et au milieu de mon code. √áa va √™tre affreux le jour o√π j'ai des 
10 pages diff√©rentes qui font 1000 lignes de HTML chacune."</p>

<p>On va donc utiliser la fonctionnalit√© des views de Sinatra, et mettre notre HTML dans un fichier √† part. Cr√©e donc un dossier <code>views</code> avec dedans un premier fichier <code>index.erb</code>. Ce fichier va contenir le code HTML de la view <code>index</code> : c'est la view qui liste tous les gossip pr√©sents en BDD. Au passage, sache qu'un fichier <code>.erb</code>
 est un fichier HTML dans lequel tu peux y rajouter du Ruby. En 
m√©langeant les deux langages, tu vas pouvoir afficher en HTML des trucs 
du genre <code>user.first_name</code>, ce qui est plut√¥t pratique pour dire "Bienvenue F√©lix" ou "Bienvenue Jos√©" selon qui se connecte üòò</p>

<p>Bref, voici ce que le fichier <code>index.erb</code> doit contenir : </p>
<pre class=" language-ruby"><code class=" language-ruby">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;<span class="token const">The</span> <span class="token const">Gossip</span> <span class="token const">Project</span>&lt;<span class="token operator">/</span>title&gt;
  &lt;<span class="token operator">/</span>head&gt;
  &lt;body&gt;
    &lt;h1&gt;<span class="token const">Mon</span> <span class="token keyword">super</span> site de gossip<span class="token punctuation">,</span> depuis le dossier views <span class="token operator">!</span>&lt;<span class="token operator">/</span>h1&gt;
  &lt;<span class="token operator">/</span>body&gt;
&lt;<span class="token operator">/</span>html&gt;</code></pre>

<p>Haaaaa (soulagement)....du HTML indent√© ! C'est quand m√™me plus 
agr√©able √† lire qu'un gros blob sur une ligne non ? Bon maintenant on va
 faire pointer la bonne route de <code>controller.rb</code> vers ce fichier en disant "si quelqu'un va sur '/', affiche la view <code>index.erb</code>". <br>
Dans le fichier <code>controller.rb</code>, voici comment tu dois modifier la route :</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  erb <span class="token symbol">:index</span>
<span class="token keyword">end</span></code></pre>

<p>Tout simplement ! Sinatra comprend tout seul qu'il doit aller chercher le fichier <code>index.erb</code> rang√© dans le dossier <code>/views</code>.</p>

<p></p>Maintenant si tu vas  <a href="http://localhost:4567/" target="_blank">sur la page d'accueil de ton serveur</a>, tu devrais avoir cette nouvelle page, qui dit "depuis le dossier views".<p></p>

<p>L√†, certains diront <b>"Elle n'a pas chang√© üò¢"</b></p>

<p>Damnit ! En fait c'est tout b√™te, mais √©tant donn√© que tu as chang√© le fichier <code>controller.rb</code>, la modification ne sera pas prise en compte tant que le fichier <code>config.ru</code> tourne toujours (il ne recharge pas automatique la derni√®re version du fichier <code>controller.rb</code>). Il faut donc quitter le serveur et le red√©marrer : fais le test.</p>

<p>Ce n'est pas pratique de relancer √† chaque fois son serveur. On va 
donc ajouter une surcouche √† Rackup qui recharge automatiquement 
l'application en cas de modification. Cette surcouche est <a href="https://github.com/rtomayko/shotgun" target="_blank">une gem d√©nomm√©e shotgun</a>. Comme d'hab, on l'ajoute dans le <code>Gemfile</code> en faisant <code>gem 'shotgun'</code>, puis, apr√®s avoir fait l'installation du bundle, on peut l'utiliser en passant la commande <code>$ shotgun -p 4567</code> dans le terminal. √Ä toi le nouveau serveur qui d√©chire !</p>


<h5>b) Une vraie arborescence</h5>
<p>Allez, promis, ce sont les derniers changements avant de s'attaquer 
au coeur du code üòá. Notre application devrait ressembler √† ceci pour le
 moment :</p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra/
‚îú‚îÄ‚îÄ Gemfile
‚îú‚îÄ‚îÄ Gemfile.lock
‚îú‚îÄ‚îÄ controller.rb
‚îú‚îÄ‚îÄ config.ru
‚îî‚îÄ‚îÄ views
    ‚îî‚îÄ‚îÄ index.erb</code></pre>

<p>C'est pas trop mal, mais √ßa ne respecte pas les standards que tu connais hein ? Tu l'as vu direct, il manque le dossier <code>lib</code>
 qui √©vite qu'on entasse tout √† la racine comme des sagouins. Fais donc 
les changements n√©cessaires pour avoir l'arborescence suivante : </p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra/
‚îú‚îÄ‚îÄ Gemfile
‚îú‚îÄ‚îÄ Gemfile.lock
‚îú‚îÄ‚îÄ config.ru
‚îî‚îÄ‚îÄ lib
    ‚îú‚îÄ‚îÄ views
    ‚îÇ   ‚îî‚îÄ‚îÄ index.erb
    ‚îî‚îÄ‚îÄ controller.rb</code></pre>

<p>Ainsi, notre application suit mieux la convention MVC maintenant : ce
 sera plus pratique pour comprendre ce qu'elle fait. Dernier d√©tail, 
pour la faire marcher, il faut dire √† notre fichier <code>config.ru</code> de prendre en compte tous les fichiers dans le dossier <code>lib</code>. On va modifier deux lignes, et voici ce √† quoi il devrait ressembler :</p>
<pre class=" language-ruby"><code class=" language-ruby">require <span class="token string">'bundler'</span>
<span class="token const">Bundler</span><span class="token punctuation">.</span>require

$<span class="token punctuation">:</span><span class="token punctuation">.</span>unshift <span class="token builtin">File</span><span class="token punctuation">.</span>expand_path<span class="token punctuation">(</span><span class="token string">"./../lib"</span><span class="token punctuation">,</span> __FILE__<span class="token punctuation">)</span>
require <span class="token string">'controller'</span>
run <span class="token const">ApplicationController</span></code></pre>

<p>Si tu lances le serveur avec <code>$ shotgun -p 4567</code>, tout 
devrait fonctionner normalement. On a les bases pour une application 
solide, bien rang√©e. Maintenant on peut passer √† la suite üí™.</p>

<h3>2.2. Les premi√®res views</h3>
<h4>2.2.1. Index</h4>
<p>Notre view "index" doit afficher la liste des gossips, ainsi qu'un 
lien pour cr√©er un gossip. Pour le moment, notre base de donn√©es est 
vide donc on va se focaliser sur l'ajout d'un lien pour cr√©er un nouveau
 gossip (histoire de pouvoir alimenter la BDD).</p>

<p>Par convention, quand on veut cr√©er une nouvelle entr√©e en BDD (ici, un nouveau potin de la classe <code>Gossip</code>), on va sur un lien URL qui suit cette structure<code>/nom_classe_au_pluriel/new/</code>. Ainsi, pour cr√©er un potin, nous voulons que √ßa se passe sur <code>gossips/new/</code>. </p>

<p>Pour cr√©er un lien HTML qui pointe vers cette adresse, il te suffit d'ajouter un tag HTML selon ce mod√®le <code>&lt;a href="/gossips/new/"&gt;le texte du lien&lt;/a&gt;</code>. En effet, Sinatra est malin et comprendra qu'il faut renvoyer via l'URL compl√®te <code>http://localhost:4567/gossips/new/</code>
 : inutile de pr√©ciser le localhost donc. C'est m√™me une tr√®s mauvaise 
id√©e car si tu d√©cides de changer le port d'√©coute du serveur (par 
exemple, tu oublies de mettre <code>-p 4567</code> et √ßa pointe vers <code>9292</code>), plus aucun lien ne marche sur ton site üòÑ.</p>

<p>Pour commencer, on va donc coder une view <code>index</code> simple :
 souhaitons la bienvenue √† ton utilisateur en lui disant que la liste 
des potins arrive bient√¥t, et qu'en attendant, il peut <a href="http://localhost:4567/gossips/new/" target="_blank">aller cr√©er un nouveau potin</a>. Ins√®re donc le lien pour qu'il aille sur <code>/gossips/new/</code>. </p>

<p>Si tu cliques sur ce lien, Sinatra devrait te renvoyer une erreur 
pour te dire qu'il n'y a pas de routes sur cette adresse. Eh bien 
cr√©ons-la !</p>

<h4>2.2.2. A new gossip !</h4>
<h5>a) Param√©trer la route GET en entr√©e</h5>
<p>Il faut donc commencer par param√©trer la route pour que le serveur pointe vers une nouvelle view <code>new_gossip.erb</code> quand on va sur <code>/gossips/new/</code>. Mets en place la route en suivant le mod√®le de ta premi√®re route et cr√©e dans le dossier <code>views</code> un fichier <code>new_gossip.erb</code>. Puis fais pointer la route <code>/gossips/new/</code> vers cette nouvelle view depuis le controller.</p>

<h5>b) Cr√©er la view</h5>
<p>Pour cette view, nous allons ins√©rer un <a href="https://www.w3schools.com/htmL/html_forms.asp" target="_blank">formulaire</a>
 ultra simple. Comme vu dans la ressource, un formulaire permet 
d'envoyer de l'information vers une URL pr√©cise via une requ√™te POST. 
Pour notre exemple, le formulaire devra envoyer le potin en POST √† 
l'adresse <code>/gossips/new/</code>. Nous aimons bien faire r√©fl√©chir les moussaillons √† THP, mais on va te guider encore un peu en te donnant le code de la page <code>new_gossip.erb</code> : </p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;<span class="token const">Cr</span>√©er un potin&lt;<span class="token operator">/</span>title&gt;
  &lt;<span class="token operator">/</span>head&gt;
  &lt;body&gt;
    &lt;h1&gt;<span class="token const">Cr</span>√©e un potin <span class="token operator">!</span>&lt;<span class="token operator">/</span>h1&gt;
    &lt;p&gt;<span class="token const">Balance</span> ton potin via le formulaire ci<span class="token operator">-</span>dessous&lt;<span class="token operator">/</span>p&gt;
    &lt;form action<span class="token operator">=</span><span class="token string">'/gossips/new/'</span> method<span class="token operator">=</span><span class="token string">'POST'</span>&gt;
      <span class="token const">Saisi</span> ici ton nom <span class="token punctuation">:</span>  &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_author'</span><span class="token operator">/</span>&gt;&lt;br<span class="token operator">/</span>&gt;
      <span class="token const">Balance</span> ton potin <span class="token punctuation">:</span> &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_content'</span><span class="token operator">/</span>&gt;&lt;br<span class="token operator">/</span>&gt;
      &lt;input type<span class="token operator">=</span><span class="token string">'submit'</span><span class="token operator">/</span>&gt;
    &lt;<span class="token operator">/</span>form&gt;
  &lt;<span class="token operator">/</span>body&gt;
&lt;<span class="token operator">/</span>html&gt;</code></pre>

<h5>c) Regardons ce formulaire de pr√®s</h5>
<p>Comme c'est ton premier formulaire et que je n'aime pas te faire 
bosser sur des copier-coller idiots, on va d√©cortiquer le contenu du 
formulaire.</p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;form action<span class="token operator">=</span><span class="token string">'/gossips/new/'</span> method<span class="token operator">=</span><span class="token string">'POST'</span>&gt;
<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
&lt;<span class="token operator">/</span>form&gt;</code></pre>
<p>Cette partie est l'ossature du formulaire. Le champ <code>action</code> d√©finit l'URL qui va recevoir le contenu du formulaire et le champ <code>method</code> d√©finit le type de requ√™te. Ici, on enverra donc le contenu du formulaire vers l'URL <code>/gossips/new/</code> avec une requ√™te POST.</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token const">Saisi</span> ici ton nom <span class="token punctuation">:</span> &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_author'</span><span class="token operator">/</span>&gt;</code></pre>
<p>Ici, on rajoute un champ de saisie de texte √† remplir par l'utilisateur avec le tag HTML <code>&lt;input type='text'&gt;</code>. L'option <code>name</code>
 d√©finir le nom que portera ce contenu saisi, tout comme on lui 
donnerait un nom de variable en Ruby du genre "user_name" ou autre. En 
l'appelant <code>gossip_author</code> et en mettant avant le champ de 
saisie la phrase "Saisie ici ton nom", on comprend bien qu'on veut que 
l'utilisateur tape ici son nom.</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token const">Balance</span> ton potin <span class="token punctuation">:</span> &lt;input type<span class="token operator">=</span><span class="token string">'text'</span> name<span class="token operator">=</span><span class="token string">'gossip_content'</span><span class="token operator">/</span>&gt;</code></pre>
<p>Idem que plus haut mais cette fois on veut que l'utilisateur tape ici le texte du gossip √† cr√©er.</p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;input type<span class="token operator">=</span><span class="token string">'submit'</span><span class="token operator">/</span>&gt;</code></pre>
<p>Tout formulaire qui se respecte termine forc√©ment par un bouton 
"submit". En cliquant dessus, l'utilisateur va d√©clencher l'envoi de la 
requ√™te POST avec toutes les informations des champs du formulaire.</p>

<h5>d) Testons cela</h5>
<p>Va sur <a href="http://localhost:4567/gossips/new/" target="_blank">la page de cr√©ation de potin</a>, puis clique sur <code>submit</code>. Sinatra va t'envoyer bouler car tu n'as pas cr√©√© de route pour le POST de <code>/gossips/new/</code> alors m√™me que tu as une route pour le GET de cette m√™me URL. <br>
Et oui, pour une m√™me URL, l'action sera diff√©rente entre un GET et un 
POST. En GET, tu vas dire √† Sinatra : "hey, si quelqu'un va sur 
/gossips/new/ envoie-lui les view <code>new_gossip</code>", cependant en
 POST, ce sera plut√¥t un truc du genre "hey bro, r√©cup√®re les 
informations du formulaire et convertis-les en une cr√©ation de gossip 
dans ma base".</p>

<h5>e) Param√©trer la route POST en sortie</h5>
<p>Nous allons param√©trer donc cette route, puis nous irons cr√©er un Gossip en base de donn√©e. Dans le fichier <code>controller.rb</code>, mets donc la route suivante :</p>

<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  puts <span class="token string">"Ce programme ne fait rien pour le moment, on va donc afficher un message dans le terminal"</span>
<span class="token keyword">end</span></code></pre>

<p>Si tu soumets le formulaire le programme ne t'affiche plus d'erreur 
de route, mais te renvoie une page blanche (c'est normal, puisque on ne 
lui a pas dit d'afficher une view). Si tu regardes la fen√™tre de ton 
serveur, tu vas voir la phrase <i>"Ce programme ne fait rien pour le moment, on va donc afficher un message dans le terminal"</i>. C'est super int√©ressant, car : <br>
1Ô∏è‚É£ cela veut dire que ta route marche car le <code>puts</code> est bien ex√©cut√©. <br>
2Ô∏è‚É£ tu aurais pu ex√©cuter autre chose qu'un <code>puts</code>. N'importe
 quoi d'autre en fait : par exemple, tu pourrais ins√©rer tout ton 
programme de scrapping de cryptomonnaies pour qu'il soit ex√©cut√© au <code>submit</code> du formulaire.üêß</p>

<p>Bref, maintenant, ce serait bien de pouvoir cr√©er un Gossip quand on soumet le formulaire. Nous allons donc cr√©er une classe <code>Gossip</code> dont le r√¥le sera de sauvegarder les potins dans une base de donn√©es maison. BOUM !</p>


<h3>2.3. La classe Gossip et la base de donn√©es</h3>
<p>Dans ce chapitre, nous allons voir comment cr√©er un Gossip et 
l'ajouter en base de donn√©es. En gros, nous voudrions avoir dans notre 
fichier <code>controller.rb</code> une route POST du genre :</p>
<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  <span class="token const">Gossip</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>les_entr√©es_du_gossip<span class="token punctuation">)</span><span class="token punctuation">.</span>save
<span class="token keyword">end</span></code></pre>

<p><code>Gossip.new(les_entr√©es_du_gossip)</code> cr√©e la nouvelle instance de <code>Gossip</code>. Et en lui appliquant un <code>.save</code>, on veut qu'elle soit inscrite dans la base de donn√©e. Donc mettons √ßa en place ! ü§†</p>

<h4>2.3.1. La classe Gossip</h4>
<p>Nous allons cr√©er une classe <code>Gossip</code> (c'est notre model !). Elle aura une m√©thode <code>#save</code>
 qui enregistrera dans une base de donn√©es l'objet sur laquelle elle est
 appliqu√©e. Comme √ßa on stocke tous les potins, et puis y'aura juste √† 
aller les chercher quand n√©cessaire.</p>

<p>Cr√©e dans le dossier <code>lib</code> un fichier <code>gossip.rb</code> qui contiendra le code de la classe <code>Gossip</code>. Pour le moment, on va se focaliser sur le fichier <code>gossip.rb</code>, et puis quand il sera fonctionnel, on le branchera au controller.</p>

<p>Dans le fichier <code>gossip.rb</code>, cr√©e la classe <code>Gossip</code> et ajoute-lui une m√©thode <code>#save</code> qui sera vide pour l'instant.</p>

<h4>2.3.2. Lien avec la base de donn√©es</h4>
<p>Ce que nous voulons faire, c'est qu'une action comme <code>instance_de_la_classe_gossip.save</code>
 enregistre en base de donn√©es le potin. Nous pouvons le faire avec 
JSON, CSV, SQL, ou m√™me Google Spreadsheet. Je vais te montrer comment 
le faire en CSV car c'est le plus simple de mon point de vue. Choisi 
l'option que tu pr√©f√®res mais sache qu'√† terme, nous utiliserons de 
vraies bases de donn√©es en SQL.</p>

<p>Comme tu le sais, une base de donn√©es √ßa se ranger dans un dossier <code>/db</code> √† la racine de notre application. Ainsi, voici √† quoi va ressembler l'arborescence de notre application :</p>

<pre class=" language-shell"><code class=" language-shell">the_gossip_project_sinatra
‚îú‚îÄ‚îÄ Gemfile
‚îú‚îÄ‚îÄ Gemfile.lock
‚îú‚îÄ‚îÄ config.ru
‚îú‚îÄ‚îÄ db
‚îÇ   ‚îî‚îÄ‚îÄ gossip.csv
‚îî‚îÄ‚îÄ lib
    ‚îú‚îÄ‚îÄ controller.rb
    ‚îú‚îÄ‚îÄ gossip.rb
    ‚îî‚îÄ‚îÄ views
        ‚îú‚îÄ‚îÄ index.erb
        ‚îî‚îÄ‚îÄ new_gossip.erb</code></pre>

<p>Avec les connaissances acquises la semaine pass√©e, tu devrais savoir comment faire pour que <code>gossip.rb</code> puisse √©crire sur un CSV via la m√©thode <code>#save</code>.<br>
Juste au cas o√π, je te mets quand m√™me √† quoi elle devrait ressembler : </p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> save
  <span class="token const">CSV</span><span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"./db/gossip.csv"</span><span class="token punctuation">,</span> <span class="token string">"ab"</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>csv<span class="token operator">|</span>
    csv &lt;&lt; <span class="token punctuation">[</span><span class="token string">"Mon super auteur"</span><span class="token punctuation">,</span> <span class="token string">"Ma super description"</span><span class="token punctuation">]</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>

<p>Pour rappel, ces lignes se lisent ainsi : <br>
1) Nous ouvrons le CSV en mode √©criture (<a href="http://ruby-doc.org/core-2.0.0/IO.html#method-c-new-label-IO+Open+Mode" target="_blank">ab</a>) (le CSV a le path <code>db/gossip.csv</code>). <br>
2) Nous ins√©rons dedans une ligne avec deux colonnes. La premi√®re colonne a pour entr√©e le string <code>Mon super auteur</code> et la seconde colonne a le string <code>Ma super description</code>.</p>

<p>Je te laisse mettre tout √ßa dans la classe <code>Gossip</code> puis tester (par exemple avec PRY et un petit <code>Gossip.new.save</code>) que la m√©thode <code>save</code> ajoute bien une ligne "Mon super auteur, Ma super description" √† ton CSV. <br>
Maintenant nous allons donc brancher ceci √† notre fichier <code>controller.rb</code>.</p>


<h4>2.3.3. Dans l'application</h4>
<p>Maintenant il faut s'arranger pour que quand quelqu'un soumet le formulaire, notre programme appelle la m√©thode <code>save</code> de la classe Gossip. Pour ceci, ajoute la ligne <code>Gossip.new.save</code> √† la route POST concern√©e de notre fichier <code>controller.rb</code>. Avec <code>Gossip.new</code> on cr√©e un nouvel objet Gossip et avec <code>.save</code> on lui applique la m√©thode save</p>

<p>Essaye maintenant de soumettre le formulaire : le programme va 
t'envoyer bouler en te disant que la classe Gossip n'existe pas. C'est 
juste qu'on a oubli√© de lier les deux classes entre elles : ajoute tout 
en haut du programme <code>controller.rb</code> la ligne <code>require 'gossip'</code>.</p>

<p>√Ä pr√©sent, si tu soumets le formulaire, cela devrait ajouter √† 
nouveau la ligne "Mon super auteur, Ma super description" √† notre CSV. 
C'est ‚Äìpresque‚Äì exactement ce que l'on cherchait √† faire ! Youpi !</p>

<h4>2.3.4. Enregistrer en CSV mais avec des param√®tres dynamiques</h4>
<p>Bon, l√† tu dois te dire "c'est cool son programme, mais √ßa enregistre √† chaque <code>submit</code> la m√™me ligne <i>Mon super auteur</i> et <i>Ma super description</i>
 dans le CSV. C'est un peu bidon". C'est parce que nous n'avons pas pris
 en compte les infos saisies par l'utilisateur ! Il faut rendre tout 
cela param√©trable en faisant un truc du genre <code>Gossip.new(author, content).save</code> pour que cela √©crive dans le CSV le <code>author</code> et le <code>content</code>.</p>

<p>Si tu as bonne m√©moire, tu peux d√©finir des variables d'instance dans ta classe <code>Gossip</code>. Ajoute donc deux variables d'instance <code>@author</code> et <code>@content</code> en les passant en param√®tres dans une m√©thode <code>initialize</code>. <br>
A pr√©sent, il te faut modifier la m√©thode <code>#save</code> pour qu'elle √©crive non plus <code>"Mon super auteur"</code> et <code>"Ma super description"</code> mais plut√¥t les valeurs contenues dans <code>@author</code> et <code>@content</code> dans le CSV. Ainsi il faut que <code>Gossip.new("Jos√©", "Josiane est nulle").save</code> rajoute la ligne "Jos√©, Josiane est nulle" dans le CSV.</p>

<p>Je te laisse passer les modifications. </p>

<p>Maintenant met la ligne <code>Gossip.new("super_auteur", "super gossip").save</code> dans le fichier <code>controller.rb</code>
 et v√©rifie qu'en soumettant le formulaire (sans le remplir. Juste pour 
activer la route POST)cela ajoute une ligne dans le fichier <code>gossip.csv</code> avec les colonnes <code>super_auteur</code> et <code>super gossip</code>. Si oui, c'est que tu as r√©ussi !</p>

<p>Waow ! Tu as r√©ussi √† cr√©er une base de donn√©es qui se met √† jour 
toute seule comme une grande, dans une application faite √† partir de 
rien. C'est quand m√™me sacr√©ment solide üòá Bon maintenant, ce qui serait
 top, ce serait de r√©cup√©rer le contenu du formulaire et de 
l'enregistrer en faisant <code>Gossip.new(info_formulaire_1, info_formulaire_2).save</code>.Eh bien c'est ce que nous allons voir !</p>

<h3>2.4. Ajouter un Gossip √† partir du front</h3>
<p>Dans cette partie, nous allons apprendre √† r√©cup√©rer l'information du formulaire, puis de l'ajouter en base dans notre base.</p>

<h4>2.4.1. R√©cup√©rer les infos du formulaire via <code>params</code></h4>
<p>Quand on fait du web, il existe une variable assez ultime qui s'appelle <code>params</code>.
 En gros, params est un hash qui va stocker temporairement les 
informations que nous envoie l'utilisateur. Cela peut √™tre une 
information quand il fait un GET (avec par exemple une URL du genre <code>/facebook.com/username</code>), ou alors un formulaire qu'il nous soumet avec un POST.</p>

<p>Fais donc un test en √©crivant, dans le controller, le code suivant :</p>

<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  puts <span class="token string">"Salut, je suis dans le serveur"</span>
  puts "<span class="token const">Ceci</span> est le contenu du hash params <span class="token punctuation">:</span> <span class="token comment">#{params}"
</span>  puts "<span class="token const">Trop</span> bien <span class="token operator">!</span> <span class="token const">Et</span> ceci est ce que l'utilisateur a pass√© dans le champ gossip_author <span class="token punctuation">:</span> <span class="token comment">#{params["gossip_author"]}"
</span>  puts "<span class="token const">De</span> la bombe<span class="token punctuation">,</span> et du coup √ßa<span class="token punctuation">,</span> √ßa doit √™tre ce que l'utilisateur a pass√© dans le champ gossip_content <span class="token punctuation">:</span> <span class="token comment">#{params["gossip_content"]}"
</span>  puts <span class="token string">"√áa d√©chire sa m√©m√©, bon allez je m'en vais du serveur, ciao les BGs !"</span>
<span class="token keyword">end</span></code></pre>

<p>Maintenant retourne sur le formulaire, rempli les 2 cases avec 
quelque chose et soumets-le. Va voir ton terminal, et hop, magie, tu 
retrouves les informations de ton formulaire ! Cet exemple illustre par 
ailleurs que "dans le doute, mets des puts partout" : √ßa te permet de 
comprendre comment marche un programme (et donc le d√©bugger).</p>

<p><b>Conclusion de notre test</b> : quand l'utilisateur soumet le formulaire, <code>params</code> r√©cup√®re son contenu et le stocke avec les noms qu'on avait choisis pour chaque champ de texte. <code>params["gossip_author"]</code> et <code>params["gossip_content"]</code> contiennent les 2 strings rentr√©s par l'utilisateur.</p>

<p>Note importante : le contenu de <code>params</code> ne persiste que 
d‚Äôune page sur l‚Äôautre. Le hash se vide √† chaque requ√™te HTTP 
(changement de page). Il faut donc r√©cup√©rer le contenu imm√©diatement 
apr√®s la saisie, sinon c'est perdu !</p>


<h4>2.4.2. Cr√©er un gossip</h4>
<p>Maintenant, on va devoir s'arranger pour r√©cup√©rer les informations du formulaire et les injecter dans le code <code>Gossip.new(truc_1, truc_2).save</code> pour qu'elles soient enregistr√©es dans notre base de donn√©es. Je t'invite donc √† mettre <code>params["gossip_author"]</code> et <code>params["gossip_content"]</code> dans la commande <code>Gossip.new(truc_1, truc_2).save</code> de ton controller.</p>

<p>Tu peux tester ton code en soumettant le formulaire et en regardant ce qu'il fait √† ton fichier <code>gossip.csv</code>. N'h√©site pas non plus √† mettre des <code>puts</code> dans ton code et regarder ce que √ßa donne sur le terminal. </p>

<p>Une fois que tu as r√©ussi √† faire marcher cela, eh bien bravo ! Tu 
sais cr√©er un formulaire, et enregistrer en base de donn√©es les 
informations de ce formulaire.</p>

<h4>2.4.3. Rediriger vers l'accueil</h4>
<p>Ton formulaire, quand il est soumis, dit √† l'application "h√©, voici 
les informations : cr√©e un gossip avec". C'est tip top. Cependant, 
l'utilisateur n'a aucun retour : ce serait bien de pouvoir revenir sur 
la page d'accueil une fois que le gossip a √©t√© cr√©√©.</p>

<p>Et bien il existe une super commande qui s'appelle <code>redirect</code>
 et qui dit √† Sinatra "maintenant, redirige le user vers cette route". 
Ainsi, pour rediriger vers la route '/', il faudra √©crire <code>redirect '/'</code>. Du coup, pour rediriger l'utilisateur apr√®s avoir sauvegard√© le gossip, il faudra √©crire :</p>

<pre class=" language-ruby"><code class=" language-ruby">post <span class="token string">'/gossips/new/'</span> <span class="token keyword">do</span>
  <span class="token comment"># ton super code qui enregistre un gossip en fonction de params
</span>  redirect <span class="token string">'/'</span>
<span class="token keyword">end</span></code></pre>

<p>Et quand tu vas soumettre le formulaire, voici ce qui va se passer :</p>
<ol>
  <li>Le programme va r√©cup√©rer les informations du formulaire avec <code>params</code> ;</li>
  <li>Il enregistre ces informations dans un fichier CSV gr√¢ce √† notre classe Gossip ;</li>
  <li>Il redirige l'utilisateur vers la page d'accueil.</li>
</ol>

<p>Une fois que t'as fait √ßa, on y est : tu as fini le boulot pour la partie "cr√©ation d'un gossip" et c'est top.</p>
<p> Je ne sais pas si tu te souviens, mais on avait dit que l'on 
aimerait bien afficher tous les potins sur la page d'index. Nous allons 
donc cr√©er une m√©thode <code>#all</code> pour la classe Gossip qui nous sort tous les gossips, bien rang√©s dans un array.</p>

<h3>2.5. Afficher l'index des gossips</h3>
<p>Pour avoir un truc propre, on voudrait pouvoir faire <code>Gossip.all</code> et que √ßa nous ressorte tous les potins dans un bel array. Puis dans la view, j'afficherai chaque gossip avec un truc du genre <code>all_gossips.each { |gossip| #blabla }</code>. Le r√™ve</p>

<h4>2.5.1. La m√©thode <code>#all</code></h4>
<p>Une m√©thode <code>#all</code>, c‚Äôest quand m√™me pratique. Cela me 
sort tous les potins au format array, et donc proprement rang√©s : je 
n'ai plus qu'√† m'amuser avec. <br>
En gros, √ßa retournerait un array du genre <code>array = [gossip_1, gossip_2, etc]</code> avec <code>gossip_1</code> et <code>gossip_2</code> qui sont des objets de type <code>Gossip</code>. Tu pourrais alors faire <code>gossip_1.author</code> pour avoir l'auteur du premier, ou m√™me juste <code>array[0].author</code>. </p>

<p>Pour faire cette m√©thode <code>all</code>, on va passer sur le fichier <code>gossip.csv</code> puis enregistrer chacune des lignes comme √©tant un objet <code>Gossip</code> qu'on va ranger dans un array. Et √† la fin, on retourne l'array. <br>
Le pseudo-code va donc ressembler √† ceci :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>all
  all_gossips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">#on initialise un array vide
</span>
  <span class="token comment"># va chercher chacune des lignes du csv do
</span>    <span class="token comment"># cr√©e un gossip avec les infos de la ligne
</span>    <span class="token comment"># all_gossips &lt;&lt; gossip qui vient d'√™tre cr√©√©
</span>  <span class="token comment"># end
</span>
  <span class="token keyword">return</span> all_gossips <span class="token comment">#on retourne un array rempli d'objets Gossip
</span><span class="token keyword">end</span></code></pre>

<p>Je te donne, en exclusivit√© mondiale, le code de la m√©thode <code>#all</code> :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>all
  all_gossips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token const">CSV</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"./db/gossip.csv"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>csv_line<span class="token operator">|</span>
    all_gossips &lt;&lt; <span class="token const">Gossip</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>csv_line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> csv_line<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
  <span class="token keyword">return</span> all_gossips
<span class="token keyword">end</span></code></pre>

<p>Et voil√†, cette m√©thode va r√©cup√©rer chacune des lignes de notre CSV, en fait un objet <code>Gossip</code> avec son <code>author</code> et <code>content</code> puis ressort un array avec tous nos potins. Maintenant il n'y a plus qu'√† afficher nos potins dans notre site.</p>

<h4>2.5.2. Afficher tous les gossips dans la vue</h4>
<p>On a un bel array avec tous nos potins, ce qui est cool serait de pouvoir faire une boucle <code>all_gossips.each do</code>
 dans un fichier HTML pour afficher tous les gossips. Figure-toi que 
c'est exactement ce √† quoi servent les fichiers ERB : on peut m√©langer 
du Ruby avec de l'HTML. De la bombe üí£</p>

<h5>a) Passer une variable √† une view (via les routes)</h5>

<p>Pour ceci, il suffit d'utiliser une m√©thode <code>locals</code>, qui permet d'envoyer √† notre fichier ERB des variables que l'on utilisera. Ici on veut lui envoyer l'array obtenu par <code>Gossip.all</code> donc voici ce √† quoi devrait ressembler la route pour l'index : </p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  erb <span class="token symbol">:index</span><span class="token punctuation">,</span> locals<span class="token punctuation">:</span> <span class="token punctuation">{</span>gossips<span class="token punctuation">:</span> <span class="token const">Gossip</span><span class="token punctuation">.</span>all<span class="token punctuation">}</span>
<span class="token keyword">end</span></code></pre>

<p>Bien s√ªr je te laisse cr√©er le fichier <code>index.erb</code> l√† o√π il faut.</p>

<h5>b) Utiliser cette variable dans la view</h5>
<p>Quand tu joues avec un string, on peut ins√©rer une variable Ruby dans le string avec <code>#{}</code>. Avec un fichier ERB, on peut faire ceci avec <code>&lt;% %&gt;</code>, ou <code>&lt;%= %&gt;</code>. Pour que tu comprennes la diff√©rence, voici le contenu de <code>index.erb</code> qui va afficher tous les potins en HTML:</p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;% gossips<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>gossip<span class="token operator">|</span> %&gt;
        &lt;p&gt;
          &lt;%<span class="token operator">=</span> gossip<span class="token punctuation">.</span>author %&gt;&lt;br<span class="token operator">/</span>&gt;
          &lt;%<span class="token operator">=</span> gossip<span class="token punctuation">.</span>content %&gt;
        &lt;<span class="token operator">/</span>p&gt;
      &lt;% <span class="token keyword">end</span> %&gt;</code></pre>

<p>En fait, <code>&lt;% %&gt;</code> te sert √† ex√©cuter du Ruby au sein d'un fichier HTML. Par exemple pour faire un <code>each do</code>.</p>
<p>Par contre <code>&lt;%= %&gt;</code> va te servir √† afficher un string Ruby qui est entre ces balises (c'est l'√©quivalent d'un <code>puts</code> mais sur du HTML).</p>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">‚ö†Ô∏è ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">Tu vas potentiellement avoir un souci si tu appelles <code>.author</code> et <code>.content</code> d'un objet <code>Gossip</code> sans qu'ils soient tous les deux en <code>attr_accessor</code>... As-tu pens√© √† bien param√©trer √ßa ?</p>
    </div>
  </div>
</div>

<h3>2.6. La vue show d'un potin</h3>
<p>Bravo, tu as fait une grosse partie du projet et c'est d√©j√† un super 
r√©sultat. Tu peux √™tre fier ! Comme je sens que tu as le niveau, la 
suite sera moins pas √† pas et ce sera un peu plus dur. Mais avec les 
bonnes recherches et les bons indices, tu vas cartonner j'en suis s√ªr üòò</p>
<p>Prochaine √©tape : afficher tes potins un √† un.</p>

<h4>2.6.1. Le principe</h4>

<p>Nous allons faire des pages "profil" pour chaque potin, c‚Äôest-√†-dire 
que nous allons cr√©er une page par potin afin de l'afficher lui seul. 
C'est ce qu'on appelle un page "show". Quand "index" est une page unique
 qui affiche tous les potins, il existe autant de page "show" que de 
potin.</p>

<p>Nous voudrions faire en sorte que si l'on va sur <a href="http://localhost:4567/gossips/2/" target="_blank">http://localhost:4567/gossips/2/</a>,
 le site nous affiche la page "show" du gossip n¬∞2. Idem avec le num√©ro 
3, num√©ro 4, num√©ro 1, etc. Alors tu imagines bien qu'on peut avoir 10, 
100 voire 1000 potins : on va pas rentrer toutes ces routes √† la main, 
m√™me en tentant un <code>.each</code> sur tous les gossips pour faire les routes correspondantes. Pour cela, on va cr√©er dans notre app Sinatra ce qu'on appelle une <b>URL dynamique</b>.</p>

<p>C'est quoi une URL dynamique ? C'est une URL qui contient une 
variable. Au lieu de saisir les routes "gossips/2", "gossips/3", etc. On
 va se d√©brouiller pour pouvoir saisir une route "gossips/x" et qu'en 
fonction de la valeur de <code>x</code>, notre code s'adapte et affiche ce qu'il faut.</p>

<p>Pour r√©capituler, nous allons :</p>
<ol>
  <li>Cr√©er une route dynamique pour qu'√† chaque fois qu'un utilisateur rentre une URL du type <a href="http://localhost:4567/gossips/x/" target="_blank">http://localhost:4567/gossips/x/</a>, Sinatra comprenne que l'on veut voir la page show du potin N¬∞x en BDD ;</li>
  <li>R√©cup√©rer dans notre BDD le potin N¬∞x avec une belle m√©thode <code>#find</code> ;</li>
  <li>Afficher le contenu du potin dans la page show.</li>
</ol>

<h4>2.6.2. Les routes dynamiques</h4>
<p>Pour √©viter d'avoir √† rentrer √† la main une route pour chaque potin, 
il existe une m√©thode pour avoir des URLs dynamiques. Pour ceci, je 
t'invite √† regarder <a href="http://sinatrarb.com/intro.html" target="_blank">la documentation d'introduction de Sinatra</a>
 qui explique comment faire ses routes. Voici l'exemple qu'elle propose 
afin de rajouter, au sein d'une route, une variable (par exemple <code>:name</code>) :</p>

<pre class=" language-ruby"><code class=" language-ruby">get <span class="token string">'/hello/:name'</span> <span class="token keyword">do</span>
  <span class="token comment"># matches "GET /hello/foo" and "GET /hello/bar"
</span>  <span class="token comment"># params['name'] is 'foo' or 'bar'
</span>  "<span class="token const">Hello</span> <span class="token comment">#{params['name']}!"
</span><span class="token keyword">end</span></code></pre>

<p>Si tu suis bien, la valeur de <code>:name</code> (saisie par l'utilisateur dans l'URL) sera alors accessible dans le hash <code>params</code> sous <code>params['name']</code>.</p>

<p>Essaye d'impl√©menter cet exemple ci-dessus dans ton application Sinatra. Ton objectif est que quand on va <a href="http://localhost:4567/gossips/2/" target="_blank">http://localhost:4567/gossips/2/</a>,
 le serveur Sinatra t'affiche (en HTML ou sur le terminal, peu importe) :
 "Voici le num√©ro du potin que tu veux : 2 !". Idem si on remplace le <code>2</code> par n'importe quelle valeur (√ßa doit marcher avec "coucou" ou autre). <br>
Seule consigne : ta variable d'URL doit s'appeler <code>:id</code> (et pas <code>:name</code>) car elle correspondra √† l'<code>id</code> du gossip qu'on veut afficher.</p>

<p>Pour les routes dynamiques, mon conseil est de "tester plus de choses
 en mettant des puts partout". Aide-toi de la communaut√© et essaie les 
solutions qui te semblent bien. Le m√©tier de d√©veloppeur est ceci la 
plupart du temps : essayer des trucs, et voir si c'est ce que tu veux 
faire.</p>

<h4>2.6.3. Find</h4>
<p>Maintenant que nous avons notre <code>id</code>, nous voudrions faire un truc comme <code>Gossip.find(id)</code> et cela nous ressortirait le bon gossip (celui qui est num√©ro <code>id</code> dans la base de donn√©es). Eh bien je t'invite √† ouvrir le fichier <code>gossip.rb</code> et d'ajouter une m√©thode <code>#find</code>,
 qui prend un param√®tre, et qui ressort le gossip correspondant. La 
beaut√© du code n'a pas d'importance, √©tant donn√© que nous allons voir 
SQL tr√®s vite, et ce sera plus simple pour le faire.</p>

<p>Une fois que, dans ton fichier <code>controller.rb</code>, le code <code>Gossip.find(id)</code> te ressort le bon potin. Utilise donc cette ligne dans la route dynamique de ton show <code>get 'gossips/:id'</code>.</p>

<p>Te voil√† pr√™t √† l'afficher le potin dans ta view !</p>

<h4>2.6.4. La vue show du potin</h4>
<p>Nous voudrions afficher une page du genre :</p>
<pre class=" language-ruby"><code class=" language-ruby"><span class="token const">PAGE</span> <span class="token const">POTIN</span>
<span class="token const">Voici</span> la page du potin n¬∞<span class="token const">X</span>
<span class="token const">Son</span> auteur <span class="token punctuation">:</span> <span class="token operator">==</span>author<span class="token operator">==</span>
<span class="token const">Le</span> contenu du potin <span class="token punctuation">:</span> <span class="token operator">==</span>content<span class="token operator">==</span>

<span class="token const">Lien</span> pour revenir √† la page des potins</code></pre>

<p>Pour faire √ßa, tu as tous les outils √† pr√©sent (inspire-toi de ce qu'on a fait avec index) ! Il te faut cr√©er un page <code>show.erb</code>, lui passer le potin, et ensuite jouer avec les balises <code>&lt;%= %&gt;</code> dans ton HTML. Et √† toi la gloire ‚ù§Ô∏è</p>

<h4>2.6.5. Pour finir : le lien</h4>
<p>Pour finir, voici la derni√®re requ√™te : dans la page d'index, ce 
serait bien que chaque potin affich√© porte un lien vers sa propre page 
show. Voici les quelques conseils pour y arriver :</p>
<ul>
  <li><code>#each_with_index</code> est ton amie</li>
  <li><code>&lt;%= %&gt;</code> pour les URLs aussi</li>
</ul>

<h3>2.7. √âditer un potin</h3>
<p>Ok, si t'es arriv√© jusqu'ici, c'est que t'es chaud aujourd'hui ! On 
va corser tout √ßa en √©tant encore moins pas √† pas... Pas de honte si tu 
n'arrives pas au bout de cette partie !</p>
<p>Nos potins sont g√©niaux, mais ce serait bien de pouvoir les √©diter : </p>
<ul>
  <li>Le concept : √† partir de la view show, un utilisateur peut cliquer sur un lien "√©diter le potin" qui renvoie sur une view <code>edit.erb</code> dont l'adresse est <code>/gossips/id/edit/</code>.</li>
  <li>Sur cette page d'edit, tu dois y mettre un formulaire qui permet 
d'√©diter le potin. Si tu n'es pas inspir√©, tu peux reprendre le m√™me que
 celui de la page new.</li>
  <li>Ce formulaire va envoyer une requ√™te en POST qui d√©clenche ensuite une m√©thode <code>#update</code> de la classe <code>Gossip</code>. Cette m√©thode va mettre √† jour le potin en base de donn√©es.</li>
</ul>

<h3>2.8. Les commentaires de potins</h3>
<p>Allez, un petit dernier exercice (pour les plus √† l'aise) avant de 
clore la journ√©e. Ce serait bien de pouvoir commenter les potins, via 
des commentaires. En gros, la page show du potin devra afficher les 
commentaires, qui seront juste des textes. Un potin peut avoir 0, 1, ou n
 commentaires. Un commentaire ne concerne qu'un seul potin, c‚Äôest-√†-dire
 que la page show du potin ne devra afficher que les commentaires du 
potin concern√©.</p>

<p>De la vue show, il est possible cr√©er un commentaire avec un simple formulaire.</p>

<p>Cet exercice n'est pas facile, et il existe plein de solutions 
diff√©rentes. Je te laisse voir avec ton √©quipe laquelle vous allez 
opter. Je vous invite √† r√©fl√©chir au comment, avant de partir t√™te 
baiss√©e dans le code.</p>

<h3>3. Rendu attendu </h3>
<p>Un repo par personne avec l'ensemble de ton application Sinatra (BDD 
comprise) et un README qui explique jusqu'o√π tu as pu aller dans le 
projet.</p>

<h4>3.1. Quelques mots pour finir</h4>
<h5>Bravo !</h5>
<p>Waow ! Tu as fait ta premi√®re application web : pour la premi√®re 
fois, tu allies du Ruby en back-end et des pages en HTML en front ! 
C'est quand m√™me impressionnant, surtout quand tu penses qu'il y a 
quelque temps, tes programmes lan√ßaient juste des pyramides de Mario ! 
√âvidemment, il y a toujours moyen d'aller plus loin dans l'application, 
et il y a encore un peu de chemin avant de faire le prochain Airbnb. 
Mais le d√©but est l√† et tu as vu les bases pour comprendre comment une 
application web marche.</p>


<h5>Les limites de ton app : la base de donn√©es</h5>
<p>M√™me si tu n'es pas arriv√© jusqu'au dernier exercice des 
commentaires, lis-le rapidement et pose-toi la question "comment 
aurais-je fais ?". Tr√®s vite tu vas r√©aliser qu'il est particuli√®rement 
ardu de lier les commentaires au potin avec un CSV/JSON. Imagine 
maintenant la gal√®re que ce sera de lier les potins aux utilisateurs 
enregistr√©s dans l'application ! C'est pour √ßa qu'√† partir de demain et 
pour le reste de la semaine, nous allons voir ensemble comment faire des
 bases de donn√©es solides, en utilisant SQL puis ActiveRecords (sur 
Rails).</p>

<p>Quand on fait une application, il est important de savoir construire 
une base de donn√©es robuste et utilisable. Aussi nous allons passer du 
temps sur ce sujet afin que tu puisses t'attaquer √† des sites complexes 
dans les meilleures conditions possibles.</p>


<h5>Les limites de ton app : Sinatra et son bas-niveau</h5>
<p>Sinatra est un super outil pour comprendre, en venant de Ruby, 
comment une application simple fonctionne. Son d√©faut est qu'il est tr√®s
 bas-niveau, et tu te retrouves √† faire pas mal de plomberie : tu cr√©es 
chaque fichier, chaque dossier, tu √©cris les routes de A √† Z, etc. 
Regarde tous les branchements que tu as d√ª faire pour ton application, 
qui √©tait pourtant tr√®s simple !</p>

<p>Un autre exemple est ton fichier <code>controller.rb</code> : si tu voulais faire un AirBnb-like, il deviendrait rapidement trop grand et impossible √† maintenir. Idem pour le dossier <code>lib/</code> qui contiendrait trop de fichiers diff√©rents. </p>

<p>C'est bien de tout ma√Ætriser, mais parfois, il est plus pr√©f√©rable 
d'avancer plus vite en laissant certaines choses s'automatiser. Sinatra 
est bien pour comprendre l'univers du web, mais quand on d√©bute 
l'informatique, tu verras qu'il est ultra agr√©able de pouvoir s'appuyer 
sur des outils comme Rails qui te m√¢che le travail de base.</p>
</div>
</div>
</div>
</div>
</div>
</div>

</div>

      </div>
    </div>

    <div class="thp-flashes"></div>



    <script src="s5j1_fichiers/dashboard-6681459c92372465340c.js"></script>
    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  

<iframe style="display: none; visibility: hidden;" owner="archetype" title="archetype"></iframe>
<script type="text/javascript" id="hs-script-loader" src="s5j1_fichiers/9310539.js"></script><script type="text/javascript" id="">(function(e,c){if(!c.__SV){var l,h;window.mixpanel=c;c._i=[];c.init=function(q,r,f){function t(d,a){var g=a.split(".");2==g.length&&(d=d[g[0]],a=g[1]);d[a]=function(){d.push([a].concat(Array.prototype.slice.call(arguments,0)))}}var b=c;"undefined"!==typeof f?b=c[f]=[]:f="mixpanel";b.people=b.people||[];b.toString=function(d){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);d||(a+=" (stub)");return a};b.people.toString=function(){return b.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<l.length;h++)t(b,l[h]);var n="set set_once union unset remove delete".split(" ");b.get_group=function(){function d(p){a[p]=function(){call2_args=arguments;call2=[p].concat(Array.prototype.slice.call(call2_args,0));b.push([g,call2])}}for(var a={},g=["get_group"].concat(Array.prototype.slice.call(arguments,0)),m=0;m<n.length;m++)d(n[m]);return a};c._i.push([q,r,f])};c.__SV=1.2;var k=e.createElement("script");k.type="text/javascript";k.async=!0;k.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=e.getElementsByTagName("script")[0];e.parentNode.insertBefore(k,e)}})(document,window.mixpanel||[]);mixpanel.init("ab79c62023f2a925bfe5f7922c70de67");mixpanel.track("Sign up");</script>
<script type="text/javascript" id="">!function(){var a=window.analytics=window.analytics||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0;a.methods="trackSubmit trackClick trackLink trackForm pageview identify reset group track ready alias debug page once off on addSourceMiddleware addIntegrationMiddleware setAnonymousId addDestinationMiddleware".split(" ");a.factory=function(b){return function(){var c=Array.prototype.slice.call(arguments);c.unshift(b);
a.push(c);return a}};for(var e=0;e<a.methods.length;e++){var f=a.methods[e];a[f]=a.factory(f)}a.load=function(b,c){var d=document.createElement("script");d.type="text/javascript";d.async=!0;d.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(d,b);a._loadOptions=c};a._writeKey="HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j";a.SNIPPET_VERSION="4.13.2";a.load("HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j");a.page()}}();</script>

</body></html>