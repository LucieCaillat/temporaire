<!DOCTYPE html>
<html class="loaded" lang="fr"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript" async="" src="s9j3_fichiers/insight.js"></script><script type="text/javascript" src="s9j3_fichiers/NRJS-71f55aa980e498e276b"></script><script src="s9j3_fichiers/nr-1212.js"></script><script type="text/javascript" async="" src="s9j3_fichiers/gtm_002.js"></script><script type="text/javascript" src="s9j3_fichiers/commons.js" async="" status="loaded"></script><script type="text/javascript" src="s9j3_fichiers/google-tag-manager.js" async="" status="loaded"></script><script type="text/javascript" async="" src="s9j3_fichiers/analytics.js"></script><script type="text/javascript" async="" src="s9j3_fichiers/mixpanel-2-latest.js"></script><script type="text/javascript" async="" src="s9j3_fichiers/conversion_async.js"></script><script type="text/javascript" async="" src="s9j3_fichiers/analytics_002.js"></script><script src="s9j3_fichiers/9310539_003.js" type="text/javascript" id="cookieBanner-9310539" data-cookieconsent="ignore" data-hs-ignore="true" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s9j3_fichiers/fb.js" type="text/javascript" id="hs-ads-pixel-9310539" data-ads-portal-id="9310539" data-ads-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s9j3_fichiers/collectedforms.js" type="text/javascript" id="CollectedForms-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s9j3_fichiers/leadflows.js" type="text/javascript" id="LeadFlows-9310539" crossorigin="anonymous" data-leadin-portal-id="9310539" data-leadin-env="prod" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script src="s9j3_fichiers/9310539_002.js" type="text/javascript" id="hs-analytics"></script><script src="s9j3_fichiers/conversations-embed.js" type="text/javascript" id="hubspot-messages-loader" data-loader="hs-scriptloader" data-hsjs-portal="9310539" data-hsjs-env="prod" data-hsjs-hublet="na1"></script><script async="" crossorigin="anonymous" src="s9j3_fichiers/fs.js"></script><script src="s9j3_fichiers/773401719499556.js" async=""></script><script async="" src="s9j3_fichiers/fbevents.js"></script><script async="" src="s9j3_fichiers/gtm.js"></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"NRJS-71f55aa980e498e276b","applicationID":"576835834","transactionName":"dgpYEBRYDg9XQh8AA0YNVAsHRQZMVlFJF01GDVkT","queueTime":3,"applicationTime":155,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-71f55aa980e498e276b",applicationID:"576835834"};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var i=e[n]={exports:{}};t[n][0].call(i.exports,function(e){var i=t[n][1][e];return r(i||e)},i,i.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,n){function r(){}function i(t,e,n,r){return function(){return s.recordSupportability("API/"+e+"/called"),o(t+e,[u.now()].concat(c(arguments)),n?null:this,r),n?void 0:this}}var o=t("handle"),a=t(10),c=t(11),f=t("ee").get("tracer"),u=t("loader"),s=t(4),d=NREUM;"undefined"==typeof window.newrelic&&(newrelic=d);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",v=l+"ixn-";a(p,function(t,e){d[e]=i(l,e,!0,"api")}),d.addPageAction=i(l,"addPageAction",!0),d.setCurrentRouteName=i(l,"routeName",!0),e.exports=newrelic,d.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(t,e){var n={},r=this,i="function"==typeof e;return o(v+"tracer",[u.now(),t,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return e.apply(this,arguments)}catch(t){throw f.emit("fn-err",[arguments,this,t],n),t}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){m[e]=i(v,e)}),newrelic.noticeError=function(t,e){"string"==typeof t&&(t=new Error(t)),s.recordSupportability("API/noticeError/called"),o("err",[t,u.now(),!1,e])}},{}],2:[function(t,e,n){function r(t){if(NREUM.init){for(var e=NREUM.init,n=t.split("."),r=0;r<n.length-1;r++)if(e=e[n[r]],"object"!=typeof e)return;return e=e[n[n.length-1]]}}e.exports={getConfiguration:r}},{}],3:[function(t,e,n){var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}catch(o){}e.exports=function(t){return r?{passive:!0,capture:!!t}:!!t}},{}],4:[function(t,e,n){function r(t,e){var n=[a,t,{name:t},e];return o("storeMetric",n,null,"api"),n}function i(t,e){var n=[c,t,{name:t},e];return o("storeEventMetrics",n,null,"api"),n}var o=t("handle"),a="sm",c="cm";e.exports={constants:{SUPPORTABILITY_METRIC:a,CUSTOM_METRIC:c},recordSupportability:r,recordCustom:i}},{}],5:[function(t,e,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=t(12);e.exports=r,e.exports.offset=a,e.exports.getLastTimestamp=i},{}],6:[function(t,e,n){function r(t){return!(!t||!t.protocol||"file:"===t.protocol)}e.exports=r},{}],7:[function(t,e,n){function r(t,e){var n=t.getEntries();n.forEach(function(t){"first-paint"===t.name?p("timing",["fp",Math.floor(t.startTime)]):"first-contentful-paint"===t.name&&p("timing",["fcp",Math.floor(t.startTime)])})}function i(t,e){var n=t.getEntries();if(n.length>0){var r=n[n.length-1];if(f&&f<r.startTime)return;p("lcp",[r])}}function o(t){t.getEntries().forEach(function(t){t.hadRecentInput||p("cls",[t])})}function a(t){if(t instanceof g&&!y){var e=Math.round(t.timeStamp),n={type:t.type};e<=l.now()?n.fid=l.now()-e:e>l.offset&&e<=Date.now()?(e-=l.offset,n.fid=l.now()-e):e=l.now(),y=!0,p("timing",["fi",e,n])}}function c(t){"hidden"===t&&(f=l.now(),p("pageHide",[f]))}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d,p=t("handle"),l=t("loader"),v=t(9),m=t(3),g=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){u=new PerformanceObserver(r);try{u.observe({entryTypes:["paint"]})}catch(h){}s=new PerformanceObserver(i);try{s.observe({entryTypes:["largest-contentful-paint"]})}catch(h){}d=new PerformanceObserver(o);try{d.observe({type:"layout-shift",buffered:!0})}catch(h){}}if("addEventListener"in document){var y=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(t){document.addEventListener(t,a,m(!1))})}v(c)}},{}],8:[function(t,e,n){function r(t,e){if(!i)return!1;if(t!==i)return!1;if(!e)return!0;if(!o)return!1;for(var n=o.split("."),r=e.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}e.exports={agent:i,version:o,match:r}},{}],9:[function(t,e,n){function r(t){function e(){t(c&&document[c]?document[c]:document[o]?"hidden":"visible")}"addEventListener"in document&&a&&document.addEventListener(a,e,i(!1))}var i=t(3);e.exports=r;var o,a,c;"undefined"!=typeof document.hidden?(o="hidden",a="visibilitychange",c="visibilityState"):"undefined"!=typeof document.msHidden?(o="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(o="webkitHidden",a="webkitvisibilitychange",c="webkitVisibilityState")},{}],10:[function(t,e,n){function r(t,e){var n=[],r="",o=0;for(r in t)i.call(t,r)&&(n[o]=e(r,t[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],11:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(i<0?0:i);++r<i;)o[r]=t[e+r];return o}e.exports=r},{}],12:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(t,e,n){function r(){}function i(t){function e(t){return t&&t instanceof r?t:t?u(t,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){t&&a&&t(n,r,i);for(var c=e(i),f=m(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[w[n]];return p&&p.push([b,n,r,c]),c}}function o(t,e){y[t]=m(t).concat(e)}function v(t,e){var n=y[t];if(n)for(var r=0;r<n.length;r++)n[r]===e&&n.splice(r,1)}function m(t){return y[t]||[]}function g(t){return p[t]=p[t]||i(n)}function h(t,e){l.aborted||s(t,function(t,n){e=e||"feature",w[n]=e,e in d||(d[e]=[])})}var y={},w={},b={on:o,addEventListener:o,removeEventListener:v,emit:n,get:g,listeners:m,context:e,buffer:h,abort:c,aborted:!1};return b}function o(t){return u(t,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=t("gos"),s=t(10),d={},p={},l=e.exports=i();e.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(t,e,n){function r(t,e,n){if(i.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return t[e]=r,r}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){i.buffer([t],r),i.emit(t,e,n)}var i=t("ee").get("handle");e.exports=r,r.ee=i},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,o,function(){return i++})}var i=1,o="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!T++){var t=P.info=NREUM.info,e=g.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(O,function(e,n){t[e]||(t[e]=n)});var n=a();c("mark",["onload",n+P.offset],null,"api"),c("timing",["load",n]);var r=g.createElement("script");0===t.agent.indexOf("http://")||0===t.agent.indexOf("https://")?r.src=t.agent:r.src=v+"://"+t.agent,e.parentNode.insertBefore(r,e)}}function i(){"complete"===g.readyState&&o()}function o(){c("mark",["domContent",a()+P.offset],null,"api")}var a=t(5),c=t("handle"),f=t(10),u=t("ee"),s=t(8),d=t(6),p=t(2),l=t(3),v=p.getConfiguration("ssl")===!1?"http":"https",m=window,g=m.document,h="addEventListener",y="attachEvent",w=m.XMLHttpRequest,b=w&&w.prototype,E=!d(m.location);NREUM.o={ST:setTimeout,SI:m.setImmediate,CT:clearTimeout,XHR:w,REQ:m.Request,EV:m.Event,PR:m.Promise,MO:m.MutationObserver};var x=""+location,O={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1212.min.js"},M=w&&b&&b[h]&&!/CriOS/.test(navigator.userAgent),P=e.exports={offset:a.getLastTimestamp(),now:a,origin:x,features:{},xhrWrappable:M,userAgent:s,disabled:E};if(!E){t(1),t(7),g[h]?(g[h]("DOMContentLoaded",o,l(!1)),m[h]("load",r,l(!1))):(g[y]("onreadystatechange",i),m[y]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var T=0}},{}],"wrap-function":[function(t,e,n){function r(t,e){function n(e,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],t)}c(n+"start",[o,a,f],s,u);try{return p=e.apply(a,o)}catch(v){throw c(n+"err",[o,a,v],s,u),v}finally{c(n+"end",[o,a,p],s,u)}}return a(e)?e:(n||(n=""),nrWrapper[p]=e,o(e,nrWrapper,t),nrWrapper)}function r(t,e,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<e.length;u++)f=e[u],c=t[f],a(c)||(t[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!v||e){var c=v;v=!0;try{t.emit(n,r,o,e,a)}catch(f){i([f,n,r,o],t)}v=c}}return t||(t=s),n.inPlace=r,n.flag=p,n}function i(t,e){e||(e=s);try{e.emit("internal-error",t)}catch(n){}}function o(t,e,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(t);return r.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(o){i([o],n)}for(var a in t)l.call(t,a)&&(e[a]=t[a]);return e}function a(t){return!(t&&t instanceof Function&&t.apply&&!t[p])}function c(t,e){var n=e(t);return n[p]=t,o(t,n,s),n}function f(t,e,n){var r=t[e];t[e]=c(r,n)}function u(){for(var t=arguments.length,e=new Array(t),n=0;n<t;++n)e[n]=arguments[n];return e}var s=t("ee"),d=t(11),p="nr@original",l=Object.prototype.hasOwnProperty,v=!1;e.exports=r,e.exports.wrapFunction=c,e.exports.wrapInPlace=f,e.exports.argsToArray=u},{}]},{},["loader"]);</script>
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="mkjhnl33qR1QUxZRysK9bOR7bYMApvqcifUU8luoZHbcGQ6yniW6yvJnc5y6Kx88Q0A6Ckn+M1dIVcRm+NZYhQ==">
    <title>Le tableau de bord | The Hacking Project</title>
<meta name="description" content="Nous cassons les codes de l'√©ducation, vous apprenez d'o√π vous voulez, en communaut√©.">
<meta name="robots" content="noindex, nofollow">
<meta property="og:title" content="Le tableau de bord">
<meta property="og:site_name" content="The Hacking Project">
<meta name="url" content="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/3">
<meta name="image" content="https://www.thehackingproject.org/packs/images/logo/20210910-THP-Logo_color_transparent-31229dd881904e010092de63be97cdfa.png">


    <link rel="apple-touch-icon" sizes="180x180" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-c01aaccf467f7cc3d79bbce743d60779f5b833fdc4500cebd07a5e11a07a5c31.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-precomposed-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.thehackingproject.org/assets/favicon/apple-touch-icon-120x120-372de868f08319961b72ba7e3b1ed7121e75e29c8294334cb2c911409ea18131.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.thehackingproject.org/assets/favicon/favicon-32x32-804b12d1c41c60fe721477b7c3b0a32811dc610580dd40ac92f1cc04cbd05ca4.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.thehackingproject.org/assets/favicon/favicon-16x16-d96ba65e5785d32474df9ebc6fbfd5442c751d527b10981a474bc3b7a4079d01.png">
<link rel="manifest" href="https://www.thehackingproject.org/assets/favicon/manifest-cf975201fd8ac78a1f1a203357573d50031f1cc33436d099743df6428b8a38a2.json">
<link rel="mask-icon" href="https://www.thehackingproject.org/assets/favicon/safari-pinned-tab-8af1cfcf7525ccdccb490f9f5adad396653a4969b419e0a9a9d3a1088140a912.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://www.thehackingproject.org/assets/favicon/favicon-cbf10361dc90b277565960736d4897fddef5468bff6299811ea9498459d56d21.ico">
<meta name="msapplication-config" content="/assets/favicon/browserconfig-dab38db6040ef54ac56e91fdd77e3d7b06746a634e87b68c99b59b216cb8611a.xml">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" media="screen" href="s9j3_fichiers/vendor-dab9e12f0ba58215899de05f149caa5f.css">
    <link rel="stylesheet" media="screen" href="s9j3_fichiers/dashboard-4ab6ba9737cbfc4c38b17a9a4de7833a.css">
    <link rel="stylesheet" media="screen" href="s9j3_fichiers/dashboard-ea5a94b9045ccb8d8ce8974b71b640603915dc183d5907c643.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="s9j3_fichiers/js.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-105991867-1');
  </script>
<!-- End Google Analytics -->

<!-- Google Tag Manager -->
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-P8XRQ3M");
</script>
<!-- End Google Tag Manager -->

<!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
         fbq('init', '773401719499556');
        fbq('track', 'PageView');
    </script>
    <noscript>
     <img height="1" width="1"
    src="https://www.facebook.com/tr?id=773401719499556&ev=PageView
    &noscript=1"/>
    </noscript>
<!-- End Facebook Pixel Code -->

<script>
window['_fs_debug'] = false;
window['_fs_host'] = 'fullstory.com';
window['_fs_script'] = 'edge.fullstory.com/s/fs.js';
window['_fs_org'] = '14AEET';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
    g=m[e]=function(a,b,s){g.q?g.q.push([a,b,s]):g._api(a,b,s);};g.q=[];
    o=n.createElement(t);o.async=1;o.crossOrigin='anonymous';o.src='https://'+_fs_script;
    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
    g.identify=function(i,v,s){g(l,{uid:i},s);if(v)g(l,v,s)};g.setUserVars=function(v,s){g(l,v,s)};g.event=function(i,v,s){g('event',{n:i,p:v},s)};
    g.anonymize=function(){g.identify(!!0)};
    g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
    g.log = function(a,b){g("log",[a,b])};
    g.consent=function(a){g("consent",!arguments.length||a)};
    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
    g.clearUserCookie=function(){};
    g.setVars=function(n, p){g('setVars',[n,p]);};
    g._w={};y='XMLHttpRequest';g._w[y]=m[y];y='fetch';g._w[y]=m[y];
    if(m[y])m[y]=function(){return g._w[y].apply(this,arguments)};
    g._v="1.3.0";
})(window,document,window['_fs_namespace'],'script','user');
</script>
<!-- Start of HubSpot Embed Code -->
<script async="" defer="defer" id="hs-script-loader" src="s9j3_fichiers/9310539.js" type="text/javascript"></script>
<!-- End of HubSpot Embed Code -->


    <script src="s9j3_fichiers/thp-3cc5aa6fdf57842a7b6c714621cc7f2d3d31b51cb700b1de4e795d773.js"></script>
    <script src="s9j3_fichiers/manifest-1613feea780cfc5342f4.js"></script>
    <script src="s9j3_fichiers/vendor-a1368cd914d9517d8b30.js"></script>
    <script src="s9j3_fichiers/dashboard-25875e14460b4458b1bccffaa93d4a8cbee9691b06d54976fde.js"></script>

    <link href="s9j3_fichiers/css.css" rel="stylesheet">
  <script src="s9j3_fichiers/a"></script></head>

  <body class="vertical-layout 2-columns fixed-navbar menu-hide vertical-overlay-menu" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns" data-thp-controller="days" data-thp-action="show" data-thp-layout="dashboard"><style type="text/css">html.hs-messages-widget-open.hs-messages-mobile,html.hs-messages-widget-open.hs-messages-mobile body{overflow:hidden!important;position:relative!important}html.hs-messages-widget-open.hs-messages-mobile body{height:100%!important;margin:0!important}#hubspot-messages-iframe-container{display:initial!important;z-index:2147483647;position:fixed!important;bottom:0!important}#hubspot-messages-iframe-container.widget-align-left{left:0!important}#hubspot-messages-iframe-container.widget-align-right{right:0!important}#hubspot-messages-iframe-container.internal{z-index:1016}#hubspot-messages-iframe-container.internal iframe{min-width:108px}#hubspot-messages-iframe-container .shadow-container{display:initial!important;z-index:-1;position:absolute;width:0;height:0;bottom:0;content:""}#hubspot-messages-iframe-container .shadow-container.internal{display:none!important}#hubspot-messages-iframe-container .shadow-container.active{width:400px;height:400px}#hubspot-messages-iframe-container iframe{display:initial!important;width:100%!important;height:100%!important;border:none!important;position:absolute!important;bottom:0!important;right:0!important;background:transparent!important}</style>
    <!-- Google Tag Manager (noscript) -->
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-P8XRQ3M' style='display:none;visibility:hidden' width='0'></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->



    <nav class="header-navbar navbar-expand-md navbar navbar-with-menu navbar-without-dd-arrow fixed-top navbar-semi-light" style="padding:0;">
<div class="navbar-wrapper">
<div class="navbar-container content">
<div class="collapse navbar-collapse show" id="navbar-mobile">
<ul class="nav navbar-nav mr-auto float-left">
<li class="nav-item mobile-menu d-md-none mr-auto">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu font-large-1"></i>
</a>
</li>
<li class="nav-item d-none d-md-block">
<a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
<i class="ft-menu"></i>
</a>
</li>
</ul>
<ul class="nav navbar-nav float-right">
<li class="dropdown dropdown-user nav-item">
<a class="dropdown-toggle nav-link dropdown-user-link" data-toggle="dropdown" href="#">
<span class="avatar avatar-online">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s9j3_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
</a>
<div class="dropdown-menu dropdown-menu-right">
<div class="arrow_box_right">
<a class="dropdown-toggle nav-link dropdown-user-link" href="https://www.thehackingproject.org/fr/dashboard/profile/user"><span class="avatar avatar-online pt-0">

<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="s9j3_fichiers/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg">

</span>
<span class="user-name text-bold-700 ml-1 text-dark">
Lucie
</span>
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit"><i class="ft-edit"></i>√âditer profil
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" href="https://www.thehackingproject.org/fr/dashboard/profile/user/edit?edit=danger"><i class="ft-alert-triangle"></i>Zone √† risques
</a><div class="dropdown-divider"></div>
<a class="dropdown-item" rel="nofollow" data-method="delete" href="https://www.thehackingproject.org/users/sign_out?locale=fr"><i class="ft-power"></i>
D√©connexion
</a></div>
</div>
</li>
</ul>
</div>
</div>
</div>
</nav>

      <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true">
<div class="navbar-header">
<ul class="nav navbar-nav flex-row">
<li class="nav-item mr-auto">
<a class="navbar-brand" href="https://www.thehackingproject.org/?locale=fr"><h3 class="brand-text">The Hacking Project</h3>
</a></li>
<li class="nav-item d-md-none">
<a class="nav-link close-navbar">
<i class="ft-x"></i>
</a>
</li>
</ul>
</div>
<div class="main-menu-content">
<ul class="navigation navigation-main" data-menu="menu-navigation" id="main-menu-navigation">
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard"><i class="ft-calendar"></i>
<span class="menu-title" data-i18n="">
Aujourd'hui
</span>
</a></li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard"><i class="ft-monitor"></i>
<span class="menu-title" data-i18n="">
Mon dashboard
</span>
</a></li>
<li class="nav-item has-sub">
<a href="#"><i class="fas fa-user-graduate"></i>
<span class="menu-title" data-i18n="">
Mon inscription
</span>
</a><ul class="menu-content">
<li>
<a href="https://www.thehackingproject.org/parcours?locale=fr">Choisir un parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/new">Nouveau parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/profile/curriculum_subscriptions/7209/edit">Changer parcours</a>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/modalites">Modalit√©s</a>
</li>
</ul>
</li>
<li class="nav-item">
<a href="https://www.thehackingproject.org/fr/dashboard/certifications"><i class="fa ft-download"></i>
<span class="menu-title" data-i18n="">
Documents
</span>
</a></li>
<br>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/help"><i class="fa ft-help-circle"></i>
<span class="menu-title" data-i18n="">
Aide
</span>
</a></li>
</ul>
</div>
</div>



    <div class="app-content content">
      <div class="content-wrapper">
        <div class="content-wrapper-before"></div>
        <div class="content-header row"></div>
        <div class="container">
<div class="row">
<div class="col-12">
<ol class="breadcrumb">
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/dashboard">Dashboard</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1">Fullstack web</a>
</li>
<li class="breadcrumb-item">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6">JavaScript de front</a>
</li>
<li class="breadcrumb-item active">
AJAX (1/2)
</li>
</ol>
</div>
</div>
<!-- / PARTIAL FOR FREE MOUSSES -->
<!-- / PARTIAL FOR NEXT -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-body">
<div class="row">
<div class="col-12 col-xl-12 text-center mb-3">
<h2 class="mb-2">
JavaScript de front
</h2>
<h3>
AJAX (1/2)
</h3>
<h4>

</h4>
<h5>
Tu vas apprendre d√©couvrir AJAX qui permet de faire des appels √† ta BDD sans rafraichir la page web.
</h5>
</div>
<div class="col-12 col-xl-12 timeline-left" id="activity">
<div class="timeline pt-2">
<ul class="list-unstyled base-timeline activity-timeline">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/1"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/1">Lundi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

R√©agir aux √©v√®nements en JS
</div>
</div>
<small class="text-muted">
JavaScript rend nos pages int√©ractives en r√©agissant aux actions de nos utilisateurs !
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/2"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/2">Mardi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journ√©e l√†"></i>

JavaScript dans une application Rails
</div>
</div>
<small class="text-muted">
Tu vas prendre tout ce que tu as fait jusqu'√† pr√©sent pour faire une 
animation en JavaScript, dans une application Rails. Moiti√© 
configuration, moiti√© JS, 100% bonheur !
</small>
</li>
<li>
<div class="timeline-icon bg-primary">
<i class="ft-map-pin font-medium-1"></i>
</div>
<div class="act-time">
Mercredi
</div>
<div class="base-timeline-info">
<div class="text-dark">

AJAX (1/2)
</div>
</div>
<small class="text-muted">
Tu vas apprendre d√©couvrir AJAX qui permet de faire des appels √† ta BDD sans rafraichir la page web.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/4"><div class="timeline-icon bg-dark">
<i class="ft-check font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/4">Jeudi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-rocket text-danger" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Projet √† rendre ce jour-l√†"></i>

AJAX (2/2)
</div>
</div>
<small class="text-muted">
Tu vas d√©couvrir l'AJAX qui permet de faire des appels √† ta BDD sans rafraichir la page web.
</small>
</li>
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/5"><div class="timeline-icon bg-dark">
<i class="ft-calendar font-medium-1"></i>
</div>
</a><div class="act-time">
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/weeks/6/days/5">Vendredi
</a></div>
<div class="base-timeline-info">
<div class="text-dark">
<i class="fa fa-pencil text-success" data-placement="bottom" data-toggle="tooltip" title="" data-original-title="Corrections cette journ√©e l√†"></i>

Travail en √©quipe et workflow Git
</div>
</div>
<small class="text-muted">
Travailler en √©quipe pour un projet d'application est diff√©rent d'un chantier. Nous allons voir comment les devs travaillent.
</small>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Les fameuses corrections qui n'arrivent que les jours concern√©s -->
<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #5E66E5">
<h1>
Ressource : 
AJAX en Rails
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/lessons/77/lesson_submissions/new"><i class="ft-edit" data-original-title="Proposer une am√©lioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>
<p>AJAX (l'acronyme de <code>Asynchronous JavaScript And XML</code> est 
une architecture qui permet de construire des applications webs 
interagissant en temps r√©el avec la base de donn√©es de l'application 
(pour cr√©er, √©diter ou supprimer des entr√©es) via le client (ton 
navigateur). Comme son nom l'indique, AJAX combine JavaScript, les 
requ√™tes HTTP asynchrones, la manipulation du DOM et un format de 
donn√©es (pour nous √ßa sera le JSON).</p>

<p>OK OK OK‚Ä¶ Je t'ai fait flipper l√† avec mes explications techniques...
 En gros, utiliser l'AJAX, √ßa te permet de faire des requ√™tes √† ta base 
de donn√©es en temps r√©el sans recharger la page HTML. L'exemple typique 
c'est Gmail : quand tu cliques sur un e-mail, celui-ci s'affiche dans 
ton navigateur sans rechargement de fen√™tre alors m√™me qu'il a d√ª all√© 
le chercher en BDD.</p>

<h2>2. Historique et contexte</h2>
<p>Jusqu'√† la fin des ann√©es 90, la plupart des sites web √©taient 
compos√©s uniquement de pages HTML et d'un peu de CSS (qui venait d'√™tre 
fra√Æchement int√©gr√©). Chaque action de l'utilisateur (un clic) sur le 
site lan√ßait une redirection vers une nouvelle URL et n√©cessitait que la
 page soit recharg√©e depuis le serveur. Ce processus avait deux points 
n√©gatifs majeurs :</p>
<ul>
  <li>C'est assez inefficace en termes de performance : pour chaque 
action, tout le contenu de la page doit √™tre charg√© √† nouveau depuis le 
serveur alors que seule une partie des donn√©es a chang√© ;</li>
  <li>L'exp√©rience utilisateur est mauvaise : tout le contenu de la page
 dispara√Æt, le site charge et ensuite la nouvelle page s'affiche.</li>
</ul>
<p>Au d√©but des ann√©es 2000, des entreprises comme Google ont commenc√© √†
 d√©ployer des applications type Gmail ou Google Maps qui respectaient ce
 qui allait devenir un des nouveaux standards du web : AJAX. Le terme 
vient de Jesse Garret dans un article intitul√© <a href="https://www.researchgate.net/publication/244417314_Ajax_A_New_Approach_to_Web_Applications" target="_blank">Ajax: A New Approach to Web Applications</a>. En avril 2006, AJAX devient officiellement un standard reconnu par le W3C.</p>

<p>Il est donc primordial que tu connaisses le fonctionnement de l'AJAX 
au sein d'une app Rails. Mais garde en t√™te que dans tout projet Rails 
que tu feras, l'AJAX fait partie des fonctionnalit√©s "nice to have" √† 
d√©velopper en dernier. Elle acc√©l√®re la navigation sur ton site web mais
 avant de l'impl√©menter, assure-toi d'abord que ton site fonctionne 
bien. Pourquoi am√©liorer l'exp√©rience utilisateur s'il n'y a rien √† 
exp√©rimenter ?</p>


<h2>3. La ressource</h2>
<h3>3.1. C'est quoi AJAX sur Rails ?</h3>
<p>Quand un utilisateur navigue sur ton app Rails, tu lui affiches des 
informations venant de ta BDD. Le principe de fonctionnement, tu le 
connais par c≈ìur maintenant :</p>
<ol>
  <li>Une page HTML se charge chez l'utilisateur ;</li>
  <li>Celui-ci clique sur un lien (un texte / un bouton / etc.) sur la 
page afin de voir d'autres informations ou de modifier une donn√©e ;</li>
  <li>Son clic sur un lien de l'app Rails envoie une requ√™te HTTP (= une URL + une action du genre GET/POST/DELETE/PUT) au serveur ;</li>
  <li>Le serveur regarde les routes et interpr√®te la requ√™te. Il 
d√©termine alors quel contr√¥leur va traiter la requ√™te et quelle m√©thode 
(au sein de ce controller) doit s'ex√©cuter ;</li>
  <li>La m√©thode du contr√¥leur s'ex√©cute (= elle bosse avec <code>params</code>,
 fait des appels en BDD via les models, etc.) et stocke les infos de la 
BDD dans les variables puis balance les variables Ruby obtenues √† une 
view ;</li>
  <li>La view (un fichier <code>html.erb</code>) r√©cup√®re les variables 
Ruby, construit la page HTML en fonction du code Ruby qu'elle contient 
et balance le r√©sultat √† l'utilisateur ;</li>
  <li>A ce moment-l√†, la page de l'utilisateur se recharge et il voit le
 r√©sultat de son action : l'info de la BDD lui a √©t√© transmise üí™üéÜ !</li>
</ol>

<p>Et en AJAX, on va suivre un processus identique au d√©but mais qui va 
changer APRES le passage au controller. En gros, voil√† ce qu'il se passe
 quand on bosse en AJAX (<span style="color: green;">j'ai mis les diff√©rences avec le processus habituel, ci-dessous, en vert</span>) :</p>

<ol>
  <li>Une page HTML se charge chez l'utilisateur ;</li>
  <li>Celui-ci clique sur un lien (un texte / un bouton / etc.) sur la 
page afin de voir d'autres informations ou de modifier une donn√©e ;</li>
  <li>Son clic sur un lien de l'app Rails envoie une requ√™te HTTP (= une URL + une action du genre GET/POST/DELETE/PUT) au serveur <span style="color: green;">et cette requ√™te contient un petit param√®tre en plus disant "je suis une requ√™te de type AJAX"</span> ;</li>
  <li>Le serveur regarde les routes et interpr√®te la requ√™te. Il 
d√©termine alors quel contr√¥leur va traiter la requ√™te et quelle m√©thode 
(au sein de ce controller) doit s'ex√©cuter ;</li>
  <li>La m√©thode du contr√¥leur s'ex√©cute (= elle bosse avec <code>params</code>,
 fait des appels en BDD via les models, etc.) et stocke les infos de la 
BDD dans les variables puis balance les variables Ruby obtenues <span style="color: green;">non pas √† une view mais <b>√† un fichier JavaScript </b></span> ;</li>
  <li><span style="color: green;">Le fichier JavaScript (un fichier <code>.js.erb</code>) </span> r√©cup√®re les variables Ruby, <span style="color: green;">et va s'ex√©cuter afin de modifier le DOM <b>de la page HTML d√©j√† affich√©e chez l'utilisateur</b></span> ;</li>
  <li>A ce moment-l√†, la page de l'utilisateur <span style="color: green;">se modifie devant ses yeux √©bahis et sans rechargement. Des informations sont rajout√©es et affich√©es</span>. Il voit le r√©sultat de son action : l'info de la BDD lui a √©t√© transmise üí™üéÜ !</li>
</ol>

<p>Donc si tu as bien compris, <b>l'AJAX c'est juste un protocole qui 
permet √† l'utilisateur de faire des requ√™tes n‚Äôappelant pas un nouveau 
fichier HTML mais plut√¥t un fichier JavaScript qui modifie le HTML 
existant</b>. Ce fichier JS est ex√©cut√© apr√®s un passage par une route 
normale de l'app Rails : une m√©thode d'un controller s'est ex√©cut√©e et a
 permis de r√©cup√©rer des infos en BDD. <b>Ces infos sont ensuite ins√©r√©es dans la page d√©j√† affich√©e</b>.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">ü§ì QUESTIONS R√âCURRENTES</h4>
      <p class="card-text"><b>C'est quoi le lien entre AJAX et JQuery ?</b><br>
        AJAX et JQuery n'ont rien √† voir (sauf que les deux utilisent 
JS). Ne les confondez pas ! AJAX est plus un protocole et il est tr√®s 
utilis√©. JQuery est une librairie et n'a pas beaucoup d'avenir.</p>
      <p class="card-text"><b>Donc AJAX permet d'ex√©cuter des fichiers JS sur du HTML ? Mais on sait d√©j√† faire non ?</b><br>
        Pas exactement. AJAX permet d'ex√©cuter un fichier JS √† qui tu as
 pass√© une nouvelle info extraite de la BDD (gr√¢ce au passage par un 
controller). Les fichiers JS que tu ex√©cutais jusque-l√† n'ont pas acc√®s √†
 la BDD : ils peuvent modifier la page HTML d√©j√† affich√©e mais pas y 
rajouter une info pr√©sente en BDD.</p>

    </div>
  </div>
</div>

<h3>3.2. AJAX et Rails en pratique</h3>

<p>Comment mettre AJAX sur son application ? Le processus est simple, il suffit de ne pas oublier d'√©tape.</p>

<h4>3.2.1. √âtape 1 : travailler sur un lien HTML classique mais fonctionnel</h4>
<p>Pour un d√©butant en AJAX, c'est le point de d√©part : tu as un lien 
HTML classique qui, s'il est cliqu√©, renvoie vers un controller et sa 
m√©thode. Une fois cela ex√©cut√©, la page HTML se recharge et la nouvelle 
view s'affiche avec les nouvelles informations demand√©es. Ce lien HTML 
peut √™tre √©galement le bouton <code>Submit</code> d'un formulaire.</p>

<p>L'objectif d'AJAX √©tant de ne recharger qu'une partie de la page 
affich√©e, on ne peut pas appliquer l'AJAX √† n'importe quel lien : il 
faut que celui-ci mette √† jour une information de la page HTML d√©j√† 
charg√©e. Un lien qui fait passer √† une page compl√®tement diff√©rente 
n'aurait pas de sens en AJAX : il faut tout recharger en HTML de toute 
fa√ßon. Voici des exemples de cas qui seraient de bons candidats √† un 
lien AJAX :</p>
<ul>
  <li>Tu es sur la page <code>Edit</code> d'un livre auquel tu peux 
rajouter un Tag comme "com√©die", "drame", "action", etc. Un 
mini-formulaire te propose de choisir un tag dans une liste puis de 
cliquer sur "submit". <br>
  =&gt; AJAX te permettrait de rajouter le nouveau tag en cliquant sur "submit" : le tag s'affiche sans recharger ta page.</li>
  <li>Sur la page <code>index</code> listant plusieurs livres, tu as un petit formulaire te permettant de rajouter un livre √† la liste. <br>
    =&gt; AJAX te permettrait de rajouter ce nouveau livre en 
remplissant les champs puis en cliquant sur "create" : le nom du nouveau
 livre s'ajoute alors en bas de la liste sans recharger la page.</li>
</ul>

<p>Quoi qu‚Äôil en soit, avant de les passer en AJAX, il faut que ces 
boutons fonctionnent avec le processus HTML classique : tu cliques 
dessus, la page se recharge et la nouvelle information est affich√©e 
(tout √ßa gr√¢ce √† un passage par un controller qui a fait les bonnes 
requ√™tes en BDD).</p>


<h4>3.2.2. √âtape 2 : indiquer que le lien va suivre le protocole AJAX</h4>
<p>Pour transformer notre lien HTML en un "lien AJAX", il faut rajouter un petit param√®tre √† ton lien ou √† ton formulaire : <code>remote : true</code>. <a href="https://edgeguides.rubyonrails.org/working_with_javascript_in_rails.html#built-in-helpers">Cette partie de la doc Rails</a> explique comment rajouter ce param√®tre. Voici deux exemples avec les helpers <code>link_to</code> et <code>form_tag</code> : </p>
<ul>
  <li>Dans le cas d'un lien simple, il est pr√©sent √† la fin:</li>
<pre class=" language-ruby"><code class=" language-ruby">&lt;%<span class="token operator">=</span> link_to <span class="token string">"D√©j√† Lu"</span><span class="token punctuation">,</span> read_path<span class="token punctuation">,</span> <span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">"btn btn-primary"</span><span class="token punctuation">,</span> remote<span class="token punctuation">:</span> <span class="token keyword">true</span> %&gt;</code></pre>
  <li>Dans le cas d'un formulaire <code>form_tag</code>, on le retrouve dans l'en-t√™te:</li>
<pre class=" language-ruby"><code class=" language-ruby">&lt;%<span class="token operator">=</span> form_tag<span class="token punctuation">(</span>root_path<span class="token punctuation">,</span> <span class="token symbol">:id</span> <span class="token operator">=</span>&gt; <span class="token string">'form_tag_with_remote_true'</span><span class="token punctuation">,</span> remote<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">)</span> <span class="token keyword">do</span> %&gt;
 <span class="token comment">#le code de ton formulaire
</span>&lt;%<span class="token operator">=</span> submit_tag <span class="token string">'save'</span><span class="token punctuation">,</span> <span class="token symbol">:name</span> <span class="token operator">=</span>&gt; <span class="token string">'commit'</span>%&gt;
&lt;% <span class="token keyword">end</span> %&gt;</code></pre>
</ul>

<p>Pour info, ce param√®tre <code>remote: true</code> dans tes helpers va (une fois converti en HTML chez l'utilisateur) rajouter l'option <code>data-remote="true"</code> dans ton formulaire ou ton lien et faire dispara√Ætre l'authenticity_token. <code>data-remote="true"</code> signifie qu'au lieu de soumettre ton formulaire de mani√®re classique, il sera soumis de mani√®re asynchrone via AJAX.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p>Il est possible d'utiliser <code>remote: true</code> avec d'autres helpers de Rails : button_tag, form_for, etc...</p>
      <p>Il existe m√™me un helper de formulaire qui part du principe que tu vas utiliser AJAX et pour lequel <code>remote :true</code> est d√©j√† activ√© (inutile de le rajouter donc) : c'est <code>form_with</code>.</p>
    </div>
  </div>
</div>


<h4>3.2.3. √âtape 3 : permettre au controller de renvoyer vers un fichier JS</h4>
<p>Quand on clique sur un lien / bouton ayant un <code>remote: true</code>, on va suivre la route habituelle (la m√™me que sans <code>remote: true</code>) et finir sur une m√©thode de controller. Celle-ci s'ex√©cute alors normalement. <b>Le c≈ìur du code de la m√©thode n'a pas besoin d'√™tre chang√© : s'il marchait avant, il marchera ensuite en AJAX</b>.
 La seule diff√©rence est la fin du code de la m√©thode : il faut rajouter
 une sorte d'aiguilleur au controller. Cela permettra : </p>

<ul>
  <li>Qu'il renvoie vers une view <code>html.erb</code> si la requ√™te initiale √©tait "classique" (sans <code>remote: true</code>)</li>
  <li>Qu'il renvoie vers un fichier <code>js.erb</code> si la requ√™te initiale √©tait en AJAX (avec <code>remote: true</code>)</li>
  <li>Qu'il renvoie du <code>JSON</code> dans certains cas (on en parlera pas ici, mais c'est utile quand tu codes une API en Rails)</li>
</ul>

<p>Cet "aiguilleur", c'est le code ci-dessous. Il va permettre au 
controller de fonctionner avec des requ√™tes classiques comme des 
requ√™tes AJAX : </p>
<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token const">NomDeMethode</span>
<span class="token comment">#code de la m√©thode
</span>
respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
  format<span class="token punctuation">.</span>html <span class="token keyword">do</span> 
    <span class="token comment">#code en cas de requ√™te classique 
</span>  <span class="token keyword">end</span>

  format<span class="token punctuation">.</span>js <span class="token keyword">do</span>
    <span class="token comment">#code en cas de requ√™te AJAX
</span>  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">ü§ì QUESTION R√âCURRENTE</h4>
      <p>Pourquoi avoir un <code>respond_to html</code> ?</p>
      <p>Il faut pr√©voir l'√©ventualit√© o√π le navigateur de l'utilisateur a d√©sactiv√© JavaScript ou bien ne le supporte pas.</p>
    </div>
  </div>
</div>

<h4>3.2.4. √âtape 4 : √©crire le JavaScript qui va ins√©rer l'info dans la page</h4>
<p>A ce stade, le controller a fait son travail et on dispose de variables Ruby (par exemple <code>@book</code>) contenant les infos de la BDD. Il reste √† afficher les infos de ces variables dans la page HTML via un fichier <code>js.erb</code>.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">ü§ì QUESTION R√âCURRENTE</h4>
      <p>Mais je le cr√©e comment ce fichier <code>js.erb</code>?</p>
      <p>Il faut te rappeler que :</p>
      <ol>
        <li>La convention pour nommer ce fichier est "nom de la m√©thode du controller" + ".js.erb". Quelques exemples : <code>show.js.erb</code>, <code>update.js.erb</code>, <code>credit.js.erb</code>, etc.</li>
        <li>Ce fichier doit √™tre situ√© <b>dans le m√™me dossier que les views du controller</b>.</li>
      </ol>
    </div>
  </div>
</div>

<p>C'est √† toi de cr√©er ce fichier puis de le coder. Tout comme tu peux mettre du Ruby dans tes views, tu pourrais faire des <code>&lt;%=@book.title %&gt;</code>
 au milieu de ton code JS. Tu pourras aussi appeler des partials, passer
 des variables et combiner cela √† la puissance du JavaScript.</p>

<p>Globalement, voil√† ce que va contenir <b>a minima</b> ton fichier <code>js.erb</code> :</p>
<ul>
  <li>Un s√©lecteur qui va chercher l'√©l√©ment du DOM √† modifier ;</li>
  <li>Un morceau HTML que le code va rajouter (il est pr√©f√©rable de le 
mettre sous forme de partial pour ne pas noyer ton code JS avec du 
HTML).</li>
</ul>

<p>√áa pourrait donner quelque chose comme cela: </p>

<pre class=" language-javascript"><code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"books"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token string">"&lt;%= escape_javascript(render "</span>book<span class="token string">", book: @book) %&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"book created"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p>Mais que fait ce script ? C'est tr√®s simple : il va s√©lectionner l'√©l√©ment du DOM (portant l'id <code>books</code>) et va lui rajouter la partial <code>_book.html.erb</code> (pour rappel, une partial c'est un morceau de ficher <code>html.erb</code>) auquel on envoie la variable <code>@book</code>. Puis il va afficher une alerte JavaScript qui te dira "book created"</p>

<p>A quoi sert le <code>escape_javascript</code> ? Lis ci-dessous.</p>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">‚ö†Ô∏è ALERTE ERREUR COMMUNE</h4>
      <p>Lorsque l'on √©crit des scripts pour AJAX, il y a deux points √† valider :</p>
      <ol>
        <li>Le JavaScript √©crit est valide ;</li>
        <li>On ne va pas avoir de bugs avec les caract√®res sp√©ciaux.</li>
      </ol>

      <p>La premi√®re partie du script <code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"books"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token string">"&lt;%= ... %&gt;"</span><span class="token punctuation">)</span></code> est du JavaScript avec de l'erb.</p>
      <p>Cela signifie que le contenu de la balise <code>&lt;%= ... %&gt;</code>
 est du code Ruby et il sera remplac√© par ce que l'ex√©cution de ce code 
donnera : il faut absolument que ce soit du JavaScript valide, sinon il y
 aura bug.</p>

      <p>Ainsi peu importe le code Ruby g√©n√©r√© dans cette balise, il sera forc√©ment entour√© de guillemets <code>"</code> et le JavaScript g√©n√©r√© ressemblera √† √ßa <code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"books"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span></code></p>

      <p>Maintenant, examinons le contenu √† l'int√©rieur de votre balise erb <code>&lt;%= .. %&gt;</code>. Si ton code rend une partial, alors il peut contenir tout et n'importe quoi : de l'HTML, du CSS (avec les balises <code>&lt;style&gt;</code>), voir m√™me du JavaScript (avec les balises <code>&lt;script&gt;</code>)!</p>
      <p>Imaginons que le contenu de ta partiale soit le suivant <code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/books/show<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Show my book<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span> </code>.</p>

      <p>Au final, le code JS qui sera ex√©cut√© va √™tre <code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"books"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token string">"&lt;a href="</span><span class="token operator">/</span>books<span class="token operator">/</span>show<span class="token string">"&gt;Show my book&lt;/a&gt;"</span><span class="token punctuation">)</span></code> : tu vois le souci avec les guillemets ? On avait des guillemets dans la partial qui vont se "coupler" avec les guillemets de <code class=" language-javascript"><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span></code>. Tout √ßa va compl√®tement bugger.</p>

      <p>Pour √©viter cela, Rails a un outil magique : tu rajoutes <code>escape_javascript</code> derri√®re ton <code>render</code>
 de partial et c'est bon ! Pour info, cette commande permet d'√©chapper 
les caract√®res sp√©ciaux pour que notre string ne casse pas tout. 
Concr√®tement voil√† ce qu'elle produit avec le code Ruby du partial : <code class=" language-html">&lt;a href=\"/books/show\"&gt;Show my book<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></code>.</p>
    </div>
  </div>
</div>

<p>Et voil√† ! AJAX devrait √† pr√©sent √™tre fonctionnel sur ta page : <a href="https://www.youtube.com/watch?v=pAPQ7RMYyWI" target="_blank">√† nous la libert√© !</a></p>

<h3>3.3. Impl√©menter AJAX : exemple pas √† pas </h3>
<p>Voici un pas √† pas rapide pour te montrer comment faire de l'AJAX 
avec Rails. Fais l'exercice avec nous afin de visualiser le travail √† 
fournir !</p>

<h4>3.3.0. Mise en place de l'app de test</h4>

<p>Pour notre pas √† pas, nous allons prendre l'exemple d'une application
 Rails ultra-basique permettant de lister des livres. D'abord on va 
cr√©er notre app :</p>

<pre class=" language-bash"><code class=" language-bash">$ rails new test-ajax-rails -d postgresql</code></pre>

<p>Va dans son r√©pertoire <code>$ cd test-ajax-rails</code>et cr√©e un mod√®le <code>Book</code> :</p>
<pre class=" language-bash"><code class=" language-bash">$ rails g model Book title:string author:string</code></pre>

<p>G√©n√®re √©galement le controller <code>Books</code> et la vue index :</p>
<pre class=" language-bash"><code class=" language-bash">$ rails g controller books index </code></pre>

<p>Maintenant, mettons en place les routes de base en allant dans <code>config/routes.rb</code> et en changeant <code>get 'books/index'</code> par :</p>

<pre class=" language-ruby"><code class=" language-ruby">root "books<span class="token comment">#index"
</span>resources <span class="token symbol">:books</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:create</span><span class="token punctuation">,</span> <span class="token symbol">:index</span><span class="token punctuation">]</span></code></pre>

<p>Pour que la base de donn√©es ne soit pas vide, fais un mini-seed avec 5
 livres via Faker. Rajoute d'abord la gem dans le Gemfile, <code>$ bundle install</code> puis mets dans ton <code>db/seeds.rb</code> :</p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token number">5</span><span class="token punctuation">.</span>times <span class="token keyword">do</span> 
  <span class="token const">Book</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>author<span class="token punctuation">:</span> <span class="token const">Faker</span><span class="token punctuation">:</span><span class="token symbol">:Book</span><span class="token punctuation">.</span>author<span class="token punctuation">,</span> title<span class="token punctuation">:</span> <span class="token const">Faker</span><span class="token punctuation">:</span><span class="token symbol">:Book</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
<span class="token keyword">end</span></code></pre>

<p>Et il ne reste plus qu'√† cr√©er la base de donn√©es, passer les 
migrations du model et faire notre seed. Le tout en une seule ligne OKLM
 üòé :</p>
<pre class=" language-bash"><code class=" language-bash">$ rails db:create db:migrate db:seed</code></pre>

<h4>3.3.1. √âtape 1 : travailler sur un lien HTML classique mais fonctionnel </h4>
<p>On va mettre en place une page <code>index</code> de base qui va 
afficher l'ensemble des livres cr√©√©s en base de donn√©es et donner acc√®s √†
 un formulaire permettant de rajouter un livre. Avant de faire √ßa en 
AJAX, faisons-le de fa√ßon classique.</p>

<p>La m√©thode <code>index</code> du controller <code>Books</code> va me mettre √† disposition de sa view tous les livres de la BDD :</p>
<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> index
  <span class="token inst-var">@books</span> <span class="token operator">=</span> <span class="token const">Book</span><span class="token punctuation">.</span>all
<span class="token keyword">end</span></code></pre>

<p>Et ensuite, on les affiche (un peu salement certes) sur la view <code>index.html.erb</code> :</p>

<pre class=" language-html"> <code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Books#index<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>book-list<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  &lt;% @books.each do |book| %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>"&lt;%= book.title %&gt;" by <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>&lt;%= book.author  %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  &lt;% end %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span></code></pre>

<p>Toujours dans la view, et √† la suite de ce code, rajoute le formulaire permettant de cr√©er un nouveau livre en BDD :</p>
<pre class=" language-ruby"><code class=" language-ruby">&lt;div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form"</span>&gt;
  &lt;%<span class="token operator">=</span> form_tag<span class="token punctuation">(</span>books_path<span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token symbol">:post</span><span class="token punctuation">,</span> <span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">"form"</span><span class="token punctuation">)</span> <span class="token keyword">do</span> %&gt;
    &lt;label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"title"</span>&gt;<span class="token const">Title</span>
    &lt;%<span class="token operator">=</span> text_field_tag  <span class="token symbol">:title</span> %&gt;

    &lt;label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"author"</span>&gt;author
    &lt;%<span class="token operator">=</span> text_field_tag  <span class="token symbol">:author</span> %&gt;

    &lt;%<span class="token operator">=</span> submit_tag <span class="token string">'create'</span><span class="token punctuation">,</span> <span class="token symbol">:name</span> <span class="token operator">=</span>&gt; <span class="token string">'commit'</span>%&gt;
  &lt;% <span class="token keyword">end</span> %&gt;
&lt;<span class="token operator">/</span>div&gt;</code></pre>

<p>Pour que le formulaire marche, mets √† jour la m√©thode <code>create</code> du controller <code>Books</code> :</p>
<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> create
  <span class="token inst-var">@book</span> <span class="token operator">=</span> <span class="token const">Book</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>book_params<span class="token punctuation">)</span>
  redirect_to books_path
<span class="token keyword">end</span>

private

<span class="token keyword">def</span> book_params
  params<span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:title</span><span class="token punctuation">,</span> <span class="token symbol">:author</span><span class="token punctuation">)</span>
<span class="token keyword">end</span></code></pre>

<p>A ce stade, tout devrait fonctionner. Je t'invite donc √† lancer ton 
serveur et √† v√©rifier, en cr√©ant 2 ou 3 livres, que l'index des livres 
s'affiche bien et qu'on peut cr√©er un nouveau livre via le formulaire.</p>

<p>Et maintenant, place √† l'AJAX : nous allons faire en sorte que l'ajout d'un livre se fasse sans rechargement de page !</p>

<h4>3.3.2. √âtape 2 : indiquer que le lien va suivre le protocole AJAX</h4>
<p>Cette premi√®re √©tape est rapide : il suffit de rajouter <code>remote : true</code> au formulaire. Change donc l'en-t√™te de ton <code>form_tag</code> pour qu'elle ressemble √† √ßa : </p>

<pre class=" language-ruby"><code class=" language-ruby">&lt;%<span class="token operator">=</span> form_tag<span class="token punctuation">(</span>books_path<span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token symbol">:post</span><span class="token punctuation">,</span> <span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">"form"</span><span class="token punctuation">,</span> remote<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">)</span> <span class="token keyword">do</span> %&gt;</code></pre>

<h4>3.3.3. √âtape 3 : permettre au controller de renvoyer vers un fichier JS</h4>
<p>Apr√®s l'ajout de <code>remote: true</code>, le formulaire renvoie vers la m√©thode <code>create</code> du controller <code>Books</code> en lui disant "coucou, je suis de l'AJAX !". Il faut lui dire comment r√©agir ! Rajoutons l'aiguilleur <code>respond_to</code>. Voici le nouveau code de ta m√©thode <code>create</code> : </p>

<pre class=" language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> create
    <span class="token inst-var">@book</span> <span class="token operator">=</span> <span class="token const">Book</span><span class="token punctuation">.</span>create<span class="token punctuation">(</span>book_params<span class="token punctuation">)</span>

    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> redirect_to books_path <span class="token punctuation">}</span>
      format<span class="token punctuation">.</span>js <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span></code></pre>

<p>Tu noteras que pour le cas de l'AJAX, apr√®s <code>format.js</code>, 
je n'ai mis aucune instruction. En effet, il n'y a rien de particulier √†
 faire : Rails sait, par convention, qu'il doit ex√©cuter le fichier <code>create.js.erb</code> qu'il cherchera dans le dossier <code>app/views/books/</code>. Charge √† nous de cr√©er ce fichier (ne le fais pas pour le moment).</p>

<h4>3.3.4. √âtape 4 : √©crire le JavaScript qui va ins√©rer l'info dans la page</h4>

<h5>a) Quelques petits tests pr√©alables</h5>
<p>Essaye, √† ce stade, de lancer ton serveur et de cr√©er un nouveau 
livre. Rien ne devrait se passer quand tu cliques sur "create", m√™me pas
 une erreur. Par contre si tu vas dans le terminal o√π tu as lanc√© ton 
serveur, tu devrais voir appara√Ætre la mention :</p>

<pre class=" language-bash"><code class=" language-bash">No template found for BooksController#create, rendering head :no_content</code></pre>

<p>Ce message indique juste qu'il n'a pas trouv√© le fichier <code>app/views/books/create.js.erb</code>, donc il ne fait rien de particulier.</p>

<p>Maintenant fais un petit rafra√Æchissement de ta page web (F5). 
Horreur : tu as bien cr√©√© un livre √† chaque fois que tu cliquais sur 
"Create", simplement ils ne s'affichaient pas ! Eh oui : la m√©thode <code>create</code> a bien √©t√© ex√©cut√© √† chaque clic, m√™me si elle ne d√©bouchait sur rien du tout (en l'absence de fichier JS). Simplement, le <code>respond_to</code> redirigeait vers un fichier JS inexistant et donc ne donnait pas l'ordre au navigateur de se rafra√Æchir...</p>

<p>Voil√† pourquoi il ne faut jamais faire les choses √† moiti√©‚Ä¶ On va aller au bout et tu vas donc cr√©er le fichier <code>app/views/books/create.js.erb</code> et mettre le code suivant dedans :</p>

<pre class=" language-javascript"><code class=" language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"le fichier JS est ex√©cut√©!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p>Essaye maintenant de cr√©er un nouveau livre avec le formulaire : tu 
devrais voir appara√Ætre la pop-up d'alerte ! La cha√Æne est bien en place
 : le fichier <code>create.js.erb</code> que tu viens de cr√©er est bien 
ex√©cut√© üéâ  Et si tu fais √† nouveau un rafra√Æchissement (F5), tu vois 
qu'un nouveau livre a bien √©t√© rajout√© en BDD...</p>

<p>Allez, fini la rigolade : on va pouvoir coder en JavaScript tout ce qu'il faut pour que chaque livre cr√©√© s'ajoute √† la liste.</p>

<h5>b) Le code JS de base</h5>
<p>On veut que notre fichier JS modifie le DOM de la page afin 
d'ajouter, √† la fin de la liste portant l'id "book", le nom de notre 
nouveau livre. Voil√† le code qui fait cela (ajoute-le √† <code>create.js.erb</code>) :</p>

<pre class=" language-javascript"><code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"book-list"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">"beforeend"</span><span class="token punctuation">,</span> <span class="token string">"&lt;li&gt;nouveau livre &lt;/li&gt;"</span><span class="token punctuation">)</span></code></pre>

<p>En gros, <code>document.getElementById("book-list")</code> permet de pointer sur la liste en <code>&lt;ul&gt;</code> et la fonction <code>insertAdjacentHTML("beforeend", El√©mentHTML)</code> permet de rajouter un √©l√©ment HTML √† la fin de cette liste, juste apr√®s son dernier enfant (= son dernier <code>&lt;li&gt;</code>).</p>

<p>Lance le serveur et essaye d'ajouter un nouveau livre. Tu devrais 
voir qu'un nouveau bullet-point "* nouveau livre" s'ajoute bien √† la 
liste chaque clic‚Ä¶sauf qu'il ne contient pas encore le contenu souhait√© 
(le titre et l'auteur du livre). Si tu rafra√Æchis ta page HTML, tu 
verras que les livres ont bien √©t√© cr√©√©s en BDD, simplement le fichier 
JS ne les affiche pas encore bien.</p>

<h5>c) La partial qui ajoute le bon HTML</h5>
<p>Maintenant on va s'arranger pour que le BON couple titre + auteur 
soit ajout√© √† la liste par le fichier JS. Pour √ßa, et pour √©viter de 
mettre plein de HTML dans notre <code>create.js.erb</code>, on va cr√©er une partial : un fichier <code>app/views/books/_book.html.erb</code>. Dedans, on met le code <code>html.erb</code> qui doit √™tre rajout√© en AJAX :</p>

<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>"&lt;%= book.title %&gt;" by <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>&lt;%= book.author  %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span></code></pre>

<p>Cette partial fait appel √† une variable ruby s'appelant <code>book</code>. On va appeler la partial via <code>create.js.erb</code> en lui passant la bonne valeur de variable. Tout √ßa gr√¢ce au code suivant : <code>&lt;%= render 'book', book: @book %&gt;</code>. Bien s√ªr, on a d√©j√† le r√©flexe d'utiliser <code>escape_javascript</code> avant... ou plut√¥t sa version ultra-raccourcie : <code>j</code>. Voici ce que donne le contenu de <code>create.js.erb</code> :</p>

<pre class=" language-javascript"><code class=" language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"book-list"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">"beforeend"</span><span class="token punctuation">,</span> <span class="token string">"&lt;%= j render 'book', book: @book %&gt;"</span><span class="token punctuation">)</span></code></pre>

<p>ENFIN ! Tu peux tester le tout ! Lance ton serveur et observe la 
puissance d'AJAX : le livre est ajout√© instantan√©ment, sans chargement 
HTML. Bien jou√© !!</p>


<h2>4. Points importants √† retenir</h2>
<p>AJAX est un protocole qui permet √† l'utilisateur de faire des 
requ√™tes n‚Äôappelant pas un nouveau fichier HTML mais un fichier 
JavaScript qui modifie le HTML existant. Ainsi les nouvelles 
informations peuvent √™tre rajout√©es √† la page existante par modification
 du DOM et sans recharger tout.</p>
<p>Pour impl√©menter AJAX sous Rails, il y a 4 √©tapes √† respecter :</p>
<ol>
  <li>Partir d'une requ√™te classique (Rajout d'info en rechargeant la page) qui fonctionne ;</li>
  <li>Ajouter <code>remote: true</code> √† ton formulaire ou ton lien ;</li>
  <li>Ajouter le <code>respond_to</code> √† la fin de ta m√©thode de controller pour pr√©voir les deux cas d'utilisations : HTML ou AJAX ;</li>
  <li>√âcrire le code JavaScript dans un fichier <code>nom_methode.js.erb</code> qui va ex√©cuter le code JavaScript n√©cessaire √† l'ajout de l'info (modif du DOM).</li>
</ol>

<p>Il est conseill√© de bosser avec des partials qui contiennent le morceau de code <code>html.erb</code> √† rajouter √† la page. Cela √©vite de m√©langer HTML/CSS et ton code JS.</p>

<p>Si ton fichier <code>js.erb</code> affiche un partial, pense √† utiliser la commande <code>escape_javascript</code> (ou sa version raccourcie <code>j</code>)
 pour que les caract√®res sp√©ciaux du partial ne fassent pas bugger ton 
code JS. Si tu ne le fais pas, tu n'as plus qu'√† croiser les doigts et 
esp√©rer que √ßa ne buggue pas : "Alea AJAX Est" üé≤ </p>

<h2>5. Pour aller plus loin</h2>
<p>Regarde la gem <a href="https://github.com/plataformatec/responders" target="_blank">Responder</a> qui permet de DRY ton compte en supprimant les respond_to</p>
<p>Lis cet <a href="https://m.patrikonrails.com/rails-5-1s-form-with-vs-old-form-helpers-3a5f72a8c78a" target="_blank">article</a> sur les <code>form_with</code> : l'√©quivalent de form_tag avec un <code>remote: true</code> d√©j√† int√©gr√©</p>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="row">
<div class="col-12">
<div class="card">
<div class="card-header" style="border-top: 3px solid #FF4081">
<h1>
Projets : 
To do List with Ajax
</h1>
<a class="heading-elements-toggle">
<i class="la la-ellipsis-v font-medium-3"></i>
</a>
<div class="heading-elements">
<ul class="list-inline mb-0">
<li>
<a href="https://www.thehackingproject.org/fr/dashboard/courses/1/projects/93/project_submissions/new"><i class="ft-edit" data-original-title="Proposer une am√©lioration" data-placement="top" data-toggle="tooltip"></i>
</a></li>
<li>
<a data-action="collapse">
<i class="ft-minus"></i>
</a>
</li>
<li>
<a data-action="expand">
<i class="ft-maximize"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="card-content collapse show">
<div class="card-body">
<div class="tab-pane active" id="home1" role="tabpanel">
<h2>1. Introduction</h2>

<p>Aujourd‚Äôhui, nous allons travailler √† nouveau sur notre id√©e √† 1 
milliard de dollars : la fameuse appli de To do listes. Je te laisse le 
choix entre repartir de ton app d'hier ou cr√©er un nouveau projet √† 
partir <a href="https://github.com/mathieubrunpicard/todolist-app" target="_blank">du repo initial</a>.</p>

<h2>2. Le projet</h2>

<h3>2.1. Cr√©er des t√¢ches en AJAX</h3>
<p>Ici, nous allons mettre en ≈ìuvre un usage tr√®s fr√©quent d'AJAX : la 
cr√©ation d'entr√©es en BDD. On va donc bosser sur la page d'accueil et se
 d√©brouiller pour que le formulaire de cr√©ation de t√¢che rajoute, sans 
rechargement de la page, les nouvelles t√¢ches cr√©√©es dans la liste 
ad√©quate.</p>
<p>Sauf si tu l'as cass√©, le formulaire de cr√©ation de t√¢che de la page 
d'accueil doit bien fonctionner (teste-le si besoin). Il ne te reste 
alors qu'√† appliquer la recette que je t'ai donn√© dans le cours :</p>
<ol>
  <li>Permettre au formulaire de faire une requ√™te en AJAX ;</li>
  <li>Mettre √† jour la bonne m√©thode de controller pour qu'elle sache g√©rer une requ√™te AJAX ;</li>
  <li>Cr√©er et coder le fichier JavaScript qui va permettre de rajouter la nouvelle t√¢che sous la bonne cat√©gorie.</li>
</ol>

<p>Comme d'habitude, pense √† bien proc√©der par √©tape (si tu fais tout en
 m√™me temps et que √ßa bugue, comment savoir quelle √©tape est en faute ?)
 et n'h√©site pas √† rajouter, dans le fichier html de la homepage, des <code>id</code> et <code>class</code> aux bons endroits pour simplifier le travail de modification du DOM.</p>

<p>Pense √† l'esth√©tique de ton rendu final : n'h√©site pas √† coder une animation qui fait que la t√¢che s'ajoute de fa√ßon styl√©e (<a href="https://www.w3schools.com/jquery/jquery_fade.asp" target="_blank">JQuery peut te faciliter la vie de ce point de vue l√†</a>).</p>

<h3>2.2. Supprimer les t√¢ches en AJAX</h3>
<p>Maintenant que tu as r√©ussi √† faire fonctionner cette premi√®re 
fonctionnalit√© en AJAX, il serait logique d'impl√©menter son inverse : la
 possibilit√© de supprimer une t√¢che. Indispensable pour √©viter de rester
 bloqu√© avec une t√¢che insurmontable, genre sortir les poubelles.</p>
<p>Ajoute √† chaque t√¢che une petite ic√¥ne que tu peux trouver sur 
font-awesome (oui parce qu'on est gentils, on t'a mis font-awesome sur 
l'app) qui te servira de bouton "supprimer". Justement, une petite 
poubelle √ßa fera bien l'affaire.</p>
<p>√âvidemment, tu commenceras par faire fonctionner le bouton sans AJAX avant de le modifier pour qu'il soit en <code>remote: true</code>... Tu n'es pas de ceux qui ne savent pas proc√©der pas √† pas, hein ?</p>
<p>Tout comme pr√©c√©demment : pense √† faire une petite animation sympa au
 moment de supprimer une t√¢che. Mais n'y passe pas non plus des heures :
 c'est pour faire joli !</p>

<h3>2.3. Changer le statut des t√¢ches en AJAX</h3>
<p>Bien, allons un peu plus loin dans l'AJAX maintenant que tu as 
impl√©ment√© 2 exemples tr√®s courants. L'app Rails que je t'ai pass√© 
pr√©voit la possibilit√© de suivre le statut d'une t√¢che : <code>false</code> si elle est toujours √† faire, <code>true</code>
 si elle est termin√©e. On va piloter par AJAX cette information, √† 
nouveau directement depuis la page d'accueil. Divisons √ßa en plusieurs 
petites sous parties : </p>

<h4>a) Changement de statut en BDD via une checkbox</h4>
<p>On va ajouter une checkbox √† c√¥t√© de chaque t√¢che. L'objectif est que
 lorsqu'elle sera cliqu√©e, un appel en AJAX aura lieu afin de changer le
 <strong>statut</strong> en BDD de la t√¢che concern√©e.</p>
<p>Attention je te pr√©viens, l√† on sort du cadre strict du cours de ce 
matin. En effet, tu vois bien que je te demande de faire une requ√™te 
AJAX l√† o√π il n'y a pas, initialement, de lien du tout. Le clic sur une 
checkbox ne d√©clenche pas de requ√™te HTTP... Alors comment s'en sortir ?</p>
<p>Commence par jeter un ≈ìil √† la partie "3.2 Customize remote elements" <a href="https://guides.rubyonrails.org/working_with_javascript_in_rails.html#customize-remote-elements" target="_blank">de la documentation de Rails</a>. On y explique comment rajouter une checkbox qui d√©clenche des requ√™tes AJAX. <br>
Ensuite, on va utiliser le helper Rails <code>check_box_tag</code> pour suivre ce que nous dit la documentation. Voici, pour t'aider, la syntaxe qu'il faut suivre :</p>
<pre class=" language-ruby"><code class=" language-ruby"> &lt;%<span class="token operator">=</span> check_box_tag <span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token const">CheckedOuPas</span><span class="token operator">?</span> <span class="token punctuation">,</span> data<span class="token punctuation">:</span> <span class="token punctuation">{</span> remote<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token const">TonURL</span><span class="token punctuation">,</span> params<span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token const">ExampleID</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token const">StatusValue</span><span class="token punctuation">}</span><span class="token punctuation">.</span>to_param<span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token string">"put"</span> <span class="token punctuation">}</span>%&gt;</code></pre>

<p>Je t'explique rapidement la syntaxe ci-dessus afin que tu la comprennes bien :</p>
<ul>
  <li><code>:name</code> est le nom de la checkbox (il faut en donner un...)</li>
  <li><code>1</code> c'est la valeur qui sera renvoy√©e sous <code>params[:name]</code> si on coche la box. Si elle n'est pas coch√©e, √ßa ne renvoie rien</li>
  <li>A la place de <code>CheckedOuPas?</code> tu dois mettre <code>false</code> ou <code>true</code> selon si tu veux que ta box soit initialement coch√©e ou non.</li>
  <li>Ensuite on envoie plein de donn√©es sous <code>data</code>, √† commencer par <code>data-remote</code> qu'on met bien s√ªr √† <code>true</code> car c'est de l'AJAX.</li>
  <li>Apr√®s, remplace <code>TonURL</code> par l'URL qui doit recevoir la requ√™te AJAX. Elle appara√Ætra sous le champ <code>data-url</code> une fois le helper transform√© en checkbox HTML.</li>
  <li>Apr√®s tu peux passer plein de donn√©es sous <code>params</code>. Dans l'exemple je t'ai mis les exemples pour mettre des infos sous <code>params[:id]</code> et <code>params[:status]</code> : charge √† toi de mettre les bonnes valeurs.</li>
  <li>La fonction <code>.to_param</code> est indispensable pour que les donn√©es que tu envoies dans le array <code>params</code> soient bien au bon format.</li>
  <li>Et on finit par un classique <code>data-method</code> qu'on met √† PUT car tu vas probablement passer par la m√©thode <code>update</code> du controller <code>task</code> dont la route est en PUT, non ? (indice : oui).</li>
</ul>

<p>Parfait. Je ne t'en dis pas plus : charge √† toi de tester cette syntaxe et de passer par la m√©thode <code>update</code> du controller <code>task</code> pour mettre √† jour le <code>status</code> des t√¢ches. Mets des <code>puts</code>
 pour voir dans ton terminal ce qui se passe dans ta m√©thode, inspecte 
le html de la page pour voir la tronche de ta checkbox et regarde la 
console JS du navigateur pour identifier un √©ventuel bug. Bref : cherche
 un peu seul !</p>

<p>Comment savoir si ta checkbox marche ? Si tu rafra√Æchis ta page, elle doit √™tre coch√©e si la t√¢che est en status <code>true</code>,
 non-coch√©e dans le cas contraire. En parall√®le, tu peux v√©rifier dans 
la console Rails que la BDD est bien modifi√©e suite √† clic sur la 
checkbox : le statut de la t√¢che doit bien √™tre mis √† jour.</p>

<h4> 2.2 R√©action en front via la checkbox</h4>
<p>C'est important que l'utilisateur ait un retour visuel de ses 
actions. Ajoute un moyen de voir explicitement si la t√¢che est bien 
termin√©e (status = true) : par exemple tu peux barrer le texte en JS ou 
d√©placer la t√¢che dans une autre liste. Etc.</p>

<p>Ce qui est primordial c'est que tout changement apport√© par le JS de 
l'action AJAX soit le m√™me que si l'utilisateur rafra√Æchissait sa page. 
Ainsi, si (via la requ√™te AJAX) tu barres le texte d'une t√¢che termin√©e,
 il faut que (de base), toutes les t√¢ches termin√©es soient affich√©es 
barr√©es au chargement initial de la page. Comme √ßa quoique fasse 
l'utilisateur, qu'il quitte la page, y revienne, fasse des appels AJAX, 
etc. il verra toujours les t√¢ches affich√©es de la m√™me fa√ßon : barr√©es 
si elles sont finies, normales si elles sont √† finir.</p>

<h4> 2.3  Une animation pour envoyer du lourd</h4>
<p> Pimp un peu √ßa en faisant en sorte que le texte se barre 
progressivement par exemple, ou que le texte disparaisse de mani√®re 
sympa. Fais preuve d'imagination ! </p>
<p> Tu peux aller jeter un oeil sur des sites comme <a href="https://codemyui.com/" target="_blank">codeMyUi</a> pour trouver un peu d'inspiration. </p>
<p>L√† on est clairement dans le bonus : je te laisse chercher ce qui te semble beau et faisable !</p>

<h2>3. Rendu attendu</h2>
<p>Un repo GitHub avec une app Rails compl√®te.</p>
</div>
</div>
</div>
</div>
</div>
</div>

</div>

      </div>
    </div>

    <div class="thp-flashes"></div>



    <script src="s9j3_fichiers/dashboard-6681459c92372465340c.js"></script>
    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  

<iframe style="display: none; visibility: hidden;" owner="archetype" title="archetype"></iframe>
<script type="text/javascript" id="hs-script-loader" src="s9j3_fichiers/9310539.js"></script><script type="text/javascript" id="">(function(e,c){if(!c.__SV){var l,h;window.mixpanel=c;c._i=[];c.init=function(q,r,f){function t(d,a){var g=a.split(".");2==g.length&&(d=d[g[0]],a=g[1]);d[a]=function(){d.push([a].concat(Array.prototype.slice.call(arguments,0)))}}var b=c;"undefined"!==typeof f?b=c[f]=[]:f="mixpanel";b.people=b.people||[];b.toString=function(d){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);d||(a+=" (stub)");return a};b.people.toString=function(){return b.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<l.length;h++)t(b,l[h]);var n="set set_once union unset remove delete".split(" ");b.get_group=function(){function d(p){a[p]=function(){call2_args=arguments;call2=[p].concat(Array.prototype.slice.call(call2_args,0));b.push([g,call2])}}for(var a={},g=["get_group"].concat(Array.prototype.slice.call(arguments,0)),m=0;m<n.length;m++)d(n[m]);return a};c._i.push([q,r,f])};c.__SV=1.2;var k=e.createElement("script");k.type="text/javascript";k.async=!0;k.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=e.getElementsByTagName("script")[0];e.parentNode.insertBefore(k,e)}})(document,window.mixpanel||[]);mixpanel.init("ab79c62023f2a925bfe5f7922c70de67");mixpanel.track("Sign up");</script>
<script type="text/javascript" id="">!function(){var a=window.analytics=window.analytics||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0;a.methods="trackSubmit trackClick trackLink trackForm pageview identify reset group track ready alias debug page once off on addSourceMiddleware addIntegrationMiddleware setAnonymousId addDestinationMiddleware".split(" ");a.factory=function(b){return function(){var c=Array.prototype.slice.call(arguments);c.unshift(b);
a.push(c);return a}};for(var e=0;e<a.methods.length;e++){var f=a.methods[e];a[f]=a.factory(f)}a.load=function(b,c){var d=document.createElement("script");d.type="text/javascript";d.async=!0;d.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(d,b);a._loadOptions=c};a._writeKey="HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j";a.SNIPPET_VERSION="4.13.2";a.load("HDfubo7D6T7lk8XiL2HZi2hZvIVFuK8j");a.page()}}();</script>

</body></html>